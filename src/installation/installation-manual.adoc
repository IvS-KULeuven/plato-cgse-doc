= Common-EGSE : Installation Manual
Sara Regibo, Rik Huygen
1.0, 20 May, 2022
:toc:
:icons: font
:organization: KU Leuven
:doc-nr: PLATO-KUL-PL-MAN-0002
:doctype: book
:toc: left
:toclevels: 2
:sectnums:
:!chapter-signifier:
:xrefstyle: short
:imagesdir: ../images
ifdef::backend-pdf[]
:pdf-theme: cgse-light
:pdf-themesdir: ../themes/
:pdf-header-logo: image::cgse-logo.svg[]
:title-logo-image: image::cgse-logo-400x400.png[Front Cover]
:source-highlighter: rouge
//:rouge-style: github
endif::[]

include::todo.adoc[]

== Introduction

This guide explains the installation and configuration of the components:

* The operating system on the egse-server and egse-client
* The installation of basic tools like git, python
* The installation of the Common-EGSE (CGSE)
* The installation of the Test Scripts (TS)

== Installing the Operating System

include::server.adoc[leveloffset=1]

include::client.adoc[leveloffset=1]

=== Setting up the users

== Installation of Python

== Installation of PyCharm

PyCharm is the IDE that we will use to execute test scripts. For this purpose the PyCharm Community edition is sufficient.

include::git.adoc[]

XXXXX: what's next?

Make sure the environment variables are set: PLATO_COMMON_EGSE_PATH, and PLATO_INSTALL_LOCATION

* install for develop -> `python -m pip install -e .`
* install for ops -> 'python setup.py install --force --home=$PLATO_INSTALL_LOCATION`


== Installing the Common-EGSE

=== First-time Installation

=== Update the Common-EGSE

== Installing the Test Scripts

=== First-time Installation

=== Update the Test Scripts

include::data-propagation.adoc[]

== Shared Libraries

Some components use a shared library that is loaded by the Python interpreter. In order to load the library, the absolute path to the shared object file must be known. Different modules handle this in their own way.

The `egse.dsi` module searches for the RMAP and ESL libraries in the operating system specific folder in the  `egse.lib` module. The libraries are then loaded using the `ctypes` module. If the CGSE is properly installed, this should work out-of-the-box.

The `egse.filterwheel.eksma` module needs a library `libximc` which is also provided in the `egse.lib` module, but the Python code needs the proper location in the environment variable `LD_LIBRARY_PATH`.  The required files are included in the CGSE repo at `~/git/plato-common-egse/src/egse/lib/ximc/libximc.framework`.  The library that is needed can also be downloaded from: https://files.xisupport.com/libximc/libximc-2.13.3-all.tar.gz.

The preferred solution is to add the location of the library files to the environment variable `$LD_LIBRARY_PATH`.  In your terminal or better in your bash profile:

[%nowrap,source]
----
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:~/git/plato-common-egse/src/egse/lib/ximc/libximc.framework/
----

Alternatively, you can install the '.deb' package from the link above on your system with dpkg. That will put the files under `/usr/lib`.

== Installating External Tools

=== Cutelog GUI

=== Textualog TUI

Textualog is a terminal application that allows you to inspect the log files in `$PLATO_LOG_FILE_LOCATION`. The package is open-source and can be installed in your virtual environment from PyPI using `pip`:

[bash]
----
python -m pip install textualog
----

Textualog is extremely useful to inspect and follow logging messages in a remote terminal.
