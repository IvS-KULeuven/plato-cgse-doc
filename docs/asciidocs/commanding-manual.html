<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.20">
<meta name="author" content="KU Leuven PLATO Team">
<title>Ground Tests Commanding Manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Asciidoctor Tabs | Copyright (c) 2018-present Dan Allen | MIT License */
.tabs {
  margin-bottom: 1.25em;
}

.tablist > ul {
  display: flex;
  flex-wrap: wrap;
  list-style: none;
  margin: 0;
  padding: 0;
}

.tablist > ul li {
  align-items: center;
  background-color: #fff;
  cursor: pointer;
  display: flex;
  font-weight: bold;
  line-height: 1.5;
  padding: 0.25em 1em;
  position: relative;
}

.tablist > ul li:focus-visible {
  outline: none;
}

.tablist.ulist,
.tablist.ulist > ul li {
  margin: 0;
}

.tablist.ulist > ul li + li {
  margin-left: 0.25em;
}

.tabs .tablist li::after {
  content: "";
  display: block;
  height: 1px;
  position: absolute;
  bottom: -1px;
  left: 0;
  right: 0;
}

.tabs.is-loading .tablist li:not(:first-child),
.tabs:not(.is-loading) .tablist li:not(.is-selected) {
  background-color: #f5f5f5;
}

.tabs.is-loading .tablist li:first-child::after,
.tabs:not(.is-loading) .tablist li.is-selected::after {
  background-color: #fff;
}

/*
.tabs:not(.is-loading) .tablist li,
.tabs:not(.is-loading) .tablist li::after {
  transition: background-color 200ms ease-in-out;
}
*/

.tablist > ul p {
  line-height: inherit;
  margin: 0;
}

.tabpanel {
  background-color: #fff;
  padding: 1.25em;
}

.tablist > ul li,
.tabpanel {
  border: 1px solid #dcdcdc;
}

.tablist > ul li {
  border-bottom: 0;
}

.tabs.is-loading .tabpanel + .tabpanel,
.tabs:not(.is-loading) .tabpanel.is-hidden {
  display: none;
}

.tabpanel > :first-child {
  margin-top: 0;
}

/* #content is a signature of the Asciidoctor standalone HTML output */
#content .tabpanel > :last-child,
#content .tabpanel > :last-child > :last-child,
#content .tabpanel > :last-child > :last-child > li:last-child > :last-child {
  margin-bottom: 0;
}

.tablecontainer {
  overflow-x: auto;
}

#content .tablecontainer {
  margin-bottom: 1.25em;
}

#content .tablecontainer > table.tableblock {
  margin-bottom: 0;
}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Ground Tests Commanding Manual</h1>
<div class="details">
<span id="author" class="author">KU Leuven PLATO Team</span><br>
<span id="revnumber">version 0.13,</span>
<span id="revdate">29/03/2024</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_changelog">Changelog</a></li>
<li><a href="#_colophon">Colophon</a></li>
<li><a href="#_conventions_used_in_this_book">Conventions used in this Book</a></li>
<li><a href="#_purpose">Purpose</a></li>
<li><a href="#_documents_and_acronyms">Documents and Acronyms</a>
<ul class="sectlevel2">
<li><a href="#_applicable_documents">Applicable documents</a></li>
<li><a href="#reference-documents">Reference Documents</a></li>
<li><a href="#_acronyms">Acronyms</a></li>
</ul>
</li>
<li><a href="#_introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_contents">1.1. Contents</a></li>
<li><a href="#_egse_commanding_software_environment">1.2. EGSE commanding software environment</a></li>
<li><a href="#user-profiles">1.3. How different user profiles use the software</a></li>
</ul>
</li>
<li><a href="#_software_overview">2. Software Overview</a>
<ul class="sectlevel2">
<li><a href="#_the_plato_common_egse_github_repository">2.1. The plato-common-egse GitHub repository</a></li>
<li><a href="#_the_plato_test_scripts_github_repository">2.2. The plato-test-scripts GitHub repository</a></li>
<li><a href="#_the_plato_cgse_conf_github_repo">2.3. The plato-cgse-conf GitHub repo</a></li>
<li><a href="#_software_installation">2.4. Software installation</a></li>
<li><a href="#_naming_convention">2.5. Naming Convention</a></li>
</ul>
</li>
<li><a href="#_test_script_architecture">3. Test script architecture</a>
<ul class="sectlevel2">
<li><a href="#_overview">3.1. Overview</a></li>
<li><a href="#_building_block">3.2. Building block</a></li>
</ul>
</li>
<li><a href="#_test_execution">4. Test execution</a>
<ul class="sectlevel2">
<li><a href="#test-execution">4.1. Test execution: execute</a></li>
<li><a href="#_preview_the_command_sequence">4.2. Preview the command sequence</a></li>
<li><a href="#_executing_short_building_blocks_individually">4.3. Executing short building blocks individually</a></li>
</ul>
</li>
<li><a href="#data-acquisition-and-storage">5. Data acquisition and storage</a>
<ul class="sectlevel2">
<li><a href="#_housekeeping_telemetry">5.1. Housekeeping telemetry</a></li>
<li><a href="#_observation">5.2. Observation</a></li>
<li><a href="#_image_data">5.3. Image data</a></li>
<li><a href="#_telecommand_history">5.4. Telecommand history</a></li>
</ul>
</li>
<li><a href="#conf-setup">6. Configuration and Setups</a>
<ul class="sectlevel2">
<li><a href="#_example_setup_file">6.1. Example Setup file</a></li>
<li><a href="#_available_setups">6.2. Available Setups</a></li>
<li><a href="#sec-loading-a-setup">6.3. Loading a Setup</a></li>
<li><a href="#_inspecting_accessing_and_modifying_a_setup">6.4. Inspecting, accessing, and modifying a Setup</a></li>
<li><a href="#_saving_a_new_setup">6.5. Saving a new setup</a></li>
</ul>
</li>
<li><a href="#_common_egse_startup_shutdown_sleep">7. Common-EGSE startup, shutdown, sleep</a>
<ul class="sectlevel2">
<li><a href="#_egse_states">7.1. EGSE States</a></li>
<li><a href="#_core_device_processes">7.2. Core &amp; Device Processes</a></li>
<li><a href="#_process_manager_gui">7.3. Process Manager GUI</a></li>
</ul>
</li>
<li><a href="#_utility_functions">8. Utility functions</a>
<ul class="sectlevel2">
<li><a href="#_logging">8.1. Logging</a></li>
<li><a href="#_handling_errors">8.2. Handling Errors</a></li>
<li><a href="#_coordinate_transformations">8.3. Coordinate transformations</a></li>
</ul>
</li>
<li><a href="#sec-new-camera">9. When a new camera arrives</a>
<ul class="sectlevel2">
<li><a href="#_setup">9.1. Setup</a></li>
<li><a href="#_purpose_2">9.2. Purpose</a></li>
<li><a href="#_useful_information">9.3. Useful Information</a></li>
<li><a href="#_a_new_camera_arrives_at_csl">9.4. A new camera arrives at CSL</a></li>
<li><a href="#_a_new_camera_arrives_at_the_test_houses">9.5. A new camera arrives at the test houses</a></li>
<li><a href="#_additional_preparation_steps">9.6. Additional preparation steps</a></li>
<li><a href="#sec-new-camera-ref">9.7. Reference Information</a></li>
</ul>
</li>
<li><a href="#camera-switch-on-off">10. Switching ON/OFF the Camera</a>
<ul class="sectlevel2">
<li><a href="#_detailed_description_of_camera_switch_on">10.1. Detailed description of Camera Switch ON</a></li>
<li><a href="#_detailed_description_of_camera_switch_off">10.2. Detailed description of Camera Switch OFF</a></li>
<li><a href="#sft-analysis">10.3. Analysis of the Short Function Test (SFT)</a></li>
</ul>
</li>
<li><a href="#aeu-operations">11. Operating the AEU EGSE</a>
<ul class="sectlevel2">
<li><a href="#_introduction_2">11.1. Introduction</a></li>
<li><a href="#_aeu_switch_on_and_off">11.2. AEU switch on and off</a></li>
<li><a href="#changing-aeu-op-mode">11.3. Changing between AEU EGSE operation modes</a></li>
<li><a href="#_power_supply_unit_setting_and_checking_current_and_voltage_protections">11.4. Power supply Unit: Setting and checking Current and voltage protections</a></li>
<li><a href="#_fee_voltages_and_currents">11.5. FEE voltages and currents</a></li>
<li><a href="#_fee_voltage_memories">11.6. FEE voltage memories</a></li>
<li><a href="#_aeu_powering_up_and_down_fee">11.7. AEU powering up and down FEE</a></li>
<li><a href="#_aeu_configuring_synchronisation_signals">11.8. AEU configuring synchronisation signals</a></li>
<li><a href="#_aeu_self_test">11.9. AEU self test</a></li>
<li><a href="#_aeu_telemetry_parameters">11.10. AEU Telemetry parameters</a></li>
<li><a href="#_functional_summary">11.11. Functional summary</a></li>
</ul>
</li>
<li><a href="#n-fee-operations">12. Operating the N-FEE</a>
<ul class="sectlevel2">
<li><a href="#_glossary">12.1. Glossary</a></li>
<li><a href="#sec-n-fee-operating-modes">12.2. N-FEE operating modes</a></li>
<li><a href="#sec-cycle-timing">12.3. Cycle, Timing and Synchronisation</a></li>
<li><a href="#_commanding_the_n_fees">12.4. Commanding the N-FEEs</a></li>
<li><a href="#_synchronization_with_ccd_readouts">12.5. Synchronization with CCD-readouts</a></li>
</ul>
</li>
<li><a href="#f-fee-operations">13. Operating the F-FEE</a>
<ul class="sectlevel2">
<li><a href="#_glossary_2">13.1. Glossary</a></li>
<li><a href="#sec-f-fee-operating-modes">13.2. F-FEE operating modes</a></li>
<li><a href="#sec-f-fee-cycle-timing">13.3. Cycle, Timing and Synchronisation</a></li>
<li><a href="#_commanding_the_f_fees">13.4. Commanding the F-FEEs</a></li>
<li><a href="#_synchronization_with_ccd_readouts_2">13.5. Synchronization with CCD-readouts</a></li>
</ul>
</li>
<li><a href="#_operating_the_tcs_egse">14. Operating the TCS EGSE</a>
<ul class="sectlevel2">
<li><a href="#_switching_between_operating_modes">14.1. Switching between operating modes</a></li>
<li><a href="#_remote_commanding">14.2. Remote Commanding</a></li>
<li><a href="#_the_tcs_data_acquisition_system_das">14.3. The TCS Data Acquisition System —DAS</a></li>
<li><a href="#_setting_the_temperature_setpoints">14.4. Setting the temperature setpoints</a></li>
<li><a href="#_enabling_disabling_temperature_control">14.5. Enabling / disabling temperature control</a></li>
<li><a href="#_temperature_sensor_configuration">14.6. Temperature sensor configuration</a></li>
<li><a href="#_changing_temperature_sensor_calibration_curves">14.7. Changing temperature sensor calibration curves</a></li>
<li><a href="#_changing_pi_control_parameters">14.8. Changing PI control parameters</a></li>
<li><a href="#_changing_the_pwm_frequency">14.9. Changing the PWM frequency</a></li>
</ul>
</li>
<li><a href="#_operating_the_teb_shroud_and_mari_thermal_control">15. Operating the TEB, shroud and MARI thermal control</a>
<ul class="sectlevel2">
<li><a href="#_context">15.1. Context</a></li>
<li><a href="#_checking_and_setting_the_temperature_setpoints">15.2. Checking and setting the temperature setpoints</a></li>
<li><a href="#_starting_stopping_the_temperature_control_loop">15.3. Starting / stopping the temperature control loop</a></li>
</ul>
</li>
<li><a href="#_operating_the_ogse">16. Operating the OGSE</a>
<ul class="sectlevel2">
<li><a href="#_switching_entire_ogse_on">16.1. Switching entire OGSE on</a></li>
<li><a href="#_switching_entire_ogse_off">16.2. Switching entire OGSE off</a></li>
<li><a href="#_attenuation_with_neutral_density_filters">16.3. Attenuation with Neutral density filters</a></li>
<li><a href="#_attenuation_specifying_the_full_well_fraction">16.4. Attenuation specifying the full well fraction</a></li>
<li><a href="#_switching_onoff_light_intensity_stabilisation_loop">16.5. Switching on/off light intensity stabilisation loop</a></li>
<li><a href="#_power_meter">16.6. Power meter</a></li>
<li><a href="#_ogse_housekeeping_parameters">16.7. OGSE housekeeping parameters</a></li>
</ul>
</li>
<li><a href="#_operating_the_tests_system_states">17. Operating the tests, system states</a></li>
<li><a href="#_appendices">18. Appendices</a>
<ul class="sectlevel2">
<li><a href="#app-a-ex-ccd-acquisition">Appendix A: Examples of CCD acquisition timing sequence</a></li>
<li><a href="#app-b-fov">Appendix B: Field of view representation with visited positions in CSL</a></li>
<li><a href="#_what_should_be_started_where">Appendix C: What should be started where?</a></li>
<li><a href="#_generating_fits_files_off_line">Appendix D: Generating FITS files off-line</a></li>
<li><a href="#app-issue-ncr-pvs">Appendix E: GitHub issues, NCR, and PVS</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><a href="https://ivs-kuleuven.github.io/plato-cgse-doc/">Backlink to the CGSE Documentation Website</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://ivs-kuleuven.github.io/plato-cgse-doc/asciidocs/user-manual.html">User Manual</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://ivs-kuleuven.github.io/plato-cgse-doc/asciidocs/developer-manual.html">Developer Manual</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Commanding Manual (this document)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://ivs-kuleuven.github.io/plato-cgse-doc/api/egse/index.html">CGSE API Documentation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://ivs-kuleuven.github.io/plato-cgse-doc/asciidocs/installation-manual.html">Installation Manual</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://ivs-kuleuven.github.io/plato-cgse-doc/asciidocs/icd.html">Interface Control Document (ICD)</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_changelog">Changelog</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">29/03/2024 — 0.13</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Added proper figures for the F-CAM CCD and AEB numbering, see <a href="#sec-f-cam-ccd-and-pixel-references">Section 13.4.1</a>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">18/03/2024 — 0.12</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Added a section on F-FEE operation (by Pierre Royer), see <a href="#f-fee-operations">Chapter 13</a>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">12/02/2024 — 0.11</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Added a warning that loading/submitting a Setup doesn&#8217;t propagate this new Setup to all components in the system, see <a href="#conf-setup">Chapter 6</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">29/06/2023 — 0.10</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Added table with N-FEE modes and their register values for PFM, see <a href="#tab-n-fee-modes">Table 3</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">28/06/2023 — 0.9</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Added an appendix to explain the difference between GitHub issues, NCRs and PVS, see <a href="#app-issue-ncr-pvs">Appendix 18.E</a></p>
</li>
<li>
<p>Added a section on actions on the Setup when a new camera arrives, see <a href="#sec-new-camera">Chapter 9</a>. (This is taken from a technical note by Pierre PLATO-KUL-PL-TN-0022)</p>
</li>
<li>
<p>updated CCD layout images in a TAB for EM and FM, see <a href="#n-fee-operations">Chapter 12</a>.</p>
</li>
<li>
<p>Added section on SFT analysis to section on Camera Switch ON, see <a href="#camera-switch-on-off">Chapter 10</a>.</p>
</li>
<li>
<p>minor editorial changes like fixing links, typos, minor rewording, etc.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">20/06/2023 — v0.8</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Added explanation about Camera Switch ON / OFF, see <a href="#camera-switch-on-off">Chapter 10</a></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">19/06/2023 — v0.7</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>bringing the commanding manual up-to-date with the current implementation of the Common-EGSE, the test scripts and the situation in the test houses.</p>
<div class="ulist">
<ul>
<li>
<p>Section on the plato-test-prep repository has been removed (was Section 3.3)</p>
</li>
<li>
<p>Data Acquisition: updates in all sections</p>
</li>
<li>
<p>Configuration and Setups: updates in all sections</p>
</li>
<li>
<p>Common-EGSE startup, shutdown and sleep: updates in all sections</p>
</li>
<li>
<p>Utility functions: updates in all sections</p>
</li>
<li>
<p>Operating the N-FEE: updates in all sections</p>
</li>
<li>
<p>Operating the TCS EGSE: only editorial updates</p>
</li>
<li>
<p>Operating the OGSE: updates in all sections</p>
</li>
<li>
<p>Operating the tests, system states: only editorial changes</p>
</li>
<li>
<p>Appendix A: removed unimplemented ALT mode for <code>ccd_side</code> and updated other commands with correct parameters</p>
</li>
<li>
<p>Appendix B: updated commands for visited positions</p>
</li>
</ul>
</div>
</li>
<li>
<p>added a backlink to the CGSE Documentation web site for your convenience. It&#8217;s at the top of the HTML page.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<details>
<summary class="title">Click to see older changelog entries</summary>
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">12/06/2023 — v0.6</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>move the commanding manual to the CGSE documentation page and converted into asciidoc.</p>
</li>
<li>
<p>Update section on data structure</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">14/06/2021 — v0.5</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Update section 11.3 (rem. col_end from BB signatures)</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">03/05/2021 — v0.4</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Update sections 3.2, 3.3, 7.3, 7.4</p>
</li>
<li>
<p>Sections 11.1 &amp; 11.3 Change ccd_side &amp; EF convention</p>
</li>
<li>
<p>New sections 5.3, 6.3, 11.4 and 14</p>
</li>
<li>
<p>Update sections 3.2, 3.3, 7.3, 7.4</p>
</li>
<li>
<p>Sections 11.1 &amp; 11.3 Change ccd_side  &amp; EF convention</p>
</li>
<li>
<p>New sections 5.3, 6.3, 11.4 and 14</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</div>
</div>
<div class="sect1">
<h2 id="_colophon">Colophon</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Copyright &#169; 2022, 2023 by the KU Leuven PLATO CGSE Team</p>
</div>
<div class="paragraph">
<p>1<sup>st</sup> Edition — February 2023</p>
</div>
<div class="paragraph">
<p>This manual is written in PyCharm using the AsciiDoc plugin. The PDF Book version is processed with asciidoctor-pdf.</p>
</div>
<div class="paragraph">
<p>The manual is available as HTML from <a href="http://ivs-kuleuven.github.io/plato-cgse-doc">ivs-kuleuven/github.io</a>. The HTML pages are generated with Hugo which is an OSS static web-pages generator. From this site, you can also download the PDF books.</p>
</div>
<div class="paragraph">
<p>The source code is available in a GitHub repository at <a href="https://github.com/ivs-kuleuven/plato-cgse-doc">ivs-kuleuven/plato-cgse-doc</a>.</p>
</div>
<div class="paragraph">
<p>When you find an error or inconsistency or you have some improvements to the text, feel free to raise an issue or create a pull request. Any contribution is greatly appreciated and will be mentioned in the acknowledgement section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conventions_used_in_this_book">Conventions used in this Book</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We try to be consistent with the following typographical conventions:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Italic</dt>
<dd>
<p>Indicates a new term or &#8230;&#8203;</p>
</dd>
<dt class="hdlist1">Constant width</dt>
<dd>
<p>Used for code listings, as well as within paragraphs to refer to program elements like variable and function names, data type, environment variables (<code>ALL_CAPS</code>), statements and keywords.</p>
</dd>
<dt class="hdlist1">Constant width between angle brackets <code>&lt;text&gt;</code></dt>
<dd>
<p>Indicates <code>text</code> that should be replaced with user-supplied values or by values determined by context. The brackets should thereby be omitted.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>When you see a <code>$ &#8230;&#8203;</code> in code listings, this is a command you need to execute in a terminal (omitting the dollar sign itself). When you see <code>&gt;&gt;&gt; &#8230;&#8203;</code> in code listings, that is a Python expression that you need to execute in a Python REPL (here omitting the three brackets).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Setup versus setup</dt>
<dd>
<p>I make a distinction between Setup (with a capital S) and setup (with a small s). The Setup is used when I talk about the object as defined in a Python environment, i.e. the entity itself that contains all the definitions, configuration and calibration parameters of the equipment that make up the complete test setup (notice the small letter 's' here).</p>
<div class="paragraph">
<p>(sometimes you may find setup in the document which really should be 'set up' with a space)</p>
</div>
</dd>
<dt class="hdlist1">Using TABs</dt>
<dd>
<p>Some of the manuals use TABs in their HTML version. Below, you can find an example of tabbed information. You can select between FM and EM info and you should see the text change with the TAB.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This feature is only available in the HTML version of the documents. If you are looking at the PDF version of the document, the TABs are shown in a frame where all TABs are presented successively.
</td>
</tr>
</table>
</div>
<div id="_tabs_1" class="openblock tabs is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_1_fm" class="tab">
<p>FM</p>
</li>
<li id="_tabs_1_em" class="tab">
<p>EM</p>
</li>
</ul>
</div>
<div id="_tabs_1_fm--panel" class="tabpanel" aria-labelledby="_tabs_1_fm">
<div class="paragraph">
<p>In this TAB we present <em>FM specific information</em>.</p>
</div>
</div>
<div id="_tabs_1_em--panel" class="tabpanel" aria-labelledby="_tabs_1_em">
<div class="paragraph">
<p>In this TAB we present <strong>EM specific information</strong>.</p>
</div>
</div>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Using Collapse</dt>
<dd>
<p>Sometimes, information we need to display is too long and will make the document hard to read. This happens mostly with listings or terminal output and we will make that information collapsible. By default, the info will be collapsed, press the small triangle before the title (or the title itself) to expand it.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the PDF document, all collapsible sections will be expanded.
</td>
</tr>
</table>
</div>
<details>
<summary class="title">A collapsible listing</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap">plato-data@strawberry:/data/CSL1/obs/01151_CSL1_chimay$ ls -l
total 815628
-rw-r--r-- 1 plato-data plato-data      7961 Jun 20 10:38 01151_CSL1_chimay_AEU-AWG1_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data      9306 Jun 20 10:38 01151_CSL1_chimay_AEU-AWG2_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data    309375 Jun 20 10:38 01151_CSL1_chimay_AEU-CRIO_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data     42950 Jun 20 10:38 01151_CSL1_chimay_AEU-PSU1_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data     43239 Jun 20 10:38 01151_CSL1_chimay_AEU-PSU2_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data     42175 Jun 20 10:38 01151_CSL1_chimay_AEU-PSU3_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data     42327 Jun 20 10:38 01151_CSL1_chimay_AEU-PSU4_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data     42242 Jun 20 10:38 01151_CSL1_chimay_AEU-PSU5_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data     42269 Jun 20 10:38 01151_CSL1_chimay_AEU-PSU6_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data     67149 Jun 20 10:38 01151_CSL1_chimay_CM_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data     20051 Jun 20 10:38 01151_CSL1_chimay_DAQ6510_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data       105 Jun 20 10:38 01151_CSL1_chimay_DAS-DAQ6510_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data     19721 Jun 20 10:38 01151_CSL1_chimay_DPU_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data     22833 Jun 20 10:38 01151_CSL1_chimay_FOV_20230620_095819.csv
-rw-rw-r-- 1 plato-data plato-data 833754240 Jun 20 10:34 01151_CSL1_chimay_N-FEE_CCD_00001_20230620_cube.fits
-rw-r--r-- 1 plato-data plato-data    292859 Jun 20 10:38 01151_CSL1_chimay_N-FEE-HK_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data      8877 Jun 20 10:38 01151_CSL1_chimay_OGSE_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data     19841 Jun 20 10:38 01151_CSL1_chimay_PM_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data    188419 Jun 20 10:38 01151_CSL1_chimay_PUNA_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data      7662 Jun 20 10:38 01151_CSL1_chimay_SMC9300_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data     19781 Jun 20 10:38 01151_CSL1_chimay_SYN_20230620_095819.csv
-rw-r--r-- 1 plato-data plato-data    147569 Jun 20 10:38 01151_CSL1_chimay_SYN-HK_20230620_095819.csv
plato-data@strawberry:/data/CSL1/obs/01151_CSL1_chimay$</pre>
</div>
</div>
</div>
</details>
</div>
</div>
<div class="sect1">
<h2 id="_purpose">Purpose</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document describes the concepts and some practicalities relative to the commanding of the PLATO Cameras (AEU, FEE) and various GSEs to be controlled during the ground-based testing of the PLATO Cameras.</p>
</div>
<div class="paragraph">
<p>The document shall be used to train members of the PLATO camera test team in operating the Common-EGSE system and write commanding scripts for camera-level tests.</p>
</div>
<div class="paragraph">
<p>The present version still contains a few ‘TBW’, some of which will be filled thanks to inputs from the Test Houses (TH), describing the location-specific GSE controls.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_documents_and_acronyms">Documents and Acronyms</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_applicable_documents">Applicable documents</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 50%;">
<col style="width: 30%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ID</th>
<th class="tableblock halign-left valign-top">Document Title</th>
<th class="tableblock halign-left valign-top">Document Number</th>
<th class="tableblock halign-left valign-top">Issue</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="reference-documents">Reference Documents</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 50%;">
<col style="width: 30%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ID</th>
<th class="tableblock halign-left valign-top">Document Title</th>
<th class="tableblock halign-left valign-top">Document Number</th>
<th class="tableblock halign-left valign-top">Issue</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAM Test EGSE User Manual</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PT-EVO-SYS-MA-0261-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common-EGSE User Manual</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-KUL-PL-MAN-0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-03</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test Specification</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-KUL-PL-TS-0001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-04</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common-EGSE ICD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-KUL-PL-ICD-0002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-05</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-AEU CAM TEST EGSE TMTC ICD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PTO-ECO-SYS-ICD-0188</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2B</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-06</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO N-FEE ICD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-MSSL-PL-ICD-0002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-07</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reverse clocking for N-CAMs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-MSSL-PL-TN-0015</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-08</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N-FEE Readout Operations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-MSSL-PL-TN-0012</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-09</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO PL TCGSE UNIT Subsystems and Equipment ICD and IDS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PTO-AST-PL-TCGSE-ICD-0012</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO Instrument Coordinate Systems</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-OHB-PL-LI-0009</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">05</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO Room temperature collimator user manual</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-UOL-PL-RP-0004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R1_CalibrationReport</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-PL-CSL-RP-0031</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R2_CalibrationReport</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-PL-CSL-RP-0032</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N-FEE Conceptualised Operation Specification</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-MSSL-PL-SP-0015</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO N-FEE PFM Register Map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-MSSL-PL-FI-0004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RD-16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO F-FEE CD ICD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO-DLR-PL-ICD-0007</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.6</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_acronyms">Acronyms</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AEU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ancillary Electronics Unit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Application Programming Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Camera</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Charged-Coupled Device</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CGSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common-EGSE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Centre Spatial de Liège</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Comma-Separated Values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">COT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Commercial off-the-shelf</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Charge Transfer Inefficiency</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Consent to Ship</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DPU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Processing Unit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DSI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Diagnostic SpaceWire Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EGSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Electrical Ground Support Equipment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EOL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">End Of Life</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAQ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frequently Asked Questions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FEE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Front End Electronics</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FITS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flexible Image Transport System</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FPA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Focal Plane Assembly/Array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ground Support Equipment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GUI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Graphical User Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HDF5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hierarchical Data Format version 5 (File format)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Housekeeping</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IAS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Institut d’Astrophysique Spatiale</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ICD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface Control Document</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LDO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Leonardo space, Italy</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MGSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mechanical Ground Support Equipment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MMI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Man-Machine Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NCR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-Conformance Report</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NRB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Non-Conformance Review Board</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OBSID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Observation Identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OGSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optical Ground Support Equipment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operating System</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PDF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Portable Document Format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process Identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLAnetary Transits and Oscillations of stars</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PPID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parent Process Identifier</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Payload Module</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PVS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Procedure Variation Sheet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read-Evaluate-Print Loop, e.g. the Python interpreter prompt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RMAP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote Memory Access Protocol</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SFT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short Functional Test</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SpW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SpaceWire</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Structured Query Language</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SRON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stichting Ruimte-Onderzoek Nederland</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">System Under Test</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SVM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service Module</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To Be Confirmed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To Be Decided or To Be Defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">To Be Written</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Telecommand</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Thermal Control System</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test House</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Telemetry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Telescope Optical Unit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test Scripts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TUI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Text-based User Interface</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Thermal Vacuum</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User Manual</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Universal Serial Bus</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">YAML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">YAML Ain&#8217;t Markup Language</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_contents">1.1. Contents</h3>
<div class="paragraph">
<p>This document describes the usage of the PLATO Common-EGSE to command the PLATO camera (SUT) and the ground support equipment (GSE) during the PLATO camera ground testing.</p>
</div>
<div class="paragraph">
<p>Throughout this document, we use the following notation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a command to be executed in a terminal on either the egse-server or on the client machine.</p>
<div class="listingblock">
<div class="content">
<pre>$ command</pre>
</div>
</div>
</li>
<li>
<p>a command to be executed in a Python session. This Python session will always be running on the client machine.</p>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; command</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_egse_commanding_software_environment">1.2. EGSE commanding software environment</h3>
<div class="paragraph">
<p>The user interface to the PLATO camera EGSE is a software application developed at KU Leuven in collaboration with the test houses for site specific components. It provides graphical user interfaces to control the software processes in the system, monitor telemetry parameters, provide the operator with quick-look analysis images of the camera detectors, etc.  It also features a commanding interface in Python.  The commanding logic is entirely defined in Python.  The hardware interfaces have been implemented in Python (possibly accessing a library written in the C programming language), and the user is accessing these by executing higher-level Python functions in a Python interpreter.</p>
</div>
</div>
<div class="sect2">
<h3 id="user-profiles">1.3. How different user profiles use the software</h3>
<div class="ulist">
<ul>
<li>
<p><strong>test-operator</strong>: running a test, launching scripts and inspecting results of quick look analysis script at the test house. The test operator is knowledgeable of the Common-EGSE, Test Scripts, all GSE and basic operation of the PLATO Camera (SUT).</p>
</li>
<li>
<p><strong>test-developer</strong>: translating test specification into commanding scripts, writing quick-look analysis scripts.</p>
</li>
<li>
<p><strong>offline-analyst</strong>: loads the test data from the archive and process this data for validation and feedback.</p>
</li>
<li>
<p><strong>site-operator</strong>: manages the test-infrastructure, i.e. the test-environment in the TH, administration of egse-server and client machines.</p>
</li>
<li>
<p><strong>site-developer</strong>: implements test house specific software for test equipment used at test houses. This includes but is not limited to device drivers, GUI applications, local setups.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Typical flow of events and responsibilities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Long before the tests are executed, the site-developer implements the interfaces to the test-equipment in the Common-EGSE.</p>
</li>
<li>
<p>Months before the test, the test-developer turns the test-specification into a commanding script.</p>
</li>
<li>
<p>Minutes before the test, the site-operator starts up the system, activates all connections, launches GUIs, loads the proper system configuration into the system, and gives a go-ahead to the test-operator.</p>
</li>
<li>
<p>At t0, the test-operator launches the execution of the commanding script and follows it in real-time.</p>
</li>
<li>
<p>At the end of the execution, the analyst gets hold of the data and starts the analysis.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This commanding manual is mainly targeted at the test developers, the test operators and the analysts. The site-operators and site-developers will find most of the information they need in the Common-EGSE <a href="https://ivs-kuleuven.github.io/plato-cgse-doc/docs/installation-manual/">installation manual</a> and <a href="https://ivs-kuleuven.github.io/plato-cgse-doc/docs/user-manual/">user manual</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_software_overview">2. Software Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The PLATO commanding during ground-based testing resides upon three GitHub repositories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/IvS-KULeuven/plato-common-egse">plato-common-egse</a> (<a href="https://ivs-kuleuven.github.io/plato-cgse-doc/">link to documentation</a>)</p>
</li>
<li>
<p><a href="https://github.com/IvS-KULeuven/plato-test-scripts">plato-test-scripts</a> (<a href="https://ivs-kuleuven.github.io/plato-cgse-doc/">link to documentation</a>)</p>
</li>
<li>
<p><a href="https://github.com/IvS-KULeuven/plato-cgse-conf">plato-cgse-conf</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Amongst others, the documentation will point you to the installation guides, list the low-level commands that are available in the Common-EGSE, list the low-level building blocks implemented in the test scripts etc.</p>
</div>
<div class="sect2">
<h3 id="_the_plato_common_egse_github_repository">2.1. The plato-common-egse GitHub repository</h3>
<div class="paragraph">
<p>This repository contains the background infrastructure to interface with the actual hardware in the test housess. The complete documentation can be found in the link above, and in RD-02, see <a href="#reference-documents">Reference Documents</a>.</p>
</div>
<div class="paragraph">
<p>In a nutshell, it provides access to all the necessary functions to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Operate the camera under test</p>
</li>
<li>
<p>Operate all devices in the test-environment (in or out of the TVAC chamber)</p>
</li>
<li>
<p>Record all telemetry</p>
<div class="ulist">
<ul>
<li>
<p>From the camera (image data &amp; HK)</p>
</li>
<li>
<p>From the test-environment (HK)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Maintain the setup and calibration file information under configuration control (see ‘setup’ below).</p>
</li>
<li>
<p>Command the camera and the test-environment devices from Python scripts (see plato-test-scripts)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The THs are expected to contribute to this repository, to implement the interfaces to their own environment and devices, so they should fork this repository in order to be able to create pull requests.</p>
</div>
<div class="paragraph">
<p>The test-operators are not expected to contribute to this repository, so they should clone the repository.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_plato_test_scripts_github_repository">2.2. The plato-test-scripts GitHub repository</h3>
<div class="paragraph">
<p>This repository contains the Python scripts</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for commanding the tests as defined in the test specification,</p>
</li>
<li>
<p>for analysing the data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The commanders and the THs are expected to contribute to this repository, so everyone should fork it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_the_plato_cgse_conf_github_repo">2.3. The plato-cgse-conf GitHub repo</h3>
<div class="paragraph">
<p>This repository holds the setups saved during the tests under configuration control. The concept of setup is explained in <a href="#conf-setup">Chapter 6</a>.</p>
</div>
<div class="paragraph">
<p>No one is expected to contribute directly to this repository as it is maintained by the Common-EGSE. The repository can be cloned for inspection.</p>
</div>
</div>
<div class="sect2">
<h3 id="_software_installation">2.4. Software installation</h3>
<div class="paragraph">
<p>Operators use the software installation at the test house on the operational machine. The installation is read only and under configuration control. Only official releases shall be installed on the operational machines. The installation is maintained by the site-operator. Please refer to the <a href="https://ivs-kuleuven.github.io/plato-cgse-doc/docs/installation-manual/">on-line documentation of the Common-EGSE</a> for full installation details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git clone https://github.com/IvS-KULeuven/plato-common-egse.git
$ git checkout tags/&lt;release-tag&gt; -b &lt;release-tag&gt;-branch
$ python3.8 setup.py install --home=/cgse</pre>
</div>
</div>
<div class="paragraph">
<p>The test-developer uses an installation that is more suited for development of scripts and can be changed. The test-developer has forked the repo on the GitHub website to her personal GitHub account and clones the repo from that account. She works in a virtual environment. Please refer to the <a href="https://ivs-kuleuven.github.io/plato-cgse-doc/docs/installation-manual/">Common-EGSE on-line docs</a> for full details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git clone https://github.com/&lt;github-username&gt;/plato-common-egse.git
$ source venv/bin/activate
$ python3.8 setup.py develop</pre>
</div>
</div>
<div class="paragraph">
<p>Please note that the installation examples above are simplified and serve as a reminder. The full installation process is detailed in the on-line Common-EGSE documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_naming_convention">2.5. Naming Convention</h3>
<div class="paragraph">
<p>The table below summarises the coding style that we have adopted for this project.  More detailed information can be found in the on-line documentation at github.io: <a href="https://ivs-kuleuven.github.io/plato-cgse-doc/asciidocs/developer-manual.html#_part_i_development_notions">Development notions: Style Guide</a></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Summary of the adopted code style.</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Style</th>
<th class="tableblock halign-left valign-top">Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variables, building_block parameters, Entries in setup files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lowercase with underscores</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">key, last_value, model, index, user_info</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Methods, functions, building_blocks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lowercase with underscores</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">get_value, set_mask, create_image</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Classes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CapWords (no underscores)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ProcessManager, ImageViewer, CommandList, Observation, MetaData</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constants</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UPPERCASE with underscores</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAX_LINES, BLACK, COMMANDING_PORT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modules &amp; Packages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lowercase without underscores</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dataset, commanding, multiprocessing</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">Top-level scripts</dt>
<dd>
<p>Top-level scripts start with the test identifier from the test specification, followed by a descriptive name in lowercase, words separated by underscores, e.g., <code>cam_tvpt_010_best_focus_determination.py</code>.</p>
</dd>
<dt class="hdlist1">Building blocks</dt>
<dd>
<p>Building blocks are normal function definitions that are decorated with @building_block to identify them as separated by one underscore, i.e., snake_case.</p>
</dd>
<dt class="hdlist1">User utility functions</dt>
<dd>
<p>User functions are normal Python functions and follow normal Python function naming conventions, i.e., all lower case and words separated by underscores, i.e., snake_case.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_script_architecture">3. Test script architecture</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview">3.1. Overview</h3>
<div class="paragraph">
<p>At the user level, the PLATO commanding resides upon a few key concepts</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Building-block</strong>: a building block is a Python function implementing the commands corresponding to a logical entity within a test (a Lego©-bloc) or an entire test (the Lego©-house, called “test-script”).</p>
</li>
<li>
<p><strong>Test-script</strong>: a test-script is a building block encapsulating all the commands necessary for a given test. The name of a test-script should identify it in the test-specification document (RD-03). The test-script should be unique, i.e. the test script for any given test should be useable in all test-houses.</p>
</li>
<li>
<p><strong>Execution</strong>: building blocks, and only building blocks, can be executed, i.e. run on the operational machine inside the test-environment.</p>
</li>
<li>
<p><strong>Observation</strong>: executing a building block triggers the creation of an “observation”. An observation is defined by a unique “observation identifier” (obsid) and lasts as long as the execution of the corresponding test (building block).</p>
</li>
<li>
<p><strong>Setup</strong>:  a Setup encapsulates the complete configuration of the test-environment (test-equipment) and of the camera (test-item) as well as all calibration files associated either to the hardware, or necessary for a given test.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More information on some of these elements are given in the next sections. The figure below describes the generic software architecture in place for the PLATO commanding:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>At the top level</p>
<div class="ulist">
<ul>
<li>
<p>a test script implements an entire test.</p>
</li>
</ul>
</div>
</li>
<li>
<p>At an intermediate level</p>
<div class="ulist">
<ul>
<li>
<p>The test script can call Python functions (e.g. “calculate the next FOV position to visit”) or lower level building blocks (e.g. “go to the next FOV position” or “acquire images over a 5x5 dither pattern”)</p>
</li>
<li>
<p>Building blocks can call other building blocks, or regular Python functions (recursion is forbidden within building blocks)</p>
</li>
<li>
<p>Functions can call other functions, but should not call building blocks</p>
</li>
</ul>
</div>
</li>
<li>
<p>At the lowest level, the Common-EGSE software provides all the “atomic commands” necessary to interface with the hardware. This layer allows to provide the users with user-friendly commands (e.g. human-readable parameter names, and no bit-field or hexadecimal numbers to provide).</p>
</li>
<li>
<p>The active test-setup is available at all levels to provide all necessary information with respect to hardware or calibration.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/ts-architecture.png" alt="ts architecture">
</div>
<div class="title">Figure 1. Test Scripts architecture and its relation to the Common-EGSE and the GSE and SUT.</div>
</div>
</div>
<div class="sect2">
<h3 id="_building_block">3.2. Building block</h3>
<div class="sect3">
<h4 id="_definition_of_a_building_block">3.2.1. Definition of a building block</h4>
<div class="paragraph">
<p>A building block is a Python function marked with a specific decorator in the code. That simply means that the line directly above the definition of the building block in the code should be <code>@building_block</code>:</p>
</div>
<div class="paragraph">
<p>Example of a building block definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>@building_block
def move_filter_wheel(position=None):
    # your code comes here
    return True</code></pre>
</div>
</div>
<div class="paragraph">
<p>All parameters of a building block are keyword parameters. That means the parameter name and its value must be specified when calling the building block.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>...
move_filter_wheel(position="A")
...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_building_block_justification">3.2.2. Building block justification</h4>
<div class="paragraph">
<p><strong>Execution</strong>: Building blocks are the only entity in the code that will be accepted for execution on the operational machines in the test-environments (THs).</p>
</div>
<div class="paragraph">
<p><strong>Structure</strong>: a unique identifier (BBID) is automatically attributed to every building block entering the plato-test-scripts repository. At every moment during a test execution, the current BBID is recorded in the data (TBC).</p>
</div>
<div class="paragraph">
<p>Organising a test script into a logical structure and implementing the underlying building blocks accordingly will help structure the data, which in turn will be precious to ease the analysis.</p>
</div>
<div class="paragraph">
<p>For instance, if a test-script (BB1) is calling building blocks BB2 and BB3 sequentially, the telemetry will contain a sequence of timestamps where the individual building-blocks start, or end.</p>
</div>
<div class="paragraph">
<p>Note that, as a further convenience, a building block counter (BBCOUNT) will also be recorded, which is a natural number incremented by one every time the active BBID is changing, hence running from 0 to 4 in the example above (TBC).</p>
</div>
</div>
<div class="sect3">
<h4 id="_the_properties_of_a_building_block">3.2.3. The properties of a building block</h4>
<div class="paragraph">
<p>Building blocks implement some safeguards, imposing a number of limitations on the code</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Building blocks cannot be called recursively. Beware of building blocks calling other building blocks. Avoid too many layers. Avoid functions calling building blocks</p>
</li>
<li>
<p>At run time, the names and the values of every arguments of a building blocks must be explicitly given. Building blocks with many parameters are hence strongly discouraged</p>
</li>
<li>
<p><code>def my_block(param1, param2=3)</code>: is forbidden for 2 reasons</p>
<div class="ulist">
<ul>
<li>
<p>Positional arguments are forbidden (<code>param1</code>)</p>
</li>
<li>
<p>All arguments must be given the default value <code>None</code> (<code>param2</code>). The reason for this is that we want, when the building block is called, all arguments to be passed explicitly, not implicitly.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_using_default_argument_values_in_a_building_block">3.2.4. Using default argument values in a building block</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
we strongly discourage using this way of '<em>work around default parameters</em>'. It is currently still implemented in the core system, but this behaviour might/will be removed in the future.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the code definition, it is not possible (prev. subsection).</p>
</div>
<div class="paragraph">
<p>It is nevertheless possible via an input file. The input file must</p>
</div>
<div class="ulist">
<ul>
<li>
<p>be in YAML format</p>
</li>
<li>
<p>bear the same name as the building block it corresponds to</p>
</li>
<li>
<p>be put in directory camtest/commanding/input</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example: building block <code>camtest/commanding/hk_only.py</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>@building_block
def hk_only(wait_time=None):
    time.sleep(wait_time)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Corresponding input file <code>camtest/commanding/input/hk_only.yaml</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre># 'hk_only' - Building Block
Args:
    wait_time:         10         # System idle time [seconds]</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_utility_building_blocks">3.2.5. Utility building blocks</h4>
<div class="paragraph">
<p>A collection of low-level, general purpose building blocks is already provided in the commanding section of the plato-test-scripts (<code>camtest/commanding</code>), to help the test-developer, for instance to manipulate some hardware device, tune the OGSE light intensity, set the FEEs in different operating modes, acquire a number of full-frame images etc.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_execution">4. Test execution</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="test-execution">4.1. Test execution: execute</h3>
<div class="paragraph">
<p>The execution of a test is triggered by the Python function <code>execute()</code>. Like <code>@building_block</code>, it is a core functionality implemented by plato-test-scripts. It can be used with the following syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; execute(building_block_name, param1=value1, param2=value2)</code></pre>
</div>
</div>
<div class="paragraph">
<p>All parameters must be specified by their name. No positional argument is allowed; hence the order of the parameters is not important. Note that the building block name does not have the paranthesis <code>'()'</code>, only the name of the building block is given.</p>
</div>
<div class="paragraph">
<p>The execute command will start an observation and end the observation when the building block returns. Starting and ending an observation is an expensive operation in the sense that it notifies underlying mechanisms like the configuration and storage manager of the observation so they can take action. Therefore, although any building block can be executed using the <code>execute(..)</code> command, this should really only be used for higher level building blocks and from the Python prompt. Never use the <code>execute(..)</code> function inside a building block.</p>
</div>
</div>
<div class="sect2">
<h3 id="_preview_the_command_sequence">4.2. Preview the command sequence</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This functionality will be removed in the future as it has only limited applicability and doesn&#8217;t give a full consistent view of the command sequence.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is possible to perform a dry-run of a building-block by running <code>generate_command_sequence()</code> instead of <code>execute()</code>, with the same syntax. Be aware that the duration of the dry run may be as long as the execution itself!</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; generate_command_sequence(building_block_name, param1=value1, param2=value2)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This feature will execute all building blocks and functions without actually sending command strings to the test equipment. The current implementation does not take return values from device queries into account which makes it less suited for test scripts that need this feedback for conditional processing, e.g., waiting until a temperature is reached.</p>
</div>
<div class="paragraph">
<p>Note that <code>execute</code> and <code>generate_command_sequence</code> will only work under a set of restrictive conditions</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Disposing of software simulators for every piece of equipment addressed by the test. Simulators exist in the EGSE for the N-FEEs and most of the equipment to be used in CSL.</p>
</li>
<li>
<p>Emulating an operational environment on your machine. We refer you to the EGSE documentation for the details of what this entails</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_executing_short_building_blocks_individually">4.3. Executing short building blocks individually</h3>
<div class="paragraph">
<p>The execute command will trigger the creation of an obsid and an associated data stream. In the case were the operator (e.g. while setting up and testing the TH environment) want to execute short commands or building blocks outside of the scope of a test-script, this is an overkill and will make the analysis of the resulting data very cumbersome, because the data will be distributed over many very very short obsids.</p>
</div>
<div class="paragraph">
<p>To work around this, it is possible to manually start and stop an observation</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; start_observation("Running a few examples")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will start an observation, attribute it an obsid and the associated data stream, just like what happens at the start of an <code>execute</code>.</p>
</div>
<div class="paragraph">
<p>After that any command passed (individually or within a function/building block) and any data generated will be recorded as part of the running obsid:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; command(args)
&gt;&gt;&gt; func(args)
&gt;&gt;&gt; building_block(args)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; end_observation()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will close the observation (or do nothing if none is running).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data-acquisition-and-storage">5. Data acquisition and storage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All device housekeeping data and all camera telemetry data (image data and FEE HK) are automatically stored by the Storage Manager. You don’t need to collect and save data from within your scripts. Data is stored in a location on the egse-server and accessible from the desktop client machines running the tests and analysis scripts. This location is defined in the environment variable <code>PLATO_DATA_STORAGE_LOCATION</code>, which points to a <code>/data</code> directory.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since release 2023.6.0+CGSE, the environment variable <code>PLATO_DATA_STORAGE_LOCATION</code> will not include the SITE ID anymore.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Several types of data are generated during a test campaign</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Housekeeping telemetry (saved in CSV files)</p>
<div class="ulist">
<ul>
<li>
<p>From the test-item (e.g. TOU TRP-1 temperature)</p>
</li>
<li>
<p>From the test-environment (e.g. OGSE filter wheel position)</p>
</li>
</ul>
</div>
</li>
<li>
<p>SpaceWire packets and register maps received from the FEE (saved in HDF5 files)</p>
</li>
<li>
<p>Image data from the camera (saved in FITS files)</p>
</li>
<li>
<p>Command history logging the test executions</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_housekeeping_telemetry">5.1. Housekeeping telemetry</h3>
<div class="paragraph">
<p>The acquisition of housekeeping telemetry is automatically started by the egse-server. In practice that means that the telemetry from all devices connected to the active egse-server is automatically, and constantly recorded (see the Common-EGSE documentation for further details).</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Please note that <strong>all timestamps</strong> saved in housekeeping files are UTC.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The housekeeping telemetry is structured this way</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One file per day saved in a sub-folder of ‘daily’. The sub-folder is the <code>YYYYMMDD</code> of that day.</p>
</li>
<li>
<p>One CSV file per source of telemetry, i.e. for example one from the TCS, one for the hexapod (controller), one for the FEE etc.</p>
</li>
<li>
<p>Each CSV file contains a timestamp in the first columns, and the various entries in the subsequent columns.</p>
</li>
<li>
<p>All TM are recorded at 1Hz by default. This is configurable on a per-device-controller basis (= per CSV file)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The csv filenames have the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>YYYYMMDD_SITE_DEVICE.csv</pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>YYYYMMDD</code> is the day the telemetry was taken</p>
</li>
<li>
<p><code>SITE</code> is the identifier for the test facility: CSL, IAS, INTA, SRON, KUL, ESA, …</p>
</li>
<li>
<p><code>DEVICE</code> is a mnemonic referring to the device controller issuing these data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the daily file at CSL for the Hexapod PUNA housekeeping on June 8th, 2023 is 20230608_CSL_PUNA.csv. The header of the CSV files contains explicit column-names. The complete information on the content and format of the telemetry files is contained in the ICD (RD-04, see <a href="#reference-documents">Reference Documents</a>).</p>
</div>
<details>
<summary class="title">Excerpt of the PUNA hexapod telemetry file <code>20230608_CSL_PUNA.csv</code>:</summary>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>timestamp,GCSL1_HEX_USER_T_X,GCSL1_HEX_USER_T_Y,GCSL1_HEX_USER_T_Z,GCSL1_HEX_USER_R_X,GCSL1_HEX_USER_R_Y,GCSL1_HEX_USER_R_Z,GCSL1_HEX_MACH_T_X,GCSL1_HEX_MACH_T_Y,GCSL1_HEX_MACH_T_Z,GCSL1_HEX_MACH_R_X,GCSL1_HEX_MACH_R_Y,GCSL1_HEX_MACH_R_Z,GCSL1_HEX_ALEN_1,GCSL1_HEX_ALEN_2,GCSL1_HEX_ALEN_3,GCSL1_HEX_ALEN_4,GCSL1_HEX_ALEN_5,GCSL1_HEX_ALEN_6,GCSL1_HEX_HOMED,GCSL1_HEX_IN_POS
...
2023-06-08T10:00:01.560+0000,0.014144539424,-0.003925761937,-3.489246984,-0.013989085157,0.0010419456108,-0.00799891817,0.390713812,0.1455886605,17.7970682,0.03226852454,0.06991046997,0.2646041152,205.93219583,206.1653351,205.52915657,205.97228441,205.88274269,206.14508725,True,True
2023-06-08T10:00:02.560+0000,0.014144539424,-0.003925761937,-3.489246984,-0.013989085157,0.0010419456108,-0.00799891817,0.390713812,0.1455886605,17.7970682,0.03226852454,0.06991046997,0.2646041152,205.93219583,206.1653351,205.52915657,205.97228296,205.88274269,206.14508725,True,True
2023-06-08T10:00:03.563+0000,0.014144539424,-0.003925761937,-3.489246984,-0.013989085157,0.0010419456108,-0.00799891817,0.390713812,0.1455886605,17.7970682,0.03226852454,0.06991046997,0.2646041152,205.93219583,206.1653351,205.52915657,205.97227986,205.88274269,206.14508725,True,True
2023-06-08T10:00:04.562+0000,0.014144539424,-0.003925761937,-3.489246984,-0.013989085157,0.0010419456108,-0.00799891817,0.390713812,0.1455886605,17.7970682,0.03226852454,0.06991046997,0.2646041152,205.93219583,206.1653351,205.52915657,205.97227986,205.88274579,206.14508725,True,True
2023-06-08T10:00:05.562+0000,0.014144539424,-0.003925761937,-3.489246984,-0.013989085157,0.0010419456108,-0.00799891817,0.390713812,0.1455886605,17.7970682,0.03226852454,0.06991046997,0.2646041152,205.93219583,206.1653351,205.52915657,205.97227986,205.88274269,206.14508725,True,True
2023-06-08T10:00:06.581+0000,0.014144539424,-0.003925761937,-3.489246984,-0.013989085157,0.0010419456108,-0.00799891817,0.390713812,0.1455886605,17.7970682,0.03226852454,0.06991046997,0.2646041152,205.93219583,206.16534276,205.52915967,205.97228296,205.88274579,206.14508725,True,True</code></pre>
</div>
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="_observation">5.2. Observation</h3>
<div class="paragraph">
<p>Image data are usually only generated during a test execution. In order to facilitate the selection of data pertaining to a particular test execution, we are using the concept of ‘observation’ interchangeably with the name “test”.</p>
</div>
<div class="paragraph">
<p>An observation corresponds to a single execution of a given test, i.e. a single use of the execute() command, or all commands executed between a <code>start_observation</code> and an <code>end_observation</code>.</p>
</div>
<div class="paragraph">
<p>A unique obsid is automatically attributed to every observation. The filenames of housekeeping files are constructed from the unique obsid and a limited set of useful metadata about the test execution, with the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>TEST_SITE_SETUP_DEVICE_YYYYMMDD_HHMMSS.csv</pre>
</div>
</div>
<div class="paragraph">
<p>where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TEST</code> is a unique test identifier, this is the first part of a full OBSID,</p>
</li>
<li>
<p><code>SITE</code> is the identifier for the test facility: CSL, IAS, INTA, SRON, KUL, ESA, …</p>
</li>
<li>
<p><code>SETUP</code> is the unique setup_id (section below)</p>
</li>
<li>
<p><code>DEVICE</code> is a mnemonic referring to the source of the data, e.g. the device controller issuing these data, the TCS EGSE, the N-FEE, etc.</p>
</li>
<li>
<p><code>YYYYMMDD_HHMMSS</code> points to the start of the test execution (UTC)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first three items in the above list form the full OBSID. The OBSID can be abbreviated to the TEST-ID and the SITE-ID thereby omitting the SETUP-ID which can be automatically recovered from the meta data.</p>
</div>
<div class="paragraph">
<p>For instance, CSV files for observation 00757 performed at CSL could be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>00757_CSL_00009_PUNA_20201013_162037.csv</code></p>
</li>
<li>
<p><code>00757_CSL_00009_CM_20201013_162037.csv</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>(PUNA points to a hexapod controller and CM refers to the Configuration Manager of the Common-EGSE).</p>
</div>
<div class="paragraph">
<p>For FITS files with the camera image data, the naming convention is similar (though we leave out the timestamp), with a sequencing number when the data volume justifies splitting of the data over multiple files.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>00757_CSL_00009_N-FEE_CCD_00001_20201013_cube.fits</code></p>
</li>
<li>
<p><code>00757_CSL_00009_N-FEE_CCD_00002_20201013_cube.fits</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that we used to have two types of FITS files: FITS files in which the data is organised in a flat structure, and FITS files in which the data is organised in cubes (with filenames as described above).  The former will have "image" in their names (rather than "cube") but will be removed once the corresponding cube-structure FITS file has been created.</p>
</div>
<div class="paragraph">
<p>All data corresponding to the obsid are gathered in a dedicated directory named ‘obs’. That means that the fraction of the regular housekeeping data acquired during the execution of the observation is duplicated in that directory, keeping the same format as in the “daily” directory.</p>
</div>
<div class="paragraph">
<p>The data is hence stored in two different directories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A “daily” directory, accumulating housekeeping telemetry data all day long (e.g. for trend analysis). Each day has its own sub-folder.</p>
</li>
<li>
<p>An “obs” directory, recording only observation-specific data and housekeeping in sub-folders containing the camera name also, e.g. <code>01061_CSL1_duvel</code> is observation 1061 taken in clean room 1 at CSL for the FM#3, i.e. Duvel.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/obs-vs-daily-storage.png" alt="obs vs daily storage">
</div>
<div class="title">Figure 2. Timeline illustrating how data is generated and stored. Telemetry for all devices is continuously generated and stored in the daily files. When an observation is started, telemetry is also stored in the 'obs' area under the sub-folder for the current observation. These telemetry are a mirror of the daily telemetry for that observation. Time goes from left to right.</div>
</div>
</div>
<div class="sect2">
<h3 id="_image_data">5.3. Image data</h3>
<div class="paragraph">
<p>Image data are saved for each test execution as FITS files, with the
corresponding housekeeping in csv files (see above).</p>
</div>
<div class="paragraph">
<p>Images are saved in FITS format, as UNSIGNED integers. You will have to
cast them to float explicitly in python to avoid negative numbers to be
wrongly interpreted.</p>
</div>
<div class="paragraph">
<p><strong>Splitting:</strong> The DPU monitors a set of "crucial parameters" (see
further) and each time at least one of these changes, a new FITS file
will be created, provided the FEE is in full-image mode (or full-image
pattern mode). Additionally, a maximum number of extensions is specified
in the configuration (TBD). When that number is achieved, the image data
are split, i.e. a new FITS file is opened to store the next block of
image data.</p>
</div>
<div class="paragraph">
<p><strong>Slicing:</strong> In a future version of the software, it will be possible to
insert a given command in the test scripts in order to force the
creation of a new FITS file. This will allow for a more flexible slicing
of the data, i.e. enforce a clearer structure of the data, matching the
commanding logic, and will facilitate the data analysis and
interpretation.</p>
</div>
<div class="paragraph">
<p><strong>Crucial parameters:</strong> As mentioned before, the DPU monitors (for changes
in) crucial parameters. These are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the first and last row that will be transmitted (<code>v_start</code> and <code>v_end</code>),</p>
</li>
<li>
<p>the last column that will be transmitted (<code>h_end</code>),</p>
</li>
<li>
<p>the number of rows that will be dumped after the requested number of
rows have been transmitted (<code>rows_final_dump</code>),</p>
</li>
<li>
<p>the readout order of the CCDs (<code>ccd_readout_order</code>),</p>
</li>
<li>
<p>and the FEE mode (<code>ccd_mode_config</code>), which should become/stay
full-image mode or full-image pattern mode.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_data_products">5.3.1. Data products</h4>
<div class="paragraph">
<p>During the camera tests, the DPU will be configured such that a specific part of the E- and/or F-side of the selected CCDs will be transmitted (in the form of SpW packets) for a specified number of cycles (as explained in <a href="#standard-building-block-parameters">Section 12.4.2</a>).  The following information will be reconstructed from these SpW packets and stored in FITS files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the transmitted image data from the selected side(s) of the selected CCDs, for all cycles,</p>
</li>
<li>
<p>the transmitted serial pre-scan data of the selected side(s) of the selected CCDs, for all cycles,</p>
</li>
<li>
<p>the transmitted serial over-scan data of the selected side(s) of the selected CCDs, for all cycles,</p>
</li>
<li>
<p>the transmitted parallel over-scan data of the selected side(s) of the selected CCDs, for all cycles.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>While the SpW packets come in, the individual exposures are stored in individual extensions in FITS files that carry "images" in their name.  This type of data arrangement is called a "flat structure".  When there&#8217;s a change in crucial parameters, a new FITS file will be constructed (with "cube" in its name), based on the flat-structure FITS file, in which the exposures are aggregated into cubes.  The original, flat-structure file will be removed from the system.</p>
</div>
<div class="paragraph">
<p>For analysis, only the FITS files with the cubes will be available, and therefore only the structure of these will be discussed in the section below.</p>
</div>
<div class="paragraph">
<p>In case both sides of a CCD are selected, the image data of both sides will be stitched together before storing it in the FITS file.  This will also be done for the parallel over-scan data (if present).  For the serial pre-scan and the serial over-scan, the information is stored per CCD side.</p>
</div>
</div>
<div class="sect3">
<h4 id="_internal_structure">5.3.2. Internal structure</h4>
<div class="paragraph">
<p>Each of the extensions (apart from the PRIMARY extension) will occur only once and comprise a 3D data array and a header with the metadata that is specific to that extension.   The name of an extension will reflect what type of data product it comprises (e.g. image data of the F-side of CCD2, serial pre-scan data of the E-side of CCD3, etc.).</p>
</div>
<div class="paragraph">
<p>Although we have provided a set of convenience functions (see below) to extract information from a FITS file without being exposed to the internal details, we want to explain the internal structure in more detail.</p>
</div>
<div class="paragraph">
<p>The following extensions can be included in the FITS files:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Extension name</th>
<th class="tableblock halign-left valign-top">Content</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PRIMARY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Contains only header information, with metadata that pertains
to the whole data product (site name, etc.). This extension always be
present.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPRE_&lt;1/2/3/4&gt;_&lt;E/F&gt;</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Serial pre-scan data for the E-/F-side of CCD1/2/3/4. This extension
will occur once (with all exposures included), if that side of that CCD
was transmitted.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SOVER_&lt;1/2/3/4&gt;_&lt;E/F&gt;</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Serial over-scan data for the E-/F-side of CCD1/2/3/4. I f this
information is transmitted, this extension will occur once.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">POVER_&lt;1/2/3/4&gt;_&lt;E/F&gt;</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Parallel over-scan data for the E-/F-side of CCD1/2/3/4. If this
information is transmitted, this extension will occur once.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IMAGE_&lt;1/2/3/4&gt;_&lt;E/F&gt;</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Image data for the E-/F-side of CCD1/2/3/4. This extension will occur
once (with all exposures included), if that-side of that CCD was
transmitted.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WCS-TAB_&lt;1/2/3/4&gt;_&lt;E/F&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Table with a single column (with the name
TIME) in which the relative time (in seconds) w.r.t. the first exposure
(of any CCD (side)) in the file is listed.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example 1</strong>: 4CCDs, full frame, 10 cycles</p>
</div>
<div class="paragraph">
<p>Relevant FEE parameters (see <a href="#standard-building-block-parameters">Section 12.4.2</a>]):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ccd_readout = [1, 2, 3, 4];</p>
</li>
<li>
<p>ccd_side = BOTH;</p>
</li>
<li>
<p>num_cycles = 10;</p>
</li>
<li>
<p>row_start = 0;</p>
</li>
<li>
<p>row_end = 4510 + 30 - 1 (i.e. 4510 rows from the image + 30 rows from the parallel over-scan);</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Structure/extensions of the FITS file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PRIMARY</code>: The primary extension (PrimaryHDU object). This does not
contain any transmitted data.</p>
</li>
<li>
<p>For CCD1:</p>
<div class="ulist">
<ul>
<li>
<p>1 extension <code>SPRE_1_E</code>: The serial pre-scan for the E-side of CCD1 (10 frames)<br>
→ dimensions: 25 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>SPRE_1_F</code>: The serial pre-scan for the F-side of CCD1 (10 frames)<br>
→ dimensions: 25 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>SOVER_1_E</code>: The serial over-scan for the E-side of CCD1 (10 frames)<br>
→ dimensions: 15 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 in extension <code>SOVER_1_F</code>: The serial over-scan for the F-side of CCD1 (10 frames)<br>
→ dimensions: 15 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>POVER_1_E</code>: The parallel over-scan for the E-side of CCD1 (10 frames)<br>
→ dimensions: 2255 columns x 30 rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>POVER_1_F</code>: The parallel over-scan for the F-side of CCD1 (10 frames)<br>
→ dimensions: 2255 columns x 30 rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>IMAGE_1_E</code>: The image data for the E-side of CCD1 (10 frames)<br>
→ dimensions: 2255 columns x 4510 rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>IMAGE_1_E</code>: The image data of CCD1 (10 frames)<br>
→ dimensions: 2255 columns x 4510 rows x 10 layers</p>
</li>
</ul>
</div>
</li>
<li>
<p>For CCD2:</p>
<div class="ulist">
<ul>
<li>
<p>1 extension <code>SPRE_2_E</code>: The serial pre-scan for the E-side of CCD2 (10 frames)<br>
→ dimensions: 25 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>SPRE_2_F</code>: The serial pre-scan for the F-side of CCD2 (10 frames)<br>
→ dimensions: 25 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>SOVER_2_E</code>: The serial over-scan for the E-side of CCD2 (10 frames)<br>
→ dimensions: 15 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 in extension <code>SOVER_2_F</code>: The serial over-scan for the F-side of CCD2 (10 frames)<br>
→ dimensions: 15 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>POVER_2_E</code>: The parallel over-scan for the E-side of CCD2 (10 frames)<br>
→ dimensions: 2255 columns x 30 rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>POVER_2_F</code>: The parallel over-scan for the F-side of CCD2 (10 frames)<br>
→ dimensions: 2255 columns x 30 rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>IMAGE_2_E</code>: The image data for the E-side of CCD2 (10 frames)<br>
→ dimensions: 2255 columns x 4510 rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>IMAGE_2_E</code>: The image data of CCD2 (10 frames)<br>
→ dimensions: 2255 columns x 4510 rows x 10 layers</p>
</li>
</ul>
</div>
</li>
<li>
<p>For CCD3:</p>
<div class="ulist">
<ul>
<li>
<p>1 extension <code>SPRE_3_E</code>: The serial pre-scan for the E-side of CCD3 (10 frames)<br>
→ dimensions: 25 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>SPRE_3_F</code>: The serial pre-scan for the F-side of CCD3 (10 frames)<br>
→ dimensions: 25 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>SOVER_3_E</code>: The serial over-scan for the E-side of CCD3 (10 frames)<br>
→ dimensions: 15 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 in extension <code>SOVER_3_F</code>: The serial over-scan for the F-side of CCD3 (10 frames)<br>
→ dimensions: 15 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>POVER_3_E</code>: The parallel over-scan for the E-side of CCD3 (10 frames)<br>
→ dimensions: 2255 columns x 30 rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>POVER_3_F</code>: The parallel over-scan for the F-side of CCD3 (10 frames)<br>
→ dimensions: 2255 columns x 30 rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>IMAGE_3_E</code>: The image data for the E-side of CCD3 (10 frames)<br>
→ dimensions: 2255 columns x 4510 rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>IMAGE_3_E</code>: The image data of CCD3 (10 frames)<br>
→ dimensions: 2255 columns x 4510 rows x 10 layers</p>
</li>
</ul>
</div>
</li>
<li>
<p>For CCD4:</p>
<div class="ulist">
<ul>
<li>
<p>1 extension <code>SPRE_4_E</code>: The serial pre-scan for the E-side of CCD4 (10 frames)<br>
→ dimensions: 25 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>SPRE_4_F</code>: The serial pre-scan for the F-side of CCD4 (10 frames)<br>
→ dimensions: 25 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>SOVER_4_E</code>: The serial over-scan for the E-side of CCD4 (10 frames)<br>
→ dimensions: 15 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 in extension <code>SOVER_4_F</code>: The serial over-scan for the F-side of CCD4 (10 frames)<br>
→ dimensions: 15 columns x (4510 + 30) rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>POVER_4_E</code>: The parallel over-scan for the E-side of CCD4 (10 frames)<br>
→ dimensions: 2255 columns x 30 rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>POVER_4_F</code>: The parallel over-scan for the F-side of CCD4 (10 frames)<br>
→ dimensions: 2255 columns x 30 rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>IMAGE_4_E</code>: The image data for the E-side of CCD4 (10 frames)<br>
→ dimensions: 2255 columns x 4510 rows x 10 layers</p>
</li>
<li>
<p>1 extension <code>IMAGE_4_E</code>: The image data of CCD4 (10 frames)<br>
→ dimensions: 2255 columns x 4510 rows x 10 layers</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Example 2</strong>: E-side of CCD2, 100 lines in partial-readout mode, 25 cycles</p>
</div>
<div class="paragraph">
<p>Relevant FEE parameters (see <a href="#standard-building-block-parameters">Section 12.4.2</a>]):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ccd_readout = [2, 2, 2, 2];</p>
</li>
<li>
<p>ccd_side = E;</p>
</li>
<li>
<p>num_cycles = 25;</p>
</li>
<li>
<p>row_end = row_start - 100 - 1</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that this means that the E-side of CCD2 will be transmitted 4x25 times.</p>
</div>
<div class="paragraph">
<p>Structure/extensions of the FITS file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PRIMARY</code>: The primary extension (PrimaryHDU object).  This does not contain any transmitted data.</p>
</li>
<li>
<p>For CCD2:</p>
<div class="ulist">
<ul>
<li>
<p>1 extension <code>SPRE_2_E</code>: The serial pre-scan for the E-side of CCD2 (4x25 frames)<br>
→ dimensions: 25 columns x (4510 + 30) rows x 100 layers</p>
</li>
<li>
<p>1 extension <code>SOVER_2_E</code>: The serial over-scan for the E-side of CCD2 (4x25 frames)<br>
→ dimensions: 15 columns x (4510 + 30) rows x 100 layers</p>
</li>
<li>
<p>1 extension <code>POVER_2</code>: The parallel over-scan for the E-side of CCD2 (4x25 frames)<br>
→ dimensions: 4510 columns x 30 rows x 100 layers</p>
</li>
<li>
<p>1 extension <code>IMAGE_2</code>: The image data of CCD2 (4x25 frames)<br>
→ dimensions: 4510 columns x 4510 rows x 100 layers</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_inspecting_the_content">5.3.3. Inspecting the content</h4>
<div class="paragraph">
<p>In the test scripts analysis package, i.e. the <code>fitsfiles.py</code> in <code>camtest.analysis.functions</code>, a number of convenience functions have been implemented to access information in the FITS files without detailed knowledge of the file structure. The remainder of this section will explain how to use these functions to access the different data parts in the FITS files.</p>
</div>
<div class="sect4">
<h5 id="_overview_2">5.3.3.1. Overview</h5>
<div class="paragraph">
<p>The structure of the FITS files can be inspected with the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; get_overview(filename)</pre>
</div>
</div>
<div class="paragraph">
<p>The output looks like to this (here only the E-side of CCD1 has been transmitted, without parallel over-scan):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>No.    Name      Ver    Type      Cards   Dimensions   Format
0  PRIMARY       1 PrimaryHDU       5   ()
1  SPRE_1_E      0 ImageHDU        12   (25, 100)   float64
2  SOVER_1_E     0 ImageHDU        12   (15, 100)   float64
3  IMAGE_1       0 ImageHDU        28   (2255, 100)   float64
4  SPRE_1_E      0 ImageHDU        12   (25, 100)   float64
5  SOVER_1_E     0 ImageHDU        12   (15, 100)   float64
6  IMAGE_1       0 ImageHDU        28   (2255, 100)   float64
7  SPRE_1_E      0 ImageHDU        12   (25, 100)   float64
8  SOVER_1_E     0 ImageHDU        12   (15, 100)   float64
9  IMAGE_1       0 ImageHDU        28   (2255, 100)   float64
10  SPRE_1_E      0 ImageHDU        12   (25, 100)   float64
11  SOVER_1_E     0 ImageHDU        12   (15, 100)   float64
12  IMAGE_1       0 ImageHDU        28   (2255, 100)   float64</pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can get hold of a list with the extension names with</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; get_ext_names(filename)</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_primary_header">5.3.3.2. Primary header</h5>
<div class="paragraph">
<p>The primary header can be retrieved as</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; primary_header = get_primary_header(filename)</pre>
</div>
</div>
<div class="paragraph">
<p>Note that all headers (for the primary header as well as for the other datasets) are returned as <code>astropy.io.fits.header.Header</code> objects. To get hold of the value of a specific header key, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; header[key]</pre>
</div>
</div>
<div class="paragraph">
<p>The relevant keywords in the primary header are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LEVEL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is present for historical reason and is fixed at 2, which indicates that it is a FITS file in which the data has been arranged into cubes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">V_START</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The index of the first row that is transmitted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">V_END</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The index of the last row that is transmitted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">H_END</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The index of the last column that is transmitted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ROWS_FINAL_DUMP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of rows that are dumped after the requested number of rows is transmitted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TELESCOP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "PLATO".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INSTRUME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The camera ID (as taken from the setup).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SITENAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the test site at which the data was acquired.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SETUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The setup ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCD_READOUT_ORDER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String representation of an array with the order inwhich the CCDs will be read out.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CYCLETIME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The image cycle time [s].</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">READTIME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time needed to read out the requested part for a single CCD side [s].</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OBSID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The observation identifier.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE-OBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The timestamp of the first exposure (of any side of any CCD in the file).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CGSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version of the Common EGSE with which the FITS file was produced.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_images">5.3.3.3. Images</h5>
<div class="paragraph">
<p>The image data of a specific exposure (counting starts at zero) of a specific side of a specific CCD can be retrieved as a numpy array, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; image_data = get_image_data(filename, ccd_number, ccd_side, exposure_number)</pre>
</div>
</div>
<div class="paragraph">
<p>You can retrieve the image cubes and header for a specific side of a specific CCD as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; image_cube_data = get_image_cube_data(filename, ccd_number, ccd_side)
&gt;&gt;&gt; image_cube_header = get_image_cube_header(filename, ccd_number, ccd_side)</pre>
</div>
</div>
<div class="paragraph">
<p>The relevant keywords in the image header are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAXIS1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of columns in the image area of the CCD, that are transmitted (max 2255).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAXIS2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of rows in the image area of the CCD, that are transmitted (max 4510).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAXIS3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of exposures.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FOCALLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The focal length of the telescope [mm].</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTYPE1/CTYPE2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "LINEAR" to indicate that a linear coordinate transformation is used (between pixels and mm), both in the column and row direction.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTYPE3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "TIMETAB" to indicate that the 3rd axis will be characterised by tabulated (time) values. In the older FITS files, this was set to "TIME-TAB" (consistent with the Greisen &amp; Calabretta papers), but the C code underlying astropy and the traditional FITS viewer need it to be "TIMETAB" instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CUNIT1/CUNIT2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "MM" to indicate that the focal-plane coordinates are expressed in mm, both in the column and row direction.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CUNIT3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "s" to indicate that the time is expressed in s.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDELT1/CDELT2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pixels size [mm], both in the column and row direction.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PS3_0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "WCS-TAB_&lt;1/2/3/4&gt;_&lt;E/F&gt;" to indicate the the 3rd axis is characterised by the values in in the table, that is stored in a extension with that name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PS3_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "TIME" to indicate that the 3rd axis is characterised by the values in the table (see PS3_0) in the column with that name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SITENAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the test site at which the data was acquired.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTNAME</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The extension name, following the convention:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>IMAGE_&lt;CCD number (1/2/3/4)&gt;_&lt;CCD side (E/F)&gt;</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCD_ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The CCD number (1/2/3/4).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CROTA2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The orientation angle of the CCD [degrees]. This indicates over which angle the CCD reference frame is rotated w.r.t. the focal-plane reference plane, in counter-clockwise direction.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CD1_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The product of the pixel size and the cosine of the CCD orientation angle.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CD1_2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The negative product of the pixel size and the sine of the CCD orientation angle.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CD2_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The product of the pixel size and the sine of the CCD orientation angle.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CD2_2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The product of the pixel size and the cosine of the CCD orientation angle.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CRVAL1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The focal-plane x-coordinate of the CCD origin [mm].</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CRVAL2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The focal-plane y-coordinate of the CCD origin [mm].</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CRPIX1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The column coordinate of the CCD origin w.r.t. the first transmitted column of the image area.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CRPIX2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The row coordinate of the CCD origin w.r.t. the first transmitted row of the image area.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OBSID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The observation identifier.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE-OBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The timestamp of the start of the data acquisition of the first exposure.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_parallel_over_scan">5.3.3.4. Parallel over-scan</h5>
<div class="paragraph">
<p>To get hold of the data (as a numpy array) of a parallel over-scan (if present) for a specific exposure (counting starts at 0) of a specific side of a specific CCD, execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&gt;&gt;&gt; parallel_overscan_data = get_parallel_overscan_data(filename, ccd_number, ccd_SIDE, exposure_number)</pre>
</div>
</div>
<div class="paragraph">
<p>You can retrieve the parallel over-scan data and header for a specific side of a specific CCD as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&gt;&gt;&gt; parallel_overscan_cube_data = get_ parallel_overscan_cube_data(filename, ccd_number, ccd_side)
&gt;&gt;&gt; parallel_overscan _cube_header = get_ parallel_overscan_cube_header(filename, ccd_number, ccd_side)</pre>
</div>
</div>
<div class="paragraph">
<p>The relevant keywords in the parallel over-scan header are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAXIS1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of columns in the parallel over-scan, that are transmitted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAXIS2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of rows in the parallel over-scan of the CCD, that are transmitted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAXIS3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of exposures.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTYPE3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "TIMETAB" to indicate that the 3rd axis will be characterised by tabulated (time) values. In the older FITS files, this was set to "TIME-TAB" (consistent with the Greisen &amp; Calabretta papers), but the C code underlying astropy and the traditional FITS viewer need it to be "TIMETAB" instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CUNIT3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "s" to indicate that the time is expressed in s.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PS3_0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "WCS-TAB_&lt;1/2/3/4&gt;_&lt;E/F&gt;" to indicate the the 3rd axis is characterised by the values in in the table, that is stored in a extension with that name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PS3_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "TIME" to indicate that the 3rd axis is characterised by the values in the table (see PS3_0) in the column with that name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FOCALLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The focal length of the telescope [mm].</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SITENAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the test site at which the data was acquired.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTNAME</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The extension name, following the convention:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>IMAGE_&lt;CCD number (1/2/3/4)&gt;_&lt;CCD side (E/F)&gt;</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCD_ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The CCD number (1/2/3/4).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OBSID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The observation identifier.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE-OBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The timestamp of the start of the data acquisition of the first exposure.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_serial_pre_scan">5.3.3.5. Serial pre-scan</h5>
<div class="paragraph">
<p>To get hold of the data (as a numpy array) of a serial pre-scan for a specific exposure (counting starts at 0) of a specific side of a specific CCD, execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; serial_prescan_data = get_serial_prescan_data(filename, ccd_number, ccd_side, exposure_number)</pre>
</div>
</div>
<div class="paragraph">
<p>You can retrieve the serial pre-scan data and header for a specific side of a specific CCD as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; serial_prescan_cube_data = get_ serial_prescan _cube_data(filename, ccd_number, ccd_side)
&gt;&gt;&gt; serial_prescan _cube_header = get_ serial_prescan_cube_header(filename, ccd_number, ccd_side)</pre>
</div>
</div>
<div class="paragraph">
<p>The relevant keywords in the serial pre-scan header are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAXIS1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of columns in the serial pre-scan (fixed at 25).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAXIS2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of rows in the serial pre-scan, that are transmitted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAXIS3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of exposures.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTYPE3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "TIMETAB" to indicate that the 3rd axis will be characterised by tabulated (time) values. In the older FITS files, this was set to "TIME-TAB" (consistent with the Greisen &amp; Calabretta papers), but the C code underlying astropy and the traditional FITS viewer need it to be "TIMETAB" instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CUNIT3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "s" to indicate that the time is expressed in s.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PS3_0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "WCS-TAB_&lt;1/2/3/4&gt;_&lt;E/F&gt;" to indicate the the 3rd axis is characterised by the values in in the table, that is stored in a extension with that name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PS3_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "TIME" to indicate that the 3rd axis is characterised by the values in the table (see PS3_0) in the column with that name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SITENAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the test site at which the data was acquired.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTNAME</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The extension name, following the convention:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SPRE_&lt;CCD number (1/2/3/4)&gt;_&lt;CCD side (E/F)&gt;</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCD_ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The CCD number (1/2/3/4).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OBSID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The observation identifier.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE-OBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The timestamp of the start of the data acquisition of the first exposure.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_serial_over_scan">5.3.3.6. Serial over-scan</h5>
<div class="paragraph">
<p>To get hold of the data (as a numpy array) of a serial over-scan for a specific exposure (counting starts at 0) of a specific side of a specific CCD, execute the following command</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; serial_overscan_data = get_serial_overscan_data(filename, ccd_number, ccd_side, exposure_number)</pre>
</div>
</div>
<div class="paragraph">
<p>You can retrieve the serial over-scan data and header for a specific side of a specific CCD as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; serial_overscan_cube_data = get_ serial_overscan_cube_data(filename, ccd_number, ccd_side)
&gt;&gt;&gt; serial_overscan _cube_header = get_ serial_overscan_cube_header(filename, ccd_number, ccd_side)</pre>
</div>
</div>
<div class="paragraph">
<p>The relevant keywords in the serial over-scan header are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Keyword</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAXIS1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of columns in the serial over-scan.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAXIS2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of rows in the serial over-scan, that are transmitted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAXIS3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of exposures.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTYPE3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "TIMETAB" to indicate that the 3rd axis will be characterised by tabulated (time) values. In the older FITS files, this was set to "TIME-TAB" (consistent with the Greisen &amp; Calabretta papers), but the C code underlying astropy and the traditional FITS viewer need it to be "TIMETAB" instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CUNIT3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "s" to indicate that the time is expressed in s.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PS3_0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "WCS-TAB_&lt;1/2/3/4&gt;_&lt;E/F&gt;" to indicate the the 3rd axis is characterised by the values in in the table, that is stored in an extension with that name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PS3_1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to "TIME" to indicate that the 3rd axis is characterised by the values in the table (see PS3_0) in the column with that name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SITENAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the test site at which the data was acquired.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTNAME</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The extension name, following the convention:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SOVER_&lt;CCD number (1/2/3/4)&gt;_&lt;CCD side (E/F)&gt;</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCD_ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The CCD number (1/2/3/4).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OBSID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The observation identifier.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE-OBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The timestamp of the start of the data acquisition of the first exposure.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_time">5.3.3.7. Time</h5>
<div class="paragraph">
<p>To get hold of the <strong>relative</strong> time (as a numpy array) in seconds w.r.t. the first exposure (of any side of any CCD in the file) for the exposures for a specific side of a specific CCD, execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; from camtest.analysis.functions.fitsfiles import get_relative_time
&gt;&gt;&gt; relative_time = get_relative_time(filename, ccd_number, ccd_side)
&gt;&gt;&gt; relative_time = get_relative_time(hdu_list_object, ccd_number, ccd_side)</pre>
</div>
</div>
<div class="paragraph">
<p>The <strong>absolute</strong> time (as a numpy array) in seconds since epoch 1958, for the exposures for a specific side of a specific CCD, can be retrieved as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; from camtest.analysis.functions.fitsfiles import get_absolute_time
&gt;&gt;&gt; absolute_time = get_absolute_time(filename, ccd_number, ccd_side)
&gt;&gt;&gt; absolute_time = get_absolute_time(hdu_list_object, ccd_number, ccd_side)</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_focal_plane_coordinates">5.3.3.8. Focal-plane coordinates</h5>
<div class="paragraph">
<p>To convert image pixel coordinates (row, column) for a given side of a given CCD to focal-plane coorinates (x, y), in mm, execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; from camtest.analysis.functions.fitsfiles import get_fp_coordinates
&gt;&gt;&gt; x, y = get_fp_coordinates(filename, ccd_number, ccd_side, row, column)
&gt;&gt;&gt; x, y = get_fp_coordinates(hdu_list_object, ccd_number, ccd_side, row, column)</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_astropy_wcs_objects">5.3.3.9. Astropy WCS objects</h5>
<div class="paragraph">
<p>It is possible to load the headers into an astropy WCS object, which can be used for coordinate conversions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; from astropy.io import fits
&gt;&gt;&gt; from astropy.wcs import WCS
&gt;&gt;&gt; with fits.open(&lt;filename&gt;) as hdul:
...     header = hdul[&lt;extension name&gt;].header
&gt;&gt;&gt; wcs = WCS(header)</pre>
</div>
</div>
<div class="paragraph">
<p>For the older FITS files, you may get this error message (see #1714):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ERROR: ValueError: ERROR 5 in wcsset() at line 2352 of file cextern/wcslib/C/wcs.c: Invalid parameter value.
ERROR 3 in tabset() at line 747 of file cextern/wcslib/C/tab.c: Invalid tabular parameters: Each element of K must be positive, got 0.</pre>
</div>
</div>
<div class="paragraph">
<p>This can be circumvented by correcting the value for the CTYPE3 keyword (before creating the WCS object):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; header["CTYPE3"] = "TIMETAB"</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_telecommand_history">5.4. Telecommand history</h3>
<div class="paragraph">
<p>The complete telecommand history is not yet saved but can be reconstructed from the setup_id (see below) and the obsid-table. The <code>obsid-table.txt</code> is a text file located at the root of the data storage location. The file contains one entry per observation, associating</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the main parameters of the observation, obsid and site</p>
</li>
<li>
<p>the time of execution</p>
</li>
<li>
<p>the setup_id active at execution time (contains the version number of the plato-test-script on the operational server)</p>
</li>
<li>
<p>The building block name</p>
</li>
<li>
<p>All parameter names and values passed to the execute command</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following lines are examples taken from the obsid-table.txt file at CSL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>01108 CSL1 00084 2023-06-07T08:56:22.832+0000 cam_single_cube_int_sync(theta="8.3", phi="12.0", num_cycles="5", exposure_time="0.2", n_rows="1000", attenuation="0.00413")
01109 CSL1 00084 2023-06-07T08:57:30.003+0000 cam_single_cube_int_sync(theta="8.3", phi="12.0", num_cycles="5", exposure_time="0.2", n_rows="1000", attenuation="0.00413")
01110 CSL1 00084 2023-06-07T09:02:16.140+0000 check_and_move_relative_user(cslmodel="egse.coordinates.cslmodel.CSLReferenceFrameModel", translation="[0, 0, 0.01]", rotation="[0, 0, 0]", setup="egse.setup.Setup", verbose="True")
01111 CSL1 00084 2023-06-07T09:03:09.426+0000 cam_single_cube_int_sync(theta="8.3", phi="12.0", num_cycles="5", exposure_time="0.2", n_rows="1000", attenuation="0.00413")
01112 CSL1 00084 2023-06-07T09:06:40.668+0000 check_and_move_relative_user(cslmodel="egse.coordinates.cslmodel.CSLReferenceFrameModel", translation="[0, 0, 0.005]", rotation="[0, 0, 0]", setup="egse.setup.Setup", verbose="True")
01113 CSL1 00084 2023-06-07T09:08:28.446+0000 cam_single_cube_int_sync(theta="8.3", phi="12.0", num_cycles="5", exposure_time="0.2", n_rows="1000", attenuation="0.00413")
01114 CSL1 00084 2023-06-07T09:29:58.225+0000 cam_single_cube_int_sync(theta="8.3", phi="12.0", num_cycles="5", exposure_time="0.2", n_rows="1000", attenuation="0.00413")
01115 CSL1 00084 2023-06-07T09:37:08.043+0000 cam_single_cube_int_sync(theta="8.3", phi="12.0", num_cycles="5", exposure_time="0.2", n_rows="1000", attenuation="0.00413")
01116 CSL1 00084 2023-06-07T09:40:39.185+0000 cam_single_cube_int_sync(theta="8.3", phi="12.0", num_cycles="5", exposure_time="0.2", n_rows="1000", attenuation="0.00413")</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>obsid-table.txt</code> file is explained in more detail in the <a href="https://ivs-kuleuven.github.io/plato-cgse-doc/docs/icd/">Interface Control Document</a> (ICD) [RD-04].</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conf-setup">6. Configuration and Setups</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The complete documentation on the EGSE configuration and on the concept of Setup can be found in the <a href="https://ivs-kuleuven.github.io/plato-cgse-doc/asciidocs/developer-manual.html#_the_setup">developer manual.</a></p>
</div>
<div class="paragraph">
<p>Setup is the concept we attach to the entity encapsulating the entire set of</p>
</div>
<div class="ulist">
<ul>
<li>
<p>identifiers and configuration items,</p>
</li>
<li>
<p>calibration values and calibration files,</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>necessary to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>describe the test-environment and the item under test, and to</p>
</li>
<li>
<p>operate the test.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_example_setup_file">6.1. Example Setup file</h3>
<div class="paragraph">
<p>A snippet of a setup file is shown below. It shows the tree structure of the YAML file. At the top level are the main components: gse (devices), camera (fpa, tou, fee), telemetry, etc. The snippet only shows part of the Setup. Under the <strong>gse</strong> branch we have <strong>hexapod</strong> and <strong>stages</strong> and many more that are not shown. All ground equipment that is part of the test setup shall have an entry under the <strong>gse</strong> branch. The information that shall go into these entries is device identification, calibration information, specific device settings, etc.</p>
</div>
<div class="paragraph">
<p>Everything that is connected to the Camera, i.e. SUT, shall go under the <strong>camera</strong> branch. This is e.g. identifiers for the TOU, FEE, FPA, DPU, CCD, &#8230;&#8203;, calibration information, defaults, numbering, avoidance information, etc.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The gse branch is also used by the process manager to determine which devices are part of the Setup and for which devices it should present a status LED and a start/stop button.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The users are allowed to modify or add items and branches to the setup and save a new version of it. As an example, the stages branch in this example contains calibration values defining metrology of the rotation and translation stages used to position the light beam at CSL.</p>
</div>
<div class="listingblock">
<div class="title">Snippet of a Setup file from CSL</div>
<div class="content">
<pre>NavigableDict
├── site_id: CSL2
├── position: 2
├── gse
│   ├── hexapod
│   │   ├── device: class//egse.hexapod.symetrie.puna.PunaProxy
│   │   ├── device_name: Symetrie Puna Hexapod
│   │   ├── ID: 2B
│   │   ├── time_request_granularity: 0.1
│   │   ├── CID: 603382
│   │   └── label: 172543 - PUNA
│   ├── stages
│   │   ├── ID: 1
│   │   ├── BIG_ROTATION_STAGE_ID: 420-20913
│   │   ├── SMALL_ROTATION_STAGE_ID: 409-10661
│   │   ├── TRANSLATION_STAGE_ID: 5101.30-943
│   │   ├── device: class//egse.stages.huber.smc9300.HuberSMC9300Proxy
│   │   ├── device_name: Huber SMC9300 Stages
│   │   ├── calibration
│   │   │   ├── height_collimated_beam: 513.9
│   │   │   ├── offset_phi: 0.4965
│   │   │   ├── offset_alpha: 0.0
│   │   │   ├── offset_delta_x: 96.884
│   │   │   ├── phi_correction_coefficients: [-0.0049, 0.0003]
│   │   │   ├── alpha_correction_coefficients: [0.0856, -0.5]
│   │   │   └── delta_x_correction_coefficients: [-0.1078, 0.2674, -0.0059]
│   │   ├── big_rotation_stage
│   │   │   ├── avoidance: 3.0
│   │   │   ├── hardstop: 179.316
│   │   │   └── default_speed: 15000
│   │   ├── small_rotation_stage
│   │   │   └── default_speed: 15000
│   │   └── translation_stage
│   │       └── default_speed: 15000

...

├── camera
│   ├── TOU
│   │   └── ID: BA-N1-11130000-FM-01
│   ├── fpa
│   │   ├── avoidance
│   │   │   ├── clearance_xy: 2.0
│   │   │   ├── clearance_z: 2.0
│   │   │   ├── vertices_nb: 60
│   │   │   └── vertices_radius: 100.0
│   │   ├── ID: N-FPA-11200000-FM-01
│   │   └── max_offset: 20
│   ├── dpu
│   │   ├── device: class//egse.dpu.DPUProxy
│   │   └── device_name: DPU

...

├── telemetry
│   ├── dictionary: pandas//../../common/telemetry/tm-dictionary-brigand.csv
│   └── separator: ;
├── sensor_calibration
│   └── callendar_van_dusen
│       └── EN60751
│           ├── A: 0.0039083
│           ├── B: -5.775e-07
│           └── C: -4.183e-12
├── history
│   ├── 0: Initial zero Setup for CSL2
│   ├── 1: Copy of CSL setup 97 (last EM setup)
│   ├── 2: Removed TCS block</pre>
</div>
</div>
<div class="paragraph">
<p>You can check the version of the Setup with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; print(setup.get_id())
00068</pre>
</div>
</div>
<div class="paragraph">
<p>The number printed on your system will be different.</p>
</div>
</div>
<div class="sect2">
<h3 id="_available_setups">6.2. Available Setups</h3>
<div class="paragraph">
<p>Setups will be available in the form of YAML files that are stored in the <code>plato-cgse-conf</code> repository and are located (probably) at <code>~/git</code> where the repos are kept.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Do never edit these YAML files directly since they are maintained through changes on the operational machine. The configuration manager on the egse-server machine manages these Setups and brings them under configuration control in GitHub automatically upon submitting a new Setup.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Browsing through the available setups can either be done in Python or via a GUI.</p>
</div>
<div class="sect3">
<h4 id="list-setups">6.2.1. Browsing the Setups in Python</h4>
<div class="paragraph">
<p>To get a list of the setups that are available in the system, execute the following command (to be imported from <code>camtest</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; list_setups()</pre>
</div>
</div>
<div class="paragraph">
<p>This will return a list of (setup identifier, site identifier) pairs, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>('00037', 'CSL2', 'Use v2 of N-FEE sensor calibration for Chimay (#293)', 'brigand')
('00038', 'CSL2', 'Incl. nominal ranges for power consumption checks (#312)', 'brigand')
('00039', 'CSL2', 'Updated N-cam voltages for the AEU PSU (#315)', 'brigand')
('00040', 'CSL2', 'New CSLReferenceFrameModel [csl_model_from_file]', 'brigand')
('00041', 'CSL2', 'Putting back N-cam voltages for the AEU PSU', 'brigand')
('00042', 'CSL2', 'updated stages calibration (beam height and phi correction)', 'brigand')
('00043', 'CSL2', 'Updated AEU voltages + voltage/current protection values (#324)', 'brigand')
('00044', 'CSL2', 'updated translation stage zero position', 'brigand')
('00045', 'CSL2', 'Update AEU configuration according to - NRB NCR-CSL-0036 disposition, email by Yves on 24/05/2023', 'brigand')</code></pre>
</div>
</div>
<div class="paragraph">
<p>The list_setups() command also allows you to filter the results, by using any of the keywords inside the setups. For instance, to list all the setups related to the STM version of the TOU, tested with the hexapod No 1 at CSL, you would type</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; list_setups(camera__ID="achel")  <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Note that the double underscore “__” is used to navigate the Setup. All parameters passed will be joined with a logical AND.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>list_setups(camera__ID="achel")
('00004', 'CSL2', 'Copy camera and telemetry info for achel from CSL1 setup 38', 'achel')
('00005', 'CSL2', 'Incl. sensor calibration', 'achel')
('00006', 'CSL2', 'Updated hexapod ID', 'achel')
('00007', 'CSL2', 'Updated device name for DAQ6510 (#235)', 'achel')
('00008', 'CSL2', 'Using short sync pulses of 200ms (instead of 150ms)', 'achel')
('00009', 'CSL2', 'Copy camera and telemetry info for achel from CSL1 setup 45', 'achel')
('00010', 'CSL2', 'Incl. MGSE calibration coefficients (#255)', 'achel')
('00011', 'CSL2', 'New CSLReferenceFrameModel [csl_model_from_file]', 'achel')
('00012', 'CSL2', 'Changed offset_phi for validation purposes', 'achel')
('00013', 'CSL2', 'Recalibration of the SMA (#258)', 'achel')
('00014', 'CSL2', 'Updated reference Hartmann positions (#254)', 'achel')
('00015', 'CSL2', 'fixed alpha correction coefficients', 'achel')
('00016', 'CSL2', 'Incl. reference_full_76 (taken from CSL1 setup 46)', 'achel')
('00017', 'CSL2', 'New CSLReferenceFrameModel [csl_model_from_file]', 'achel')
('00018', 'CSL2', 'Copy camera and telemetry info for achel from CSL1 setup 47', 'achel')
('00019', 'CSL2', 'Updated x, y measured positions w.r.t. LDO input (#266)', 'achel')</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_using_the_setup_gui">6.2.2. Using the Setup GUI</h4>
<div class="paragraph">
<p>To open the GUI to inspect all available setups, type the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ setup_ui</pre>
</div>
</div>
<div class="paragraph">
<p>This will fire up a window as shown in <a href="#fig-setup-ui">Figure 3</a>. The directory that is mentioned in the window title, is the one where the available setups are located.</p>
</div>
<div class="paragraph">
<p>A text field on the left-hand side allows you to filter the setups, similar to the arguments of the <code>list_setups</code> command from <a href="#list-setups">Section 6.2.1</a>. You can navigate through the tree both with the '__' and the dot notation. For the available setups that pass the filtering, the site and setup identifier will appear in the drop-down menu, after either hitting the return key in the filter text field or by pressing the search button next to it.</p>
</div>
<div id="fig-setup-ui" class="imageblock text-center">
<div class="content">
<img src="../images/setup-ui.png" alt="setup ui" width="80%">
</div>
<div class="title">Figure 3. Screenshot of the GUI to inspect all available setups.</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec-loading-a-setup">6.3. Loading a Setup</h3>
<div class="paragraph">
<p>After inspection of the available setups, a specific setup can be loaded, based on the identifier.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<em>Loading</em> a Setup means to load it in the system such that it then becomes the reference for the system configuration. This means <strong>it impacts the GlobalState and the ConfigurationManager</strong>! It is different from getting a copy of a Setup as a variable in a python script (see below).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ideally, the Setup will be loaded <strong>one single time</strong> at the start of a test phase, with a setup reflecting the HW present in the test environment. <strong>The preferred way to do so is via the setup GUI</strong>. That can be launched via</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ setup_ui</pre>
</div>
</div>
<div class="paragraph">
<p>In python:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; from camtest import load_setup
&gt;&gt;&gt; setup = load_setup(7)</pre>
</div>
</div>
<div class="paragraph">
<p>The above command will load the Setup in the configuration manager and also in the Python console you used to execute the <code>load_setup()</code> command.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Loading or submitting a Setup will have an effect on the configuration manager. The Setup is however NOT automatically propagated to all components in the system like e.g the device drivers. Therefore, always check if you have the right Setup available, especially in the QtConsole. The Setup is however propagated to all the core services, sm_cs, pm_cs (TODO), syn_cs.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can check which Setup is loaded in the core services using the <code>status</code> parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cm_cs status
Configuration manager:
  Status: active
  Site ID: CSL2
  No observation running
  Setup loaded: 00068
  Hostname: 192.168.0.163
  Monitoring port: 6001
  Commanding port: 6000
  Service port: 6002
  Listeners: Storage CS</pre>
</div>
</div>
<div class="paragraph">
<p>Also the process manager (<code>pm_ui</code>) and the Operator GUI (e.g. <code>csl_ui</code>) indicate which Setup is loaded, but keep in mind that this is only true for that particular process and is not necessarily propagated to all processes running in this distributed environment.</p>
</div>
</div>
<div class="sect2">
<h3 id="_inspecting_accessing_and_modifying_a_setup">6.4. Inspecting, accessing, and modifying a Setup</h3>
<div class="paragraph">
<p>First, make sure a Setup is already loaded in the system, and that you have a variable attached to a setup in your Python session. Here we call it <code>setup</code>.</p>
</div>
<div class="paragraph">
<p>You can get a Setup with the following command</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; from camtest import get_setup
&gt;&gt;&gt; setup = get_setup(7)</pre>
</div>
</div>
<div class="paragraph">
<p>This will read the content of Setup "00007" for the site you are currently at and assign it to a variable called <code>setup</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This has no effect on the system configuration (the ConfigurationManager will not know about it, and the GlobalState won’t be affected).
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_content_of_the_setup">6.4.1. Content of the setup</h4>
<div class="paragraph">
<p>To print the entire content of the setup:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; print(setup)</pre>
</div>
</div>
<div class="paragraph">
<p>The Setups, as well as all of their branches are “navigable dictionaries”. In practice that means that they have a tree structure, and every part of the tree can be accessed with a simple syntax, using dot notation (in contrast to using a double underscore (__) when filtering the available Setups).</p>
</div>
</div>
<div class="sect3">
<h4 id="_inspect_a_given_branch_or_leaf">6.4.2. Inspect a given branch or leaf</h4>
<div class="paragraph">
<p>You can inspect any branch or leaf of the Setup by navigating the Setup and printing the result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; print(setup.branch.subbranch.leaf)</pre>
</div>
</div>
<div class="paragraph">
<p>For instance, printing the hexapod configuration at CSL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; print(setup.gse.hexapod)
NavigableDict
├── device: class//egse.hexapod.symetrie.puna.PunaProxy
├── device_name: Symetrie Puna Hexapod
├── ID: 2B
├── time_request_granularity: 0.1
├── CID: 603382
└── label: 172543 - PUNA</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_modify_an_entry">6.4.3. Modify an entry</h4>
<div class="paragraph">
<p>Any Setup entry can be assigned to with a simple assignment statement.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; setup.branch.subbranch.leaf = object</pre>
</div>
</div>
<div class="paragraph">
<p>For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; setup.camera.fpa.avoidance.clearance_xy = 3</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_add_a_new_entry">6.4.4. Add a new entry</h4>
<div class="paragraph">
<p>When you want to replace a complete sub-branch in the Setup, use a dictionary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; setup.branch.subbranch = {}
&gt;&gt;&gt; setup.branch.subbranch.leaf = object</pre>
</div>
</div>
<div class="paragraph">
<p>for instance, to introduce the fpa subbranch in the example file above, one would write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; setup.camera.fpa = {}
&gt;&gt;&gt; setup.camera.fpa.ID = "STM"
&gt;&gt;&gt; setup.camera.fpa.avoidance = {}
&gt;&gt;&gt; setup.camera.fpa.avoidance.clearance_xy = 3</pre>
</div>
</div>
<div class="paragraph">
<p>The above can be simplified by adding a predefined dictionary to the Setup:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; setup.camera.fpa = {"ID": "STM", "avoidance": {"clearance_xy": 3}}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_saving_a_new_setup">6.5. Saving a new setup</h3>
<div class="paragraph">
<p>The setups are stored under configuration control in the plato-cgse-conf repository. The EGSE is taking care of the interface with that repository when a user is submitting a new setup, with no additional action necessary than:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; response = submit_setup(setup, description="A senseful description of this setup")
&gt;&gt;&gt; if isinstance(response, Setup):
...     setup = response
... else:
...     print(response)</pre>
</div>
</div>
<div class="paragraph">
<p>The new setup receives a unique setup_id, and a new entry is created in the list of setups. The new Setup is then loaded and made active in the configuration manager. When the Setup is processed by the system, brought under configuration control and no errors occurred, the new Setup is returned and will be assigned to the <code>setup</code> variable. In case of a error, the response contains information on the cause of the Failure and is printed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Do not directly catch the returned Setup in the <code>setup</code> variable, because you will lose your modified Setup in case of an error.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the description is mandatory. Setups keep track of their history, so we strongly encourage to provide concise but accurate descriptions each time this command is used.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
You should not submit nor load a new Setup within the context of an observation/test. Using <code>submit_setup(&#8230;&#8203;)</code> or <code>load_setup(setup_id)</code> when an observation is running will result in an error.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_common_egse_startup_shutdown_sleep">7. Common-EGSE startup, shutdown, sleep</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Intended readers: site-operator, test-operator</p>
</div>
<div class="sect2">
<h3 id="_egse_states">7.1. EGSE States</h3>
<div class="paragraph">
<p>The following states have been defined for the EGSE system, as depicted in <a href="#fig-egse-states">Figure 4</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>EGSE OFF: all systems are powered off;</p>
</li>
<li>
<p>EGSE INIT: egse-server is booted, user logged in as plato-user;</p>
</li>
<li>
<p>EGSE STANDBY: critical housekeeping is being acquired, a sub-set of critical functions is available (e.g. temperature and safety monitoring of the test-environment and test-article);</p>
</li>
<li>
<p>EGSE ON: the system and hardware are ready to receive commands.</p>
</li>
</ul>
</div>
<div id="fig-egse-states" class="imageblock text-center">
<div class="content">
<img src="../images/egse-state-transitions.png" alt="egse state transitions" width="80%">
</div>
<div class="title">Figure 4. Transitions between the EGSE states.</div>
</div>
<div class="paragraph">
<p>The transitions between these states are all handled by the Process Manager GUI. Under the hood, the Process Manager queries the setup (from the Configuration Manager) for information on the relevant processes. A distinction is made between core and devices processes.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../images/egse-swon-sleep.png" alt="egse swon sleep" width="50%">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_core_device_processes">7.2. Core &amp; Device Processes</h3>
<div class="paragraph">
<p>The following processes are considered as Common-EGSE <strong>core processes</strong> (depicted in the left panel of <a href="#fig-core-dev-processes">Figure 5</a>]) and should always be running:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <strong>Storage</strong>, which is responsible for archiving of housekeeping and image data (see <a href="#data-acquisition-and-storage">Chapter 5</a>);</p>
</li>
<li>
<p>the <strong>Configuration Manager</strong>, which manages of the configuration and setup of the system (see <a href="#conf-setup">Chapter 6</a>);</p>
</li>
<li>
<p>the <strong>Process Manager</strong>, which can be used to start device processes and monitor their status (typically via the corresponding GUI; see further),</p>
</li>
<li>
<p>the <strong>Logger</strong>, which collects all log messages from the different components of the Common-EGSE and test scripts. The log messages are saved in a log file at a location denoted by the environment variable PLATO_LOG_FILE_LOCATION.</p>
</li>
<li>
<p>the <strong>Synoptics Manager</strong>, which handles all generic and device independent housekeeping.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These processes are started automatically when the egse-server is booted. They cannot be re-started nor shut down via the Process Manager GUI; they can only be monitored there.</p>
</div>
<div class="paragraph">
<p>The <strong>device processes</strong> (depicted in the middle panel of <a href="#fig-core-dev-processes">Figure 5</a>) are the so-called Control Servers that talk to the hardware Controllers (depicted in the right panel of <a href="#fig-core-dev-processes">Figure 5</a>), for commanding and monitoring the devices.</p>
</div>
<div class="paragraph">
<p>These processes can be (re-)started and shut down individually from the Process Manager GUI. They will be running on the same machine as the Process Manager itself, which is the egse-server during normal operations.</p>
</div>
<div id="fig-core-dev-processes" class="imageblock text-center">
<div class="content">
<img src="../images/core-dev-processes.png" alt="core dev processes" width="60%">
</div>
<div class="title">Figure 5. Core and devices processes. The latter are Control Servers that talk to the hardware Controllers, for commanding and monitoring thedevices.</div>
</div>
</div>
<div class="sect2">
<h3 id="_process_manager_gui">7.3. Process Manager GUI</h3>
<div class="paragraph">
<p>A desktop icon will be provided to start the Process Manager GUI. Alternatively, it can be started from the terminal command line with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ pm_ui</pre>
</div>
</div>
<div class="paragraph">
<p>This will fire up the GUI shown in <a href="#fig-pm-ui-csl-2">Figure 6</a>.</p>
</div>
<div id="fig-pm-ui-csl-2" class="imageblock">
<div class="content">
<img src="../images/pm_ui_csl_2.png" alt="pm ui csl 2">
</div>
<div class="title">Figure 6. The screenshot of the Process Manager GUI. The colour of the leds (green/orange/red) indicates what the status is of the core processes and the device processes in the current Setup. Devices processes can be started (either in operational or in simulator mode) or shut down by pressing the corresponding play/stop buttons. If a GUI has been implemented for a process, it can be opened (in a separate window) by pressing the corresponding "UI" button.</div>
</div>
<div class="paragraph">
<p>On the top left, an overview of the core services will be given. When a (new) Setup is loaded (see <a href="#sec-loading-a-setup">Section 6.3</a>]), the content of the right part (with the device control servers) will be updated. Only the processes for the devices that are included in the current Setup will be shown.</p>
</div>
<div class="paragraph">
<p>A led in front of the process name will give you a quick impression of the state of the process. It can have the following colour for device processes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>green</strong>: the process is running and a connection with the hardware Controller has been established;</p>
</li>
<li>
<p><strong>orange</strong>: the process is running, but the connection with the hardware Controller could not be established or was lost;</p>
</li>
<li>
<p><strong>red</strong>: the process is not yet or no longer running or the process hangs for some undefined reason.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the <em>core processes</em>, the led should always be green (indicating the process is running). In case one of them turns red, the corresponding core process is no longer alive, and the system may have to be re-started. Consult your site-operator in this case.</p>
</div>
<div class="paragraph">
<p>For the processes for which a "GUI" button is present, a GUI for the corresponding device can be opened in a separate window by pressing this button. A GUI for any device can be opened only once.</p>
</div>
<div class="paragraph">
<p>In contrast to the core processes, the device processes can be started from the Process Manager GUI, either in operational mode (when a hardware Controller is available) or in simulator mode (when no hardware Controller is available; for testing purposes).</p>
</div>
<div class="sect3">
<h4 id="_egse_off_egse_init">7.3.1. EGSE OFF ⟷ EGSE INIT</h4>
<div class="paragraph">
<p>When booting the egse-server, the core processes (i.e. Storage, Configuration Manager, Process Manager, Synoptics Manager, and Logger) will be started automatically. If the Process Manager GUI is started at this point and no Setup is loaded, the area with the device processes will be empty, and the five core processes will show a green LED in the GUI.</p>
</div>
<div class="paragraph">
<p>Note that the Process Manager GUI can only be used to monitor the core processes, not to (re-)start them. Should any of the LEDs for the core processes turn red (at any point), more detailed inspection of the system will be needed (and the system may even have to be re-booted).</p>
</div>
<div class="paragraph">
<p>Any GUI for these processes can be started by pressing the GUI button. Note that although the core processes are running on the egse-server, GUIs that are launched from the process manager will be started on your local machine, desktop client.</p>
</div>
</div>
<div class="sect3">
<h4 id="_egse_init_egse_standby">7.3.2. EGSE INIT ⟷ EGSE STANDBY</h4>
<div class="paragraph">
<p>After having brought the Common-EGSE into its INIT state, a Setup must be loaded (see <a href="#sec-loading-a-setup">Section 6.3</a>). This comprises (amongst others) all devices that are currently relevant to you. Once a Setup is loaded, the area with the device processes will be updated in the process manager GUI.</p>
</div>
<div class="paragraph">
<p>To start the critical device processes, click on the play/stop button for these devices. If all goes well, the LEDs for these processes will turn green in the GUI.</p>
</div>
<div class="paragraph">
<p>To shut down these critical processes (to return to INIT mode), the play/stop button of these devices must be pressed a second time.</p>
</div>
<div class="paragraph">
<p>Any GUI for these processes can be started by pressing the GUI button. The GUI will start on your local machine and can only be started once. Starting and stopping a GUI for a device has no effect on the state of that device.</p>
</div>
</div>
<div class="sect3">
<h4 id="_egse_standby_egse_on">7.3.3. EGSE STANDBY ⟷ EGSE ON</h4>
<div class="paragraph">
<p>In STANDBY mode, only the critical processes will be running. The other device processes can be started by pressing their play/stop button, bringing the Common-EGSE into ON mode. To return to STANDBY mode, press the buttons again.</p>
</div>
<div class="paragraph">
<p>Any GUI for these processes can be started by pressing the GUI button.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_utility_functions">8. Utility functions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_logging">8.1. Logging</h3>
<div class="paragraph">
<p>Errors, warnings, general debugging or any useful information can be
logged using the logging infrastructure. The logging infrastructure will
take care that the messages you generate are stored in the log files
associated with the measurement. It also takes care of visualising the
messages to the operator.</p>
</div>
<div class="paragraph">
<p>Log levels: CRITICAL, ERROR, WARNING, INFO, DEBUG</p>
</div>
<div class="paragraph">
<p>To log a message in your script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&gt;&gt;&gt; from camtest import camtest_logger
&gt;&gt;&gt; camtest_logger.info("Starting performance verification test")
2023-06-15 17:10:30,857:             IPython:    INFO:    1:camtest             :Starting performance verification test</pre>
</div>
</div>
<div class="paragraph">
<p>This will print a log message in the REPL and send a log record with the
message to the Logger. Messages for any of the above levels will end up
in the Common-EGSE log file, but only messages of level INFO and above
will also be printed in the terminal. So, if you need to check any
debugging messages, make sure you check the log file at
<code>$PLATO_LOG_FILE_LOCATION</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_handling_errors">8.2. Handling Errors</h3>
<div class="paragraph">
<p>Inevitably, the code other developers write will generate error and
exceptions. Whenever you expect an exception and you know what to do
with it or how to handle it, catch it with the following construct:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>try:
    call_a_function_from_another_dev(...)
except ZeroDivisionError:
    # do something to recover here</pre>
</div>
</div>
<div class="paragraph">
<p>If you cannot handle the error, just let it pass to the next level in
you script and eventually to the top building_block.</p>
</div>
<div class="paragraph">
<p>There is a fully detailed description of exception handling in the on-line Common-EGSE documentation in the section <a href="https://ivs-kuleuven.github.io/plato-cgse-doc/asciidocs/developer-manual.html#_best_practices_for_error_and_exception_handling">Exception Handling</a> of the developer manual.</p>
</div>
</div>
<div class="sect2">
<h3 id="_coordinate_transformations">8.3. Coordinate transformations</h3>
<div class="paragraph">
<p><a href="#fig-fp-ref-frame">Figure 7</a> below shows the schematic overview of the focal plane with the four
CCDs. The focal-plane reference frame (x<sub>FP</sub>, y<sub>FP</sub>, z<sub>FP</sub>) is
associated with the focal plane of one camera. Its origin is in the
middle of the four CCDs (indicated by the blue dot in the figure) and
the z<sub>FP</sub>–axis coincides with the optical axis (pointing towards the
reader). The coordinates in the (x<sub>FP</sub>, y<sub>FP</sub>) reference frame are
typically expressed in mm.</p>
</div>
<div class="paragraph">
<p>Each of the four CCDs has its own CCD reference frame (x<sub>CCD</sub>, y<sub>CCD</sub>)
assigned to it (indicated with the small arrows in the figure). When
keeping the readout register of a CCD at the bottom, the origin of the
associated CCD reference frame is at the lower left corner of the CCD.
The parallel charge transfer happens in the negative y<sub>CCD</sub> direction;
the serial charge transfer in the readout register happens in the
negative x<sub>CCD</sub> direction for the left detector half and in the
positive x<sub>CCD</sub> direction for the right detector half. The coordinates
in the (x<sub>CCD</sub>, y<sub>CCD</sub>) reference frame are typically expressed in
pixels (where a pixel measures 18µm in both directions)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Definition of important coordinate systems</p>
</li>
<li>
<p>Field of view position (degrees) to CCD number and pixel coordinates</p>
</li>
<li>
<p>CCD number and pixel coordinates to field of view position (degrees)</p>
</li>
</ul>
</div>
<div id="fig-fp-ref-frame" class="imageblock text-center">
<div class="content">
<img src="../images/focal-plane-ref-frame.png" alt="focal plane ref frame">
</div>
<div class="title">Figure 7. Schematic overview of the focal plane of one camera, with the four CCDs. The blue dot in the middle of the CCDs is the origin of the focal-plane reference frame (x<sub>FP</sub>, y<sub>FP</sub>) and denotes the location where the optical axis intersects with the focal-plane. The readout registers of the CCDs are marked in read and the associated CCD reference frames are indicated with the small arrows.</div>
</div>
<div class="paragraph">
<p>Alternatively, the position in the focal plane can be expressed in field
angles (θ, φ), as shown in <a href="#fig-fp-field-angles">Figure 8</a>. The angular distance to the
optical axis (marked with a blue dot in the figure) is denoted by angle
θ, whereas φ represents the in-field angle, measured in
counter-clockwise direction from the x <sub>FP</sub> axis.</p>
</div>
<div id="fig-fp-field-angles" class="imageblock text-center">
<div class="content">
<img src="../images/focal-plane-field-angles.png" alt="focal plane field angles">
</div>
<div class="title">Figure 8. Definition of the field angles θ and φ. The former is the angular distance to the optical axis (marked by means of the blue dot), the latter is the in-field angle, measured in the counter-clockwise direction from the x<sub>FP</sub> axis.</div>
</div>
<div class="paragraph">
<p>The following coordinate conversions can be imported from <code>egse.coordinates</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>row, column, ccd_code = focal_plane_to_ccd_coordinates(x_fp, y_fp)</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Identifies the CCD on which the given focal-plane coordinates (<code>x_fp</code>,<code>y_fp</code>) are located, and returns the pixel coordinates (<code>row</code>, <code>column</code>) in the corresponding CCD reference frame and the CCD code (<code>ccd_code</code>).</p>
<div class="ulist">
<ul>
<li>
<p>The input focal-plane coordinates (<code>x_fp</code>, <code>y_fp</code>) should be specified in
mm.</p>
</li>
<li>
<p>The output pixels coordinates (<code>row</code>, <code>column</code>) are given in pixels.</p>
</li>
<li>
<p>The output CCD code <code>ccd_code</code> should be 1/2/3/4 (as in <a href="#fig-fp-ref-frame">Figure 7</a>).</p>
</li>
<li>
<p>If the given focal-plane coordinates do not fall on any of the CCDs, (None, None, None) is returned.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>theta, phi = focal_plane_coordinates_to_angles(x_fp, y_fp)</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Converts the given focal-plane coordinates (<code>x_fp</code>, <code>y_fp</code>) to field angles (<code>theta</code>, <code>phi</code>).</p>
<div class="ulist">
<ul>
<li>
<p>The input focal-plane coordinates (<code>x_fp</code>, <code>y_fp</code>) should be specified in mm.</p>
</li>
<li>
<p>The output field angles (<code>theta</code>, <code>phi</code>) are given in degrees.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>x_fp, y_fp = ccd_to_focal_plane_coordinates(row, column, ccd_code)</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Converts the given pixel coordinates (<code>row</code>, <code>column</code>) in the reference
frame of the CCD with the given code <code>ccd_code</code> to focal-plane coordinates
(<code>x_fp</code>, <code>y_fp</code>).</p>
<div class="ulist">
<ul>
<li>
<p>The input pixel coordinates (<code>row</code>, <code>column</code>) should be given in pixels.</p>
</li>
<li>
<p>The input CCD code ccd_code should be 1/2/3/4 (as in <a href="#fig-fp-ref-frame">Figure 7</a>).</p>
</li>
<li>
<p>The output focal-plane coordinates (<code>theta</code>, <code>phi</code>) are given in mm.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>x_fp, y_fp = angles_to_focal_plane_coordinates(theta, phi)</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Converts the given field angles (<code>theta</code>, <code>phi</code>) to focal-plane coordinates (<code>x_fp</code>, <code>y_fp</code>).</p>
<div class="ulist">
<ul>
<li>
<p>The input field angles (<code>theta</code>, <code>phi</code>) should be given in degrees.</p>
</li>
<li>
<p>The output focal-plane coordinates (<code>x_fp</code>, <code>y_fp</code>) are given in mm.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>x_distorted, y_distorted = undistorted_to_distorted_focal_plane_coordinates(
    x_distorted, y_distorted, distortion_coefficients, focal_length)</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Converts the given undistorted focal-plane coordinates (<code>x_undistorted</code>, <code>y_undistorted</code>) to distorted focal-plane coordinates (<code>x_distorted</code>, <code>y_distorted</code>), based on the given distortion coefficients(<code>distortion_coefficients</code>) and focal length (<code>focal_length</code>).</p>
<div class="ulist">
<ul>
<li>
<p>The input undistorted focal-plane coordinates (<code>x_undistorted</code>, <code>y_undistorted</code>) should be given in mm.</p>
</li>
<li>
<p>The input distortion coefficients (<code>distortion_coefficients</code>) should be an array [k1, k2, k3] with the coefficients of the distortion polynomial.</p>
</li>
<li>
<p>The input focal length (<code>focal_length</code>) should be given in mm.</p>
</li>
<li>
<p>The output distorted focal-plane coordinates (<code>x_distorted</code>, <code>y_distorted</code>) should be given in mm.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-new-camera">9. When a new camera arrives</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the different actions to be taken when a new camera arrives at either CSL or one of the test houses. The actions are different for CSL with respect to the test houses, so this will be described in separated sections.</p>
</div>
<div class="sect2">
<h3 id="_setup">9.1. Setup</h3>
<div class="paragraph">
<p>The setup file is a configuration file, part of the CGSE, describing all components and calibrations of the actual test article, test equipment, and test environment. In addition to holding some information like the ensemble of reference frame definitions (in CSL) or the history, it consists of two main components: a first describing the GSE and gathering the information over the test environment (devices control and calibration, temperature sensors, …), and a second describing the camera, i.e. gathering all the information over the description and calibration of the test articles (TOU, FPA, FEE…).</p>
</div>
<div class="paragraph">
<p>The setup is a YAML file, i.e. a hierarchical “dictionary” (in the python sense of the word). Items can be referred to by a [key, value] pair, where the key refers to their location in the hierarchy and consists of the full path to that location, e.g. <code>setup.gse.stages.calibration.phi_correction_coefficients</code>: [-0.0014, -0.003].
The value can be a built-in type (int, float, str, …), a serialized object, a list, or the path to another calibration file. A more detailed explanation of the Setup is in <a href="#conf-setup">Chapter 6</a>.</p>
</div>
<div class="paragraph">
<p>The setup is under configuration control in the GitHub repository <code>plato-cgse-conf</code> and new setup versions are created exclusively on the server or client machine of the cleanroom for which the setup is intended.</p>
</div>
</div>
<div class="sect2">
<h3 id="_purpose_2">9.2. Purpose</h3>
<div class="paragraph">
<p>This chapter describes the values susceptible to change when the components of a new camera are integrated on a test setup in CSL. The goal of this chapter is to provide a step-by-step procedure for the creation of the new setup, including the source of information for every item to update.</p>
</div>
<div class="paragraph">
<p>At the time of writing, several setups do already exist that include the calibration of the GSE components on both test setups in CSL (“CSL1” and “CSL2”). So this document assumes their pre-existence rather than creating them from scratch every time again.</p>
</div>
<div class="paragraph">
<p>Setups exist and are maintained in different configuration directories (and in GitHub) for every test environment, so every test chamber has its own numbering for the setups <code>SETUP_&lt;SITE&gt;_&lt;NUMBER&gt;_&lt;date&gt;_&lt;time&gt;</code>, e.g. <code>SETUP_CSL1_00065_230407_091711.yaml</code> (the date and time are automatically included at creation time). The <code>&lt;NUMBER&gt;</code> is sequentially incremented for each new version of a setup and is not reset for each new camera.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In this chapter, the <code><strong>setup.components.to_update</strong></code> will be marked in bold, the <code><em>setup.components</em></code> that should not need any update are written in italics.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_useful_information">9.3. Useful Information</h3>
<div class="ulist">
<ul>
<li>
<p>Test status of each of the cameras and/or its components: <a href="https://s2e2.cosmos.esa.int/confluence/display/PCOT/Test+Status" class="bare">https://s2e2.cosmos.esa.int/confluence/display/PCOT/Test+Status</a></p>
</li>
<li>
<p>CAM Configuration connects the camera id with the identifiers of its components: <a href="https://s2e2.cosmos.esa.int/confluence/pages/viewpage.action?pageId=171639593" class="bare">https://s2e2.cosmos.esa.int/confluence/pages/viewpage.action?pageId=171639593</a></p>
</li>
<li>
<p>CAM Logistics Control keeps track of the shipments from CSL to the THs: <a href="https://s2e2.cosmos.esa.int/confluence/pages/viewpage.action?spaceKey=SCIPLM&amp;title=CAM+Logistics+Control" class="bare">https://s2e2.cosmos.esa.int/confluence/pages/viewpage.action?spaceKey=SCIPLM&amp;title=CAM+Logistics+Control</a></p>
</li>
<li>
<p>TOU Logistics Control keeps track of the shipments from TAS to LDO: <a href="https://s2e2.cosmos.esa.int/confluence/pages/viewpage.action?spaceKey=SCIPLM&amp;title=TOU+Logistics+Control" class="bare">https://s2e2.cosmos.esa.int/confluence/pages/viewpage.action?spaceKey=SCIPLM&amp;title=TOU+Logistics+Control</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_a_new_camera_arrives_at_csl">9.4. A new camera arrives at CSL</h3>
<div class="sect3">
<h4 id="_necessary_inputs">9.4.1. Necessary Inputs</h4>
<div class="paragraph">
<p>This is a list of the input data and files necessary anytime during the process described below, so maybe first check all of them are at hand:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The latest version of AD01, freshly pulled from Eclipse</p>
</li>
<li>
<p>The metrology excel file from the FPA</p>
</li>
<li>
<p>The metrology excel file from the TOU</p>
</li>
<li>
<p>The raw data from the TOU</p>
</li>
<li>
<p>The laser tracker with the input <code>CSLReferenceFrameModel</code> from CSL</p>
</li>
<li>
<p>The default FPGA parameters file (<code>FPGA_Configuration file.ini</code>)</p>
</li>
<li>
<p>The sensor calibration parameters file (<code>HK_Calibrations_File.ini</code>)</p>
</li>
<li>
<p>The FEE register map calibration file (the same for all (P)FM cameras, but different for EM)</p>
</li>
<li>
<p>The HK map calibration file (the same for all (P)FM cameras, but different for EM)</p>
</li>
<li>
<p>Telemetry dictionary file (CSV file in plato-cgse-conf)</p>
</li>
<li>
<p>The acceptable limits for the CCD offsets &amp; readout noise (<code>analog_chain_limits_tvac</code> and <code>_ambient.yaml</code>)</p>
</li>
<li>
<p>The acceptable limits for the FEE currents and powers (<code>sft_limits_fee_hk_&lt;camera&gt;.xlsx</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The references for some of those documents can be found in <a href="#sec-new-camera-ref">Section 9.7</a> or in the latest weekly minutes from CSL.</p>
</div>
</div>
<div class="sect3">
<h4 id="_baseline">9.4.2. Baseline</h4>
<div class="paragraph">
<p><span class="red">I don&#8217;t understand what you mean here with baseline? I think this should be more elaborate like what information goes into the GitHub ticket, the ticket basically describes the steps to take, and how to do that by providing the Python code that needs to be executed to ingest the proper information into the Setup. There is also a lot of other information that needs to go in, like N-FEE sensor calibration, the new Register Map definition, the HK packet definition, etc.</span></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a GitHub ticket on the plato-cgse-conf repository, using the "Configuration for new camera template".</p>
</li>
<li>
<p>Create a new setup, starting from the last setup on the given test-chamber (e.g. CSL1).</p>
</li>
<li>
<p>Create a GitHub ticket for the inclusion of the CSL metrology (xls) file on the CSL server (cgse-conf)</p>
</li>
<li>
<p>Reduce the raw data from LDO</p>
</li>
<li>
<p>Create a GitHub ticket for the inclusion of the LDO-data-reduction (fits) file on the CSL server (data/reduced)</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_updating_the_gse_section">9.4.3. Updating the GSE section</h4>
<div class="paragraph">
<p>There are only a few items to update in this section, as the information doesn&#8217;t change with the camera.</p>
</div>
<table class="tableblock frame-ends grid-none stripes-odd stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 88.8889%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.gse.hexapod</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>There are 2 hexapods per test room in CSL &#8594; check the proper hexapod ID &amp; information with CSL (source TBD).</p>
</div>
<div class="paragraph">
<p>There are 4 hexapods : 1A, 1B, 2A, 2B, with 1, 2 referring to the test room CSL1 or CSL2.</p>
</div>
<div class="paragraph">
<p>The <code>setup.gse.hexapod.ID</code>, <code>CID</code> and <code>label</code> are updated together (TBC).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><em>setup.gse.stages</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Bound to the room. Should not need any update.</p>
</div>
<div class="paragraph">
<p>The section <code>setup.gse.stages.calibration</code> comes from</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CSL1 : PLATO-PL-CSL-RP-0031_3.0_R1_CalibrationReport</p>
</li>
<li>
<p>CSL2 : PLATO-PL-CSL-RP-0032_2.1_R2_CalibrationReport</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The offsets are simple scalar values describing the value at field angles [boresight, azimuth] = [0,0]</p>
</div>
<div class="paragraph">
<p>The correction coefficients are polymonials, expressed as [order_0_par, order_1_par, …]. The parameters are expressed in the equations presented for each of the stages:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">The origin of the values</div>
<div class="paragraph">
<p>Correction of the azimuth &#x03c6;</p>
</div>
<div class="paragraph">
<p><code>setup.gse.stages.phi_correction_coefficients = [order0, order1]</code>
&#x2192; from equation 4-4 in section "calculation of correction angle &#x03c6; versus FOV &#x03b8;"</p>
</div>
<div class="paragraph">
<p>Mirror orientation &#x03b1;</p>
</div>
<div class="paragraph">
<p><code>setup.gse.stages.alpha_correction_coefficients = [order0, order1]</code>
&#x2192; from equation 4-1 in section “Definition of Mirror orientation”</p>
</div>
<div class="paragraph">
<p><code>setup.gse.stages.calibration.offset_alpha = value</code>
&#x2192; this value is 0. = the difference between the “calculated mirror orientation” for FoV &#x03b8; in Table 4-8 and alpha_correction_coefficients[0]</p>
</div>
<div class="paragraph">
<p>Mirror position <em>x</em></p>
</div>
<div class="paragraph">
<p><code>setup.gse.stages.delta_x_correction_coefficients = [order0, order1, order2]</code>
&#x2192; from equation 4-3 in section “Definition of Mirror position”</p>
</div>
<div class="paragraph">
<p><code>setup.gse.stages.calibration.offset_delta_x = value</code>
&#x2192; This value is listed under equation 4-3</p>
</div>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.gse.stages.calibration.offset_phi</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This must be updated from the z-component of the rotation vector expressing TOU_MEC in GL_ISO.</p>
<p class="tableblock">This is only made available to us after alignment of the camera on the CSL setup.</p>
<p class="tableblock">It can then be found in the xls sheet gathering the laser-tracker metrology from CSL, provided as input to define the CSLReferenceFrame (see <a href="#sec-csl-ref-frames">Section 9.6.2</a>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><em>setup.gse.aeu</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Bound to the room. Should not need any update</p>
</div>
<div class="paragraph">
<p>Original info from TBD</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><em>setup.gse.ogse</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Bound to the room. Should not need any update</p>
</div>
<div class="paragraph">
<p>Original info from TBD</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><em>setup.gse.DAQ6510</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Bound to the room. Should not need any update (TBC)</p>
</div>
<div class="paragraph">
<p>Original info from TBD</p>
</div>
<div class="paragraph">
<p>This still needs to be checked as the sensors need to be connected in the same way for all cameras. Check the sensor / channel connection.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_updating_the_camera_section">9.4.4. Updating the Camera section</h4>
<div class="paragraph">
<p><strong>Camera identifiers</strong></p>
</div>
<div class="paragraph">
<p>CSL UI → "Configuration" tab → <span class="red">Sect. "2 - Include information in setup" → "Camera identifiers"</span></p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Set the camera_id  (choose from drop-down menu)</p>
</li>
<li>
<p>Set the camera_serial_number (from AD01)</p>
</li>
<li>
<p>Set the tou_id (from AD01; e.g. TOU-11100000-FM-01)</p>
</li>
<li>
<p>Set the fee_id (from AD01)</p>
</li>
<li>
<p>Set the fpa_id (from AD01; e.g. FPA-11200000-FM-SN103)</p>
</li>
<li>
<p>Complete the description (should contain camera name + issue number)</p>
</li>
<li>
<p>Press "run"</p>
</li>
<li>
<p>Check the proposed changes → <span class="red">Agree to submit setup</span></p>
</li>
</ul>
</div>
</div>
</div>
<table class="tableblock frame-ends grid-none stripes-odd stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 88.8889%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.camera.TOU.ID</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See "Camera identifiers" above</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><em>setup.camera.fpa</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>setup.fpa.ID</code>: See "Camera identifiers" above</p>
</li>
<li>
<p><code>setup.fpa.avoidance</code> parameters don’t need any update</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><em>setup.camera.dpu</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No update needed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.camera.fee</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>setup.camera.fee.type</code>: N-FEE or F-FEE</p>
</div>
<div class="paragraph">
<p><code>setup.camera.fee.ID</code>: See "Camera identifiers" above</p>
</div>
<div class="paragraph">
<p><code>setup.camera.fee.calibration</code>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Pull the “*HK_Calibrations_File.ini” from the FEE / Analogue chain EIDP</p>
</li>
<li>
<p>CSL UI: "Configuration" tab → Sect. "1 - Create configuration / calibration files" → "N-FEE sensor calibration":</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the camera_id (choose from drop-down menu)</p>
</li>
<li>
<p>Load the HK calibration file from step 1</p>
</li>
<li>
<p>Fill out the handling jigs (taken from AD01)</p>
</li>
<li>
<p>Press "run"</p>
</li>
</ol>
</div>
</li>
<li>
<p>Submit the file to the plato-cgse-conf GitHub repository (in common/n-fee)</p>
</li>
<li>
<p>CSL UI: "Configuration" tab → Sect. "2 - Include information in setup" → "N-FEE sensor calibration":</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the camera_id (choose from drop-down menu)</p>
</li>
<li>
<p>Load the N-FEE calibration file created in steps 2 - 3</p>
</li>
<li>
<p>Complete the description (should contain camera name + issue number)</p>
</li>
<li>
<p>Press "run"</p>
</li>
<li>
<p>Check the proposed changes → Agree to submit setup</p>
</li>
</ol>
</div>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.camera.fee.register_map</strong></code> &amp; <code><strong>setup.camera.fee.hk_map</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Make a copy of the register map and HK map YAML files (in common/n-fee) of a previous (P)FM</p>
</li>
<li>
<p>Replace the beer name in the filenames</p>
</li>
<li>
<p>Submit the files to the plato-cgse-conf GitHub repository (in common/n-fee)</p>
</li>
<li>
<p>CSL UI: "Configuration" tab → Sect. "2 - Include information in setup" → "N-FEE register &amp; HK map":</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the camera_id (choose from drop-down menu)</p>
</li>
<li>
<p>Load the register and HK maps from steps 1 - 3</p>
</li>
<li>
<p>Complete the description (should contain camera name + issue number)</p>
</li>
<li>
<p>Press "run"</p>
</li>
<li>
<p>Check the proposed changes → Agree to submit setup</p>
</li>
</ol>
</div>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.camera.fee.fpga_defaults</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Pull the “*FPGA_Configuration file.ini” from the FEE / Analogue chain EIDP</p>
</li>
<li>
<p>CSL UI: "Configuration" tab → Sect. "1 - Create configuration / calibration files" → "N-FEE FPGA defaults":</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the camera_id (choose from drop-down menu)</p>
</li>
<li>
<p>Load the FPGA defaults file from step 1</p>
</li>
<li>
<p>Press "run"</p>
</li>
</ol>
</div>
</li>
<li>
<p>Submit the file to the plato-cgse-conf GitHub repository (in common/n-fee)</p>
</li>
<li>
<p>CSL UI: "Configuration" tab → Sect. "2 - Include information in setup" → "FEE FPGA defaults":</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the camera_id (choose from drop-down menu)</p>
</li>
<li>
<p>Load the FPGA defaults file created in steps 2 - 3</p>
</li>
<li>
<p>Complete the description (should contain camera name + issue number)</p>
</li>
<li>
<p>Press "run"</p>
</li>
<li>
<p>Check the proposed changes → Agree to submit setup</p>
</li>
</ol>
</div>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><em>setup.camera.fee.ccd_numbering</em></code>, <code><em>ccd_sides</em></code>, <code><em>sensor_sel</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no update</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.camera.fee.power_consumption</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Prepare the calibration file</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Identify the appropriate versions of the MSSL-0058 short functional test reports for both the ambient and tvac cases. For instance, the ambient case might be labelled “before shipping”. Many versions of MSSL-0058 exist for every camera, so have your selection validated by ESA before anything else.</p>
</li>
<li>
<p>Find an existing calibration file in the cgse-conf repo, in common/n-fee. For instance sft_limits_fee_hk_duvel_v01.xlsx</p>
</li>
<li>
<p>Copy it to a new file bearing the name of the new camera, to make sure to respect its format in the new version</p>
</li>
<li>
<p>(Manually) edit the cover page and the values in the ‘ambient’ and ‘tvac’ sheets according to the MSSL-0058 reports (table numbers are indicative; in case of deviation, apply common-sense; powers are computed from voltages and currents)</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Voltages (table 14-8). The tolerances on the voltages are set to 100%.</p>
</li>
<li>
<p>Currents ON mode (table 14-9)</p>
</li>
<li>
<p>Currents STANDBY mode (table 14-14)</p>
</li>
<li>
<p>Currents in FULL_IMAGE mode READOUT (table 14-16)</p>
</li>
<li>
<p>Currents in FULL_IMAGE mode INTEGRATION (table 14-17)</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Update the setup accordingly</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>CSL UI: “Configuration” tab → Sect. 2 (SFT) I and P limits”</p>
</li>
<li>
<p>version (mandaroty) : the version of your calibration file (integer)</p>
</li>
<li>
<p>confdir (optional) : can be left blank : the directory where the calibration files will be found. The default is taken from the env. variable PLAT0_CONF_DATA_LOCATION</p>
</li>
<li>
<p>description (optional) : if left blank,  replaced with “Incl. power consumption limits for &lt;camera&gt;. Ref. file version &lt;version&gt;”</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The calibration file is selected based on the camera.ID, which is determined from the current setup (<code>setup.camera.ID</code>), so prior to this, make sure to start after loading a preliminary setup for the new camera.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.camera.ccd.limits</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>Calibration file received by email from Sami Niemi, and placed on <code>$PLAT0_CONF_DATA_LOCATION/common/ccd</code>. Two independent files exist for ambient and tvac. Both have the same format and contain the information for all cameras at once. The filenames are “analogue_chain_limits_&lt;temp&gt;_&lt;version&gt;.yaml”, where &lt;temp&gt; is either ‘ambient’ or ‘tvac’ and &lt;version&gt; is ‘v??’ with ?? = the version number, e.g. 04.</p>
<div class="paragraph">
<p>Verify that the file received from Sami has the right version number (= the ‘next one’) and that the temperatures are well formulated as “ambient” and “tvac” (e.g. not “cold”)</p>
</div>
</li>
<li>
<p>Update the setup accordingly:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>CSL UI: “Configuration” tab → Sect. 2 (SFT) CCD offsets and readout noise”</p>
</li>
<li>
<p>version (mandaroty) : the version of your calibration file (integer)</p>
</li>
<li>
<p>temp (mandatory) : either ‘ambient’ or ‘tvac’</p>
</li>
<li>
<p>confdir (optional) : can be left blank : the directory where the calibration files will be found. The default is taken from the env. variable PLAT0_CONF_DATA_LOCATION</p>
</li>
<li>
<p>description (optional) : if left blank,  replaced with “Incl. power consumption limits for &lt;camera&gt;. Ref. file version &lt;version&gt;”</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The calibration file is selected based on the camera.ID, which is determined from the current setup (<code>setup.camera.ID</code>), so prior to this, make sure to start after loading a preliminary setup for the new camera.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.camera.ID</strong></code>, <code><strong>setup.camera.serial_number</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See "Camera identifiers" above</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.camera.ccd</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>setup.camera.orgin_offset_x</code>, <code>origin_offset_y</code> and <code>orientation</code>: must be updated from the FPA metrology excel sheet.</p>
</div>
<div class="paragraph">
<p>To compute the new values from plato-test-scripts, run the ipython notebook <code>scripts/ccd_info.ipynb</code>.</p>
</div>
<div class="paragraph">
<p>Alternative:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Input data: FPA metrology excel sheet. PL-ALN-CSL-0050 “coordinates of the corner pixels”)</p>
</li>
<li>
<p>Script camtest.analysis.analysis_fpa_eidp_corners.py</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Ingest the coordinates according to the format existing for previous cameras</p>
</li>
<li>
<p>Run the code snippet for the new camera.</p>
</li>
</ol>
</div>
</li>
<li>
<p>CSL UI: "Configuration" tab → Sect. "2 - Include information in setup" → "CCD positions":</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the camera_id (choose from drop-down menu)</p>
</li>
<li>
<p>Load the  FPA metrology spreadsheet from step 1</p>
</li>
<li>
<p>Complete the description (should contain camera name + issue number)</p>
</li>
<li>
<p>Press "run"</p>
</li>
<li>
<p>Check the proposed changes to the setup → Agree to submit the setup</p>
</li>
</ol>
</div>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.camera.fov</strong></code>: TOU metrology excel sheet</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>setup.camera.fov.focal_length</code>: update from LDO TOU metrology excel sheet.</p>
</div>
<div class="paragraph">
<p><code>setup.camera.fov.distortion_coefficients</code>: update from LDO TOU metrology excel sheet.</p>
</div>
<div class="paragraph">
<p><code>setup.camera.fov.inverse_distortion_coeffcients</code>: computed from the distortion coefficients</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Input data: TOU metrology excel sheet</p>
</li>
<li>
<p>To compute : from the plato-test-scripts, run the ipython notebook <code>scripts/field_distortion.ipynb</code></p>
</li>
<li>
<p>CSL UI: "Configuration" tab → Sect. "2 - Include information in setup" → "Field distortion &amp; Focal length":</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the camera_id (choose from drop-down menu)</p>
</li>
<li>
<p>Load the TOU metrology spreadsheet from step 1</p>
</li>
<li>
<p>Complete the description (should contain camera name + issue number)</p>
</li>
<li>
<p>Press "run"</p>
</li>
<li>
<p>Check the proposed changes to the setup → Agree to submit the setup</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><code>setup.camera.fov.tau</code>: no update. If needed, it will be updated after recalibration.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_remaining_setup_sections">9.4.5. Remaining Setup sections</h4>
<table class="tableblock frame-ends grid-none stripes-odd stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 88.8889%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><em>setup.csl_model</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>is automatically updated during operations. This demands a laser-tracker metrology input file from CSL.</p>
</div>
<div class="paragraph">
<p>See <a href="#sec-reduce-raw-ldo">Section 9.6.1</a> for details.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.fov_positions.reference_full_40.x</strong></code> &amp; <code><strong>y</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>To be updated from the LDO metrology, for use with ‘use_angles = False’ in the verification of the LDO metrology.</p>
</div>
<div class="paragraph">
<p>They can be found in the columns presenting the TOU_MEC / MRF X &amp; Y coordinates of the LDO measurements at ambient, in their metrology deliverables document (columns x and y in PL-ALN-CSL-0520 in sheet “TOU” of the TOU/LDO “RP” document; see <a href="#sec-new-camera-ref">Section 9.7</a>).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><strong>setup.telemetry</strong></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>Make a copy of the telemetry dictionary of the previous camera (CSV file)</p>
</li>
<li>
<p>Replace the beer name in the filename</p>
</li>
<li>
<p>Submit the files to the plato-cgse-conf GitHub repository (in common/telemetry)</p>
</li>
<li>
<p>CSL UI: "Configuration" tab → Sect. "2 - Include information in setup" → "Telemetry"</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the camera_id (choose from drop-down menu)</p>
</li>
<li>
<p>Load the file from step 1</p>
</li>
<li>
<p>Complete the description (should contain camera name + issue number)</p>
</li>
<li>
<p>Press "run"</p>
</li>
<li>
<p>Check the proposed changes → Agree to submit the setup</p>
</li>
</ol>
</div>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><em>setup.sensor_calibration</em></code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No update needed.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_a_new_camera_arrives_at_the_test_houses">9.5. A new camera arrives at the test houses</h3>
<div class="paragraph">
<p>TBW</p>
</div>
</div>
<div class="sect2">
<h3 id="_additional_preparation_steps">9.6. Additional preparation steps</h3>
<div class="sect3">
<h4 id="sec-reduce-raw-ldo">9.6.1. Reduce the raw LDO data</h4>
<div class="paragraph">
<p>The raw data from LDO’s measurements at ambient must be reduced and the results formatted as if acquired in CSL to allow for easy comparisons by the CSL operators.</p>
</div>
<div class="paragraph">
<p>The raw data is attached to a document, whose reference can be found in the CSL weekly meeting (updated there). See also <a href="#sec-new-camera-ref">Section 9.7</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verify the next obsid that is free for LDO (see table in Section XXXXX).</p>
</li>
<li>
<p>Reduce the LDO data</p>
</li>
<li>
<p>Compare the results (ellipse-sizes) with those from LDO (presented in their metrology excel sheet)</p>
</li>
<li>
<p>Copy the resulting fits file on the CSL server, in the /data/reduced/ directory (TBC)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>So far the raw data is reduced manually, due to various issues and changes in the measurements and in the formats of the LDO deliveries.</p>
</div>
</div>
<div class="sect3">
<h4 id="sec-csl-ref-frames">9.6.2. CSLReferenceFrame</h4>
<div class="paragraph">
<p>The CSL operator GUI needs a laser-tracker metrology file from CSL. That is an excel file with a “data” sheet that is read by the task in the GUI.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The file is communicated to KUL after alignment of the camera on the setup. It doesn&#8217;t need any modification.</p>
</li>
<li>
<p>It must be pushed to the plato-cgse-conf repository in the 'data/CSL[12]/conf' directory and after that the repository must be pulled on both the server and client machines.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>NB: The name of the file will be PLATO-CSL-PL-RP_00YY_vX.3_CSL_RFModel_FMX_CAMID_ROT?_ISO??.xlsx where YY is a document number, X is the FM-TOU-number (e.g. FM2 is Chimay), and the single and double question marks point to the rotation and isostatic tables used. The filename is not critical, it is a free parameter in the arguments panel of the CSL operator GUI.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec-new-camera-ref">9.7. Reference Information</h3>
<div class="paragraph">
<p>Camera configuration &amp; ABCL:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Most information can be found in AD01: PLATO-INAF-PL-LI-0071 : PFM_FM_FS_CAM_ABCL</p>
</li>
<li>
<p>Links between CAM ID, TOU, FPA &amp; metrology reports are in the minutes of the CSL weekly (the table is permanent and updated in there)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>CAM ID : from PLATO-CSL-PL-PR-0019 version 1.1</p>
</div>
<div class="paragraph">
<p>TOU is the usual reference FM#n.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The serial number can be found in AD01 or in Confluence: <a href="https://s2e2.cosmos.esa.int/confluence/pages/viewpage.action?pageId=171639593" class="bare">https://s2e2.cosmos.esa.int/confluence/pages/viewpage.action?pageId=171639593</a></p>
</li>
<li>
<p>It has the following structure: <code>N?-CAM-1?100000-FM-##</code> where <code>?</code> runs from 1 to 4 and denotes the camera-group, whereas <code>##</code> runs from 01 to 06 and marks the camera number within the group.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DEAD : from AD01 (original reference: PTO-EST-PL-TN-1369 version 1.0)</p>
</div>
<div class="paragraph">
<p>Metrology</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For the TOU, metrology reports start with PLATO-INAF-PL-RP and can be found in the TOU EIDP, in Eclipse or <code>/STER/platodata/EIDP/{camera}/TOU/… /12-Test Reports/</code></p>
</li>
<li>
<p>For the TOU, the raw data can be found in documents starting with PLATO-INAF-PL-TR, and are in the EIDP or delta_EIDP</p>
</li>
<li>
<p>For the FPA, metrology reports start with PTO-EST-PL-RP and can be found directly in Eclipse</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>TODO: link the TOU &amp; FPA Ref. to their EIDP in Eclipse ?</p>
</div>
<div class="paragraph">
<p>To be allocated to the right camera:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PTO-EST-PL-REP-1551 - PLATO FM7 FPA Metrology Summary</p>
</li>
<li>
<p>PTO-EST-PL-REP-1552 - PLATO FM8 FPA Metrology Summary</p>
</li>
<li>
<p>PTO-EST-PL-REP-1553 - PLATO FM10 FPA Metrology Summary</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="camera-switch-on-off">10. Switching ON/OFF the Camera</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you can start any operations or tests, you will need to switch on the Camera N-CAM following a dedicated Camera Switch ON procedure. Also for switching off the Camera you will need to follow a series of steps to be executed in the correct order.</p>
</div>
<div class="paragraph">
<p>The steps for Camera Switch ON are the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Send commands to the AEU to power on the camera and enable the sync signals → Camera is now in ON mode</p>
</li>
<li>
<p>Send the FPGA defaults to the N-FEE</p>
</li>
<li>
<p>Go to STANDBY mode</p>
</li>
<li>
<p>Go to DUMP mode, external sync</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The steps for the Camera Switch OFF:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to STANDBY mode</p>
</li>
<li>
<p>Go to ON mode</p>
</li>
<li>
<p>Send commands to the AEU to disable the sync signals and power off the camera</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note that, although the individual steps all exist as tasks in the Operator GUI, the procedure to switch OFF and ON the Camera should be used from the Operator GUI:  <code>Camera TAB &gt; 4 — Camera &gt; Switch ON / Switch OFF</code>. These tasks step through the different steps in the procedure and perform additional checks like voltages/currents/power, N-FEE mode etc. prompting the user for confirmation at each step.</p>
</div>
<div id="fig-task-gui-camera-switch-on-off" class="imageblock text-center">
<div class="content">
<img src="../images/task-gui-camera-switch-on-off.png" alt="task gui camera switch on off" width="80%">
</div>
<div class="title">Figure 9. Screenshot of the Operator Task GUI where the Camera Switch On and Switch OFF have been framed.</div>
</div>
<div class="sect2">
<h3 id="_detailed_description_of_camera_switch_on">10.1. Detailed description of Camera Switch ON</h3>
<div class="paragraph">
<p>This section describes what is done during the Camera Switch ON procedure, i.e. by running the task 'Camera Switch ON' in the Operator GUI. Although the individual steps are explained in detail, you should still run the <code>Camera Switch ON</code> task instead of each step separately. <strong>Only use the individual commanding when in a contingency</strong>.</p>
</div>
<div class="paragraph">
<p>The AEU Test EGSE shall be on StandBy mode before we start. You can check that in the AEU GUI where the <em>Stand-by</em> LED in the left panel (EGSE mode) shall be green.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Before powering on the AEU, stop all AEU related control servers. When you power on the AEU, the LEDs on the front panel start blinking (you won&#8217;t see anything in the AEU GUI since the control servers are not running). This blinking takes about three minutes and you shall NOT start the AEU control servers before the LEDs stop blinking.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Step 1. Send commands to the AEU to power on the camera and enable the sync signals</strong></p>
</div>
<div class="paragraph">
<p>The AEU Test EGSE is now ready to power the camera and enable the synchronisation. This is the first step in the procedure. The individual task is: <code>Task GUI &gt; Camera TAB &gt; 2 — AEU &gt; Switch ON</code>. From the Python REPL<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>, you can execute these commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-%nowrap" data-lang="%nowrap">&gt;&gt;&gt; from camtest import start_observation, end_observation  <i class="conum" data-value="1"></i><b>(1)</b>
&gt;&gt;&gt; from camtest.commanding import aeu

&gt;&gt;&gt; start_observation("AEU N-CAM Switch ON")
&gt;&gt;&gt; aeu.n_cam_swon()
&gt;&gt;&gt; aeu.n_cam_sync_enable(image_cycle_time=25, svm_nom=1, svm_red=0)
&gt;&gt;&gt; end_observation()</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>import statements will be given only once, they are normally automatically loaded from the <code>startup.py</code> file.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The camera shall now be in ON mode (check this in the DPU GUI) and the AEU GUI should have the following LEDs turned green: 'Functional check &amp; TVAC', 'N-CAM', all power lines</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/aeu-gui-after-n-cam-switch-on.png" alt="aeu gui after n cam switch on">
</div>
<div class="title">Figure 10. The state of the AEU Test EGSE after a AEU N-CAM Switch ON</div>
</div>
<div class="paragraph">
<p>At this point, the Camera Switch ON procedure will perform a few additional tasks that are not done when you execute the individual steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The AEU (cRIO &amp; PSU) HK sampling frequency will be increased to 4Hz for the time of the Camera Switch ON procedure. The frequency can be changed in the arguments panel of the task GUI.</p>
</li>
<li>
<p>The N-FEE register map is loaded by the DPU Processor. This will synchronise the DPU Processor internal state with the N-FEE state. This step requires that the DPU CS was started and is running.</p>
</li>
<li>
<p>The AEU cRIO voltages and currents will be printed in an overview table and checked against their limits. The operator is asked to confirm or abort.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Step 2. Send the FPGA defaults to the N-FEE</strong></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This step shall be skipped for the EM camera as there are not updated FPGA defaults defined for EM.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each camera N-FEE requires a update of a number of FPGA parameters in the register map. That is what we call the <em>FPGA defaults</em>. Please note that these settings are camera specific and influence the proper readout of the CCDs, so it&#8217;s important that this step is executed at the right time in the procedure. The individual task is: <code>Task GUI &gt; Camera TAB &gt; 3 — N-FEE &gt; Set FPGA defaults</code>. From the REPL you can execute these commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; from camtest.commanding import dpu
&gt;&gt;&gt; execute(dpu.n_fee_set_fpga_defaults)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The user will be prompted to confirm the values have been correctly applied in the N-FEE FPGA.</p>
</div>
<div class="paragraph">
<p>The FPGA defaults are read from the current Setup. In the Setup there is an entry <code>setup.camera.fee.fpga_defaults</code> that loads the YAML file with the correct values for the camera. The values are expressed as registers (32bit values) and not as individual parameters. You can inspect the values as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; setup.camera.fee.fpga_defaults

NavigableDict
├── reg_0_config: 119D0000
├── reg_1_config: 0
├── reg_2_config: E40FA36B
├── reg_3_config: 8F60000
├── reg_4_config: 186A7D8C
├── reg_5_config: 3EA030D4
├── reg_6_config: 0
├── reg_7_config: 0
├── reg_8_config: 0
├── reg_9_config: 0
├── reg_10_config: 0
├── reg_11_config: 0
├── reg_12_config: 0
├── reg_13_config: 0
├── reg_14_config: 0
├── reg_15_config: 0
├── reg_16_config: 0
├── reg_17_config: 0
├── reg_18_config: 7FE7EF16
├── reg_19_config: FE7EE7FE
├── reg_20_config: 19BCD
├── reg_21_config: 5E5000
├── reg_22_config: 4241AE9
├── reg_23_config: 0
├── reg_24_config: 0
├── reg_25_config: 6400000
└── reg_26_config: 3E807D0

&gt;&gt;&gt; setup.camera.fee.get_raw_value('fpga_defaults')
'yaml//../../common/n-fee/nfee_fpga_defaults_brigand.yaml'</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Step 3. Go to STANDBY mode</strong></p>
</div>
<div class="paragraph">
<p>Now, the camera will be brought into STANDBY mode. This means the CCDs will be powered and start accumulating flux. The individual task is: <code>Task GUI &gt; Camera TAB &gt; 3 — N-FEE &gt; To STANDBY mode</code>. From the REPL, the command is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; execute(dpu.n_cam_to_standby_mode)</pre>
</div>
</div>
<div class="paragraph">
<p>In the Camera Switch ON procedure, the user will be prompted to confirm the N-FEE is actually in STANDBY mode.</p>
</div>
<div class="paragraph">
<p>Again, the procedure will check the AEU cRIO voltages and currents and print an overview table. Please note that the configured limits are different for ON mode, STANDBY mode and also DUMP mode. At each step the procedure will perform this check. The operator is asked to confirm or abort.</p>
</div>
<div class="paragraph">
<p><strong>Step 4. Go to DUMP mode, external sync</strong></p>
</div>
<div class="paragraph">
<p>The last step in the switch-on procedure is to bring the camera in DUMP mode (external sync). As explained in <a href="#n-fee-operations">Chapter 12</a>, DUMP mode is not a genuine FEE operation mode, but is defined in the CGSE as a state in which the N-FEE is in FULL IMAGE mode in which the dump gate is kept high, continuously resetting the readout register. No data is acquired or send to the DPU. The indicidual task is: <code>Task GUI &gt; Camera TAB &gt; 3 — N-FEE &gt; To DUMP mode</code>. The command you can use in the REPL is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; execute(dpu.n_cam_to_dump_mode)</pre>
</div>
</div>
<div class="paragraph">
<p>The user will then be prompted to confirm that the N-FEE is actually in DUMP mode. After confirmation, the AEU cRIO voltages and currents will be checked against their limits and printed in an overview table asking the user for another confirmation.</p>
</div>
<div class="paragraph">
<p>One last step that is part of the Camera Switch ON procedure is to take a series of single images without the light source on. That is, it will be full frame darks with the dump gate enabled.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-%nowrap" data-lang="%nowrap">&gt;&gt;&gt; dpu.n_cam_acquire_and_dump(num_cycles=5, row_start=0, row_end=4539, rows_final_dump=0, ccd_order=[1, 2, 3, 4], ccd_side="BOTH")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, the AEU cRIO and PSU HK frequency is reset to their default values from the Settings, i.e. <code>HK_DELAY</code>.</p>
</div>
<div class="paragraph">
<p>This concludes the Camera Switch ON procedure as it is currently implemented and required to execute. The camera will be in DUMP mode after this switch-on which is the starting state for all the TVAC tests that will be executed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_detailed_description_of_camera_switch_off">10.2. Detailed description of Camera Switch OFF</h3>
<div class="paragraph">
<p>Switching OFF the camera is much simpler and doesn&#8217;t require specific checks. The N-FEE should normally be in DUMP mode when you start this switch-off and is brought first to STANDBY mode, then to ON mode. Each of these steps require confirmation from the operator. Finally, the AEU Switch OFF is executed which disables the sync signals and powers off the camera. The individual tasks are <code>Camera TAB &gt; 3 — N-FEE &gt; To STANDBY mode</code>, <code>Camera TAB &gt; 3 — N-FEE &gt; To ON mode</code>, and <code>Camera TAB &gt; 2 — AEU &gt; Switch OFF</code>. From the REPL, the following commands accomplish the same result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; start_observation("AEU N-CAM Switch OFF")
&gt;&gt;&gt; dpu.n_cam_to_standby_mode()
&gt;&gt;&gt; dpu.n_cam_to_on_mode()
&gt;&gt;&gt; aeu.n_cam_sync_disable()
&gt;&gt;&gt; aeu.n_cam_swoff()
&gt;&gt;&gt; end_observation()</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
As with the Camera Switch ON procedure, also for the switch-off, you shall use the Camera Switch OFF task from the <code>Task GUI &gt; Camera TAB &gt; 4 — Camera &gt; Switch OFF</code> instead of using the individual tasks or commands.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sft-analysis">10.3. Analysis of the Short Function Test (SFT)</h3>
<div class="paragraph">
<p>Every time you execute the Camera Switch ON procedure, the task will perform a short functional test using the <code>acquire_and_dump</code> command as shown below. This is a full-frame measurement of all four CCDs and both sides.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; dpu.n_cam_acquire_and_dump(num_cycles=5, row_start=0, row_end=4539,
                               rows_final_dump=0, ccd_order=[1, 2, 3, 4],
                               ccd_side="BOTH")</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the Operator Task GUI, Camera TAB (see <a href="#fig-task-gui-camera-switch-on-off">Figure 9</a>), there is a task button to execute the SFT analysis. In the arguments panel, you should provide the <code>obsid</code> of the Camera Switch ON as an integer, i.e. only the test id, not the site id. The <code>data_dir</code> is the parent folder where the observations are stored and the <code>output_dir</code> is where the result of the analysis will be saved.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/task-gui-sft-analysis-args.png" alt="task gui sft analysis args">
</div>
<div class="title">Figure 11. Input arguments panel that will appear when selecting the <em>SFT Analysis</em> task button in the Operator Task GUI.</div>
</div>
<div class="paragraph">
<p>The SFT analysis runs two different functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first one verifies the currents and power limits on the N-FEE with the HK of the AEU voltages and currents.</p>
</li>
<li>
<p>The second analyses the image data and verifies that the electronic offset and readout noise are within the acceptable boundaries for the given camera.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These functions produce several standard output files, consisting in</p>
</div>
<div class="ulist">
<ul>
<li>
<p>plots of the data</p>
</li>
<li>
<p>text files with the limit-checks and success-criteria.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The HK checks produce the following files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sft_analysis_&lt;camera&gt;_&lt;obsid&gt;_HK_AEU-CRIO_VI.png</code></p>
</li>
<li>
<p><code>sft_analysis_&lt;camera&gt;_&lt;obsid&gt;_HK_checks.txt</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>where &lt;camera&gt; is the camera.ID, e.g. 'duvel', and &lt;obsid&gt; is the observation id, e.g. ‘01234’.</p>
</div>
<div class="paragraph">
<p>The former is a plot of the HK, looking like this for an SFT measurement on Brigand:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/sft-analysis-01.png" alt="sft analysis 01">
</div>
<div class="title">Figure 12. Standard output of the HK checks in the SFT analysis. The top panel shows the voltages, while the currents are on the bottom. The blue dashed lines mark the FEE-mode transitions (starting with OFF, then ON, STANDBY and FULL_IMAGE_MODE). The dashed gray lines mark the frame acquisition times during the execution of <code>n_cam_acquire_and_dump</code>.</div>
</div>
<div class="paragraph">
<p>The latter file is a text file and contains the limit-checks for currents and power consumption, and nominally ends with a message formatted like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>All V-AEU OK: True
All V-FEE OK: True
All I OK:     True
All P OK:     True

All values OK.

IF offsets &amp; readout noise OK, you can PROCEED.</pre>
</div>
</div>
<div class="paragraph">
<p>If any of the checks are invalid it recommends to “STOP for analysis”.</p>
</div>
<div class="paragraph">
<p>The image analysis part produces the following files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sft_analysis_&lt;camera&gt;_&lt;obsid&gt;_img_raw.png</code></p>
</li>
<li>
<p><code>sft_analysis_&lt;camera&gt;_&lt;obsid&gt;_img_offsetSubtracted.png</code></p>
</li>
<li>
<p><code>sft_analysis_&lt;camera&gt;_&lt;obsid&gt;_img_avg_rows_and_columns.png</code></p>
</li>
<li>
<p><code>sft_analysis_&lt;camera&gt;_&lt;obsid&gt;_img_checks_offsets_ron_&lt;func&gt;.txt</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>where &lt;func&gt; is the statistical function used to combine the results obtained from individual columns (default is ‘mean’).</p>
</div>
<div class="paragraph">
<p>The ‘raw’ image displays one full-frame image of the 4 CCDs (the layer is chosen at run-time of the analysis, and is reported in the image itself).</p>
</div>
<div class="paragraph">
<p>The <code>offsetSubtracted</code> image corresponds to the same data, after subtraction from the offset computed from the serial overscan columns.</p>
</div>
<div class="paragraph">
<p>The <code>avg_rows_and_columns</code> presents the average row and column profiles of the image area (including parallel overscan) of the 8 half-CCDs independently.</p>
</div>
<div class="paragraph">
<p>Examples of such images can be found below.</p>
</div>
<div class="paragraph">
<p>The text file contains the limit-checks for electronic offsets and readout noise, and nominally ends with a message formatted like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Summary
off_spre        OK
off_sover       OK
off_pover       OK
off_img         OK
noise_sover     OK
noise_img_col   OK

Checks of CCD offsets &amp; r.o.n. OK.

IF voltage checks OK, you can PROCEED.</pre>
</div>
</div>
<div class="paragraph">
<p>Here as well, if any of the checks are invalid it recommends to “STOP for analysis”.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Standard images output by the SFT analysis.</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="../images/sft-analysis-02.png" alt="sft analysis 02">
</div>
<div class="title">Figure 13. The RAW image.</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="../images/sft-analysis-03.png" alt="sft analysis 03">
</div>
<div class="title">Figure 14. Image after offset-subtraction.</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="imageblock">
<div class="content">
<img src="../images/sft-analysis-04.png" alt="sft analysis 04">
</div>
<div class="title">Figure 15. Standard image output of the SFT analysis, presenting the average row and column profiles for the image-area in all half-CCDs.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="aeu-operations">11. Operating the AEU EGSE</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_2">11.1. Introduction</h3>
<div class="paragraph">
<p>On the spacecraft, the Ancillary Electronics Unit (AEU) is providing the
FEE with the necessary stabilised secondary voltages and is also
providing synchronisation signals to allow the different FEEs to
synchronise their CCD readout cycle to the temperature control system
(TCS) heater power switching.</p>
</div>
<div class="paragraph">
<p>On CAM level, we do not use a flight-like AEU. A dedicated AEU EGSE is
providing the power supplies and synchronisation signals needed to
operate a single N-type or single F-type camera.</p>
</div>
<div class="paragraph">
<p>The AEU EGSE supplies 6 voltages to the FEE:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>V_CCD</p>
</li>
<li>
<p>V_CLK</p>
</li>
<li>
<p>V_AN1</p>
</li>
<li>
<p>V_AN2</p>
</li>
<li>
<p>V_AN3</p>
</li>
<li>
<p>V_DIG</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#fig-n-aeu-default-voltages">Figure 16</a>, <a href="#fig-n-aeu-default-currents">Figure 17</a>, <a href="#fig-f-aeu-default-voltages">Figure 18</a>, and <a href="#fig-f-aeu-default-currents">Figure 19</a>  list the default voltage and current values for the N-AEU and F-AEU.</p>
</div>
<div id="fig-n-aeu-default-voltages" class="imageblock">
<div class="content">
<img src="../images/n-aeu-def-voltages.png" alt="n aeu def voltages">
</div>
<div class="title">Figure 16. Default voltage values for the N-AEU.</div>
</div>
<div id="fig-n-aeu-default-currents" class="imageblock">
<div class="content">
<img src="../images/n-aeu-def-currents.png" alt="n aeu def currents">
</div>
<div class="title">Figure 17. Default current values for the N-AEU.</div>
</div>
<div id="fig-f-aeu-default-voltages" class="imageblock">
<div class="content">
<img src="../images/f-aeu-def-voltages.png" alt="f aeu def voltages">
</div>
<div class="title">Figure 18. Default voltage values for the F-AEU.</div>
</div>
<div id="fig-f-aeu-default-currents" class="imageblock">
<div class="content">
<img src="../images/f-aeu-def-currents.png" alt="f aeu def currents">
</div>
<div class="title">Figure 19. Default current values for the F-AEU.</div>
</div>
<div class="paragraph">
<p>The AEU EGSE provides sync pulses to the N-FEE, F-FEE, TCS EGSE, and the
EGSE (e.g. shutter controller of the OGSE). The following
synchronisation signals can be configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Clk_N_ccdread_AEU</code> / <code>Clk_F_ccdread_AEU</code>;</p>
</li>
<li>
<p><code>Clk_heater</code> (nominal/redundant in case of operating an F-CAM);</p>
</li>
<li>
<p><code>Clk_50MHz</code> (nominal redundant in case of operating an N-CAM)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The synchronisation output signal timings are shown in <a href="#fig-aeu-sync-sgnals">Figure 20</a>.</p>
</div>
<div id="fig-aeu-sync-sgnals" class="imageblock">
<div class="content">
<img src="../images/aeu-sync-signals.png" alt="aeu sync signals">
</div>
<div class="title">Figure 20. Synchronisation output signal timings: Clk_ccdread &amp; Clk_heater, as taken from RD-05.</div>
</div>
</div>
<div class="sect2">
<h3 id="_aeu_switch_on_and_off">11.2. AEU switch on and off</h3>
<div class="paragraph">
<p>The AEU is switched on by the operator by powering up the unit. During
the first 3 minutes after powering up no AEU commanding shall take
place. The front-panel leds stand-by, self-test, functional check &amp;
TVAC, and alignment will be blinking until the system is ready.</p>
</div>
</div>
<div class="sect2">
<h3 id="changing-aeu-op-mode">11.3. Changing between AEU EGSE operation modes</h3>
<div class="paragraph">
<p>The AEU EGSE has 4 functional modes:</p>
</div>
<div class="paragraph">
<p><strong>Stand-by:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>AEU EGSE has power and is ready to receive commands;</p>
</li>
<li>
<p>AEU EGSE distributes telemetry;</p>
</li>
<li>
<p>No sync signal is generated;</p>
</li>
<li>
<p>All FEE secondary voltages are down and cannot be activated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Functional check &amp; TVAC mode</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>AEU EGSE has power and is ready to receive commands;</p>
</li>
<li>
<p>AEU EGSE distributes telemetry;</p>
</li>
<li>
<p>All sync signals can be commanded on/off;</p>
</li>
<li>
<p>Secondary voltage generation can be commanded on and off.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>(ambient) Alignment operating mode</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>AEU EGSE has power and is ready to receive commands;</p>
</li>
<li>
<p>AEU EGSE distributes telemetry;</p>
</li>
<li>
<p>Only following synchronisation signals can be commanded on/off:</p>
<div class="ulist">
<ul>
<li>
<p><code>Clk_50MHz_N-AEU_N-FEE</code>;</p>
</li>
<li>
<p><code>Clk_50MHz_F-AEUnom_F-FEE</code>;</p>
</li>
<li>
<p><code>Clk_50MHz_F-AEUred_F-FEE</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The secondary voltage generation can be commanded on/off;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Self-test</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>EGSE runs a self-diagnostic to check the status of its sync and
secondary voltage outputs, and reports the results in its TM;</p>
</li>
<li>
<p>The GSE autonomously reverts to stand-by mode once the self-diagnostic
is complete;</p>
</li>
<li>
<p>In this mode, the FEE and TCS EGSE have to be physically disconnected
from the AEU EGSE, and their connectors on the AEU EGSE have to be
connected to the test port connector on the AEU EGSE.</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../images/aeu-egse-mode-transitions.png" alt="aeu egse mode transitions" width="60%">
</div>
<div class="title">Figure 21. AEU EGSE mode transitions.</div>
</div>
<div class="paragraph">
<p>Switching modes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; from egse.aeu.aeu import OperatingMode
&gt;&gt;&gt; aeu.set_operating_mode(OperatingMode.STANDBY)
&gt;&gt;&gt; aeu.set_operating_mode(OperatingMode.FC_TVAC)
&gt;&gt;&gt; aeu.set_operating_mode(OperatingMode.ALIGNMENT)
&gt;&gt;&gt; aeu.set_operating_mode(OperatingMode.SELFTEST)</pre>
</div>
</div>
<div class="paragraph">
<p>Checking in which mode the AEU is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; mode = aeu.get_operating_mode()</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_power_supply_unit_setting_and_checking_current_and_voltage_protections">11.4. Power supply Unit: Setting and checking Current and voltage protections</h3>
<div class="paragraph">
<p>To read the voltage and current setpoints, and the corresponding
over-protection values (OVP and OCP) from the power supply units:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>&gt;&gt;&gt; v_ccd, v_clk, v_an1, v_an2, v_an3, v_dig = aeu.get_psu_voltage_setpoints()
&gt;&gt;&gt; ovp_ccd, ovp_clk, ovp_an1, ovp_an2, ovp_an3, ovp_dig = aeu.get_psu_ovp()
&gt;&gt;&gt; i_ccd, i_clk, i_an1, i_an2, i_an3, i_dig = aeu.get_psu_current_setpoints()
&gt;&gt;&gt; ocp_ccd, ocp_clk, ocp_an1, ocp_an2, ocp_an3, ocp_dig = aeu.get_psu_ocp()</code></pre>
</div>
</div>
<div class="paragraph">
<p>To read the measured voltages and currents from the power supply units:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>&gt;&gt;&gt; v_ccd, v_clk, v_an1, v_an2, v_an3, v_dig = aeu.get_psu_voltages()
&gt;&gt;&gt; i_ccd, i_clk, i_an1, i_an2, i_an3, i_dig = aeu.get_psu_currents()</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fee_voltages_and_currents">11.5. FEE voltages and currents</h3>
<div class="paragraph">
<p>To read the measured values for the voltages and currents, and the
corresponding protection values (UVP, OVP, and OCP):</p>
</div>
<div class="paragraph">
<p>For the N-CAM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>&gt;&gt;&gt; v_ccd, v_clk, v_an1, v_an2, v_an3, v_dig = aeu.get_n_cam_voltages()
&gt;&gt;&gt; uvp_ccd, uvp_clk, uvp_an1, uvp_an2, uvp_an3, uvp_dig = aeu.get_n_cam_uvp()
&gt;&gt;&gt; ovp_ccd, ovp_clk, ovp_an1, ovp_an2, ovp_an3, ovp_dig = aeu.get_n_cam_ovp()
&gt;&gt;&gt; i_ccd, i_clk, i_an1, i_an2, i_an3, i_dig = aeu.get_n_cam_currents()
&gt;&gt;&gt; ocp_ccd, ocp_clk, ocp_an1, ocp_an2, ocp_an3, ocp_dig = aeu.get_n_cam_ocp()</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the F-CAM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>&gt;&gt;&gt; v_ccd, v_clk, v_an1, v_an2, v_an3, v_dig = aeu.get_f_cam_voltages()
&gt;&gt;&gt; uvp_ccd, uvp_clk, uvp_an1, uvp_an2, uvp_an3, uvp_dig = aeu.get_f_cam_uvp()
&gt;&gt;&gt; ovp_ccd, ovp_clk, ovp_an1, ovp_an2, ovp_an3, ovp_dig = aeu.get_f_cam_ovp()
&gt;&gt;&gt; i_ccd, i_clk, i_an1, i_an2, i_an3, i_dig = aeu.get_f_cam_currents()
&gt;&gt;&gt; ocp_ccd, ocp_clk, ocp_an1, ocp_an2, ocp_an3, ocp_dig = aeu.get_f_cam_ocp()</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fee_voltage_memories">11.6. FEE voltage memories</h3>
<div class="paragraph">
<p>The AEU EGSE provides three memory positions to store default values for
the FEE voltages: position A, B, C.</p>
</div>
<div class="paragraph">
<p>TBD: We store the nominal N-FEE values in memory position A, the nominal
values for F-FEE in memory position B. + commands to store voltages,
currents, protection values in the memory positions</p>
</div>
</div>
<div class="sect2">
<h3 id="_aeu_powering_up_and_down_fee">11.7. AEU powering up and down FEE</h3>
<div class="paragraph">
<p>To power on and off the N- or F-CAM, the following building blocks can
be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>&gt;&gt;&gt; aeu.n_cam_swon()
&gt;&gt;&gt; aeu.n_cam_swoff()

&gt;&gt;&gt; aeu.f_cam_swon()
&gt;&gt;&gt; aeu.f_cam_swoff()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that switching on the camera, will put the AEU in functional check
and TVAC mode. Switching off, will put it back to stand-by mode.</p>
</div>
</div>
<div class="sect2">
<h3 id="_aeu_configuring_synchronisation_signals">11.8. AEU configuring synchronisation signals</h3>
<div class="paragraph">
<p>For the N-CAM, the synchronisation signals must be configured according
to the desired image cycle time. Allowed values for the image cycle time
are: 25, 31.25, 37.50, 43.75, and 50s. Note that - for image cycle times
longer than 25s - not all heater sync pulses are synchronised with a
Clk_ccdread sync pulse.</p>
</div>
<div class="paragraph">
<p>The following building blocks enable and disable the clock sync signals
that are sent to the N-FEE (i.e. Clk_50MHz, Clk_ccdread (here with an
image cycle time of 25s), and Clk_heater (synchronised with
Clk_ccdread)):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>&gt;&gt;&gt; aeu.n_cam_sync_enable(image_cycle_time=25)
&gt;&gt;&gt; aeu.n_cam_sync_disable()</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the F_CAM, the following building blocks enable and disable the
clock sync signals that are sent to the F-FEE (i.e.Clk_50MHz,
Clk_F_ccdread, and Clk_heater (synchronised with Clk_F_ccdread); nominal
clocks only):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>&gt;&gt;&gt; aeu.f_cam_sync_enable()
&gt;&gt;&gt; aeu.f_cam_sync_disable()</code></pre>
</div>
</div>
<div class="paragraph">
<p>To check the sync status of the clocks (i.e. whether or not they are
enabled) and whether or not a synchronisation failure has been detected:</p>
</div>
<div class="paragraph">
<p>For the N-CAM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>&gt;&gt;&gt; clk_50mhz, clk_ccdread = aeu.get_n_cam_sync_status()
&gt;&gt;&gt; clk_50mhz, clk_ccdread = aeu.get_n_cam_sync_quality()</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the F-CAM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>&gt;&gt;&gt; clk_50mhz_nom, clk_50_mhz_red, clk_ccdread_nom, clk_ccdread_red = aeu.get_f_cam_sync_status()
&gt;&gt;&gt; clk_50mhz_nom, clk_50_mhz_red, clk_ccdread_nom, clk_ccdread_red = aeu.get_f_cam_sync_quality()</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the SVM/heater:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>&gt;&gt;&gt; clk_50mhz_nom, clk_50mhz_red, clk_heater_nom, clk_heater_red = aeu.get_svm_sync_status()
&gt;&gt;&gt; clk_50mhz_nom, clk_50mhz_red, clk_heater_nom, clk_heater_red = aeu.get_svm_sync_quality()</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/aeu-clock-pulses.png" alt="aeu clock pulses">
</div>
<div class="title">Figure 22. Clk_N_ccdread (purple) sync pulses and Clk_heater pulses(orange) with image cycle time set to 50s (instead of the nominal 25s). Note that the pulse to read the 1st CCD is wider. The Clk_heater pulses continue with a period of 12.5s, independently of the image cycle time so if the image cycle time is not 25s, the heater will not always be synchronised with a CCD readout.</div>
</div>
</div>
<div class="sect2">
<h3 id="_aeu_self_test">11.9. AEU self test</h3>
<div class="paragraph">
<p>When the AEU is put in self-test mode (see <a href="#changing-aeu-op-mode">Section 11.3</a>), the loopback
option can be set as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; aeu.selftest(LoopBack.NO_LOOPBACK)
&gt;&gt;&gt; aeu.selftest(LoopBack.F_CAM_NOM)
&gt;&gt;&gt; aeu.selftest(LoopBack.F_CAM_RED)
&gt;&gt;&gt; aeu.selftest(LoopBack.N_CAM)
&gt;&gt;&gt; aeu.selftest(LoopBack.SVM_NOM)
&gt;&gt;&gt; aeu.selftest(LoopBack.SVM_RED)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_aeu_telemetry_parameters">11.10. AEU Telemetry parameters</h3>
<div class="imageblock text-center">
<div class="content">
<img src="../images/aeu-tm-parameters-1.png" alt="aeu tm parameters 1">
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../images/aeu-tm-parameters-2.png" alt="aeu tm parameters 2">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_functional_summary">11.11. Functional summary</h3>
<div class="paragraph">
<p>At the start of a test day, the following two AEU building blocks must
be executed (either independently or in another building block):</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 62.5%;">
<col style="width: 37.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">For N-CAM testing:</th>
<th class="tableblock halign-left valign-top">For F-CAM testing:</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; aeu.n_cam_swon()
&gt;&gt;&gt; aeu.n_cam_sync_enable(image_cycle_time)</pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; aeu.f_cam_swon ()
&gt;&gt;&gt; aeu.f_cam_sync_enable()</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>At the end of a test day, the following two AEU building blocks must be
executed (either independently or in another building block):</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 62.5%;">
<col style="width: 37.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">For N-CAM testing:</th>
<th class="tableblock halign-left valign-top">For F-CAM testing:</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; aeu.n_cam_sync_disable()
&gt;&gt;&gt; aeu.n_cam_swoff()</pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; aeu.f_can_sync_disable()
&gt;&gt;&gt; aeu.f_cam_swoff()</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="n-fee-operations">12. Operating the N-FEE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes some basic principles on the N-FEE design and their practical impact on the N-FEE, CCD and camera operations.</p>
</div>
<div class="sect2">
<h3 id="_glossary">12.1. Glossary</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Parallel:</strong> direction parallel to the columns of the CCD (sometimes referred to as “vertical”).</p>
</li>
<li>
<p><strong>Serial:</strong> direction parallel to the rows of the CCD (sometimes referred to as “horizontal”).</p>
</li>
<li>
<p><strong>Readout register:</strong> single row of pixels below the active region of the CCD, used to transfer the charges in the serial direction towards the readout amplifier.</p>
</li>
<li>
<p><strong>Partial readout:</strong> describes a CCD readout process in which only a given range of CCD rows are digitized. The rows between the region and the readout register are dumped during the readout process, i.e., the recorded signal is not digitized, it is not transferred to the FEE and will not appear in the data.</p>
</li>
<li>
<p><strong>Windowing:</strong> refers to an FEE operating mode in which a pre-defined collection of windows on the CCDs is transferred to the DPU (during CAM-tests: the EGSE). The entire CCDs are readout and digitized, but only the pre-defined windows are transferred. The windowing mode is not used during alignment nor TVAC Camera testing and will not be discussed in this document.</p>
</li>
<li>
<p><strong>Dumping:</strong> a row during readout means to continuously reset the readout register. The charges transferred from the active region of the CCD are lost. The absence of serial transfer makes it much faster to dump a line (90 µs) than to read it out normally (parallel transfer 110μs + serial transfer ~800μs).</p>
</li>
<li>
<p><strong>Clearout</strong>: dumping all or part of a CCD.</p>
</li>
<li>
<p><strong>E and F</strong>: the Plato CCDs dispose of 2 readout amplifiers. The left and right halves of the CCD are transferred to the corresponding amplifier (they behave almost like independent CCDs). For some reason that thy shall not ask, E and F refer to the right and left halves of a CCD (mnemonic: same order as in “FEE”) respectively.</p>
</li>
<li>
<p><strong>Cycle</strong>: period between two long-synchronisation pulses (see below)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="sec-n-fee-operating-modes">12.2. N-FEE operating modes</h3>
<div class="paragraph">
<p>A complete list of the N-FEE operating modes can be found in <a href="#reference-documents">RD-06</a>. The main modes for camera testing are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ON</strong>: FEE powered on; CCDs powered off. This mode allows transitions to the test-pattern acquisition modes and to the STANDBY mode.</p>
</li>
<li>
<p><strong>STANDBY</strong>: FEE powered on; CCDs powered on. The CCDs are properly biased but not readout, i.e., they are “indefinitely integrating”.</p>
</li>
<li>
<p><strong>FULL_IMAGE</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>allowing for full-CCD acquisition</p>
</li>
<li>
<p>highly configurable mode, also allows partial readout, reverse clocking, charge injection etc.</p>
</li>
<li>
<p>This is the workhorse for the ground-based tests.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>WINDOWING</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>allowing for the acquisition of multiple windows on the CCDs</p>
</li>
<li>
<p>Highly configurable mode, also allows partial readout, reverse clocking, charge injection etc.</p>
</li>
<li>
<p>This mode is the baseline for the in-flight operations.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="fig-fee-operation-modes" class="imageblock text-center">
<div class="content">
<img src="../images/n-fee-operating-modes.png" alt="n fee operating modes" width="60%">
</div>
<div class="title">Figure 23. FEE Operating modes (RD-06)</div>
</div>
<div class="paragraph">
<p>The N-FEE Operating modes are described in more detail in the appendix attached to <a href="#reference-documents">RD-14</a>. The mode identifiers that you will probably see in Grafana screens or in housekeeping entries, are defined in the N-FEE Register Map and listed here for your convenience.</p>
</div>
<table id="tab-n-fee-modes" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. The N-FEE modes as defined in the Register Map for the PFM [<a href="#reference-documents">RD-15</a>]. The N-FEE mode is defined by the <code>ccd_mode_config</code> parameter in register 21.</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Mode</th>
<th class="tableblock halign-left valign-top">ID (hex)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">On-Mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full Image Pattern Mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windowing-Pattern Mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stand-By-Mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full Image Mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windowing-Mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Soft asynchronous Reset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Immediate On-Mode (Command)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parallel trap pumping mode 1 – Full-Image</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x9</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parallel trap pumping mode 2 – Full-Image</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Serial trap pumping mode 1 – Full Image</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Serial trap pumping mode 2 – Full Image</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserved</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xF</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="sec-cycle-timing">12.3. Cycle, Timing and Synchronisation</h3>
<div class="paragraph">
<p><strong>Readout timing:</strong> The AEU sends synchronization pulses to the FEE every 6.25 seconds. Every pulse triggers a CCD-readout. In nominal operations, the 4 CCDs in one camera are addressed sequentially, i.e. readout one at a time, delayed by one pulse period, i.e. 6.25 seconds.</p>
</div>
<div class="paragraph">
<p><strong>Cycle time and FEE configuration:</strong> all sync-pulses trigger a CCD readout. During nominal operations, every fourth pulse is “long” (it lasts 400ms instead of 200ms). <strong>We define the long-pulse period as the “cycle-time”.</strong> The cycle-time is important in two respects. First, in nominal operations, it takes 4 pulses to cycle over the 4 CCDs, i.e. each CCD is readout every cycle-time seconds. Second, the FEEs, i.e. the operating mode of the CCDs can be reconfigured whenever, but only when the FEE receives a long pulse. The FEE-register (containing the configuration parameters) is read during the pulse and the <strong>new configuration is</strong> immediately <strong>applied</strong> to the subsequent readouts, i.e. <em>to integrations that were already on-going.</em> This is important to keep in mind for the timing of your tests (see the timing examples in Appendix).</p>
</div>
<div class="paragraph">
<p><strong>Exposure time:</strong> the PLATO cameras have no shutter. Consequently, the CCDs integration never stops. In practice, the sync-pulses trigger the readout process, and the exposure time effectively corresponds to the cycle-time minus the readout time. That means for instance that for a given cycle-time, the effective exposure time will be longer when performing partial readout than when acquiring full-CCD images.</p>
</div>
<div class="paragraph">
<p><strong>Modifying the exposure time</strong>: the exposure time itself cannot be commanded at the level of the FEE. There are nevertheless various ways to modify the exposure time:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Increase it by changing the cycle time (see building block <code>n_cam_partial_cycle_config</code>, <a href="#sec-n-cam-partial-cycle-config">Section 12.4.8</a>)</p>
</li>
<li>
<p>Shorten it by changing the order in which we address the CCDs in the course of a cycle: e.g. readout the same CCD at every pulse instead of cycling through the 4 CCDs (see parameter <code>ccd_order</code> in <a href="#standard-building-block-parameters">Section 12.4.2</a>).</p>
</li>
<li>
<p>Increase it by not addressing a given CCD. If some given CCDs are not addressed for readout, they continue to integrate. The next time they are addressed (after reconfiguring the FEE), their effective exposure time will have been much longer than the nominal exposure time (e.g. for dark current or faint ghosts).</p>
</li>
<li>
<p>Disregard the AEU sync pulses and use FEE internal sync-pulses instead. This allows for exposure times shorter than 6.25 seconds (e.g. ambient).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>N-FEE internal sync-pulses</strong>: to accommodate short exposure times, the FEE can generate its own sync-pulses. The source of the sync pulses and period of the internal pulses can be configured with the following EGSE commands to the DPU:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_fee_set_internal_sync(int_sync_period) # in milliseconds
&gt;&gt;&gt; n_fee_set_external_sync()</code></pre>
</div>
</div>
<div class="paragraph">
<p>You shouldn’t use these commands directly but rather call the dedicated building block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_cam_partial_int_sync(...)</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
all N-FEE-generated pulses are long pulses. The cycle-time is hence identical to the CCD readout period, and there is no “natural” cycling through the 4 CCDs. Only when in DUMP mode, the 4 CCDs will be cycled also in internal sync. This is a feature of the DPU Processor implemented in the CGSE and is not available in flight. This CCD cycling in DUMP mode internal sync was implemented as of release 2023.19.0+CGSE.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_commanding_the_n_fees">12.4. Commanding the N-FEEs</h3>
<div class="paragraph">
<p>The following sections describe a collection of building blocks designed
to configure and operate the FEEs and the CCDs. A list of the building
blocks can also be found on the PLATO Confluence, in the PCOT space, by
following links to the “On-Ground Testing”.</p>
</div>
<div class="paragraph">
<p>Examples of time-sequencing for some operational approaches are
presented in <a href="#app-a-ex-ccd-acquisition">Appendix 18.A</a>.</p>
</div>
<div class="paragraph">
<p>In this section, for the sake of simplicity, the names of the building
blocks directly appear at the python prompt (<code>&gt;&gt;&gt;</code>), but remember that a
commanding building block will exclusively be accepted either within
another building block or function, or (hence generating an observation)
by the execute command (see <a href="#test-execution">Section 4.1</a>).</p>
</div>
<div class="sect3">
<h4 id="_ccd_and_pixel_references">12.4.1. CCD and pixel references</h4>
<div class="paragraph">
<p><a href="#fig-ccd-numbering-coordinates-fm">Figure 24</a> (for FM) and <a href="#fig-ccd-numbering-coordinates-em">Figure 25</a> (for EM) show the CCD numbering adopted for the commanding. We will further refer to these coordinate systems as CCDn_PIX n = 1,2,3,4. Note that these</p>
</div>
<div class="ulist">
<ul>
<li>
<p>each cover an entire CCD, without interruption at the “border” between E &amp; F (columns 2254 to 2255), and</p>
</li>
<li>
<p>differ from the CCD coordinate systems adopted in RD-10 (pix [1,1] close to the optical axis), as well as of those adopted at FEE-level (2 coord. systems/CCD, with the x-axes in opposite directions on E &amp; F).</p>
</li>
</ul>
</div>
<div id="_tabs_2" class="openblock tabs is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_2_fm" class="tab">
<p>FM</p>
</li>
<li id="_tabs_2_em" class="tab">
<p>EM</p>
</li>
</ul>
</div>
<div id="_tabs_2_fm--panel" class="tabpanel" aria-labelledby="_tabs_2_fm">
<div id="fig-ccd-numbering-coordinates-fm" class="imageblock text-center">
<div class="content">
<img src="../images/ccd-numbering-coordinates-fm.png" alt="ccd numbering coordinates fm" width="80%">
</div>
<div class="title">Figure 24. CCD numbering and pixel coordinates for the FM normal camera on every CCD (CCD_PIXn reference frames). The thicker black border lines represent the readout registers.</div>
</div>
</div>
<div id="_tabs_2_em--panel" class="tabpanel" aria-labelledby="_tabs_2_em">
<div id="fig-ccd-numbering-coordinates-em" class="imageblock text-center">
<div class="content">
<img src="../images/ccd-numbering-coordinates-em.png" alt="ccd numbering coordinates em" width="80%">
</div>
<div class="title">Figure 25. CCD numbering and pixel coordinates for the EM normal camera on every CCD (CCD_PIXn reference frames). The thicker black border lines represent the readout registers.</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="standard-building-block-parameters">12.4.2. Standard building block parameters</h4>
<div class="paragraph">
<p>Some of the input parameters are common to several building blocks. We
list some below, to avoid repeating them for every building block.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>num_cycles</strong></p>
<div class="ulist">
<ul>
<li>
<p>num_cycles = 0 sets the FEEs in the required configuration until commanded otherwise</p>
</li>
<li>
<p>num_cycles &gt; 0 indicates a finite number of cycles after which the N-FEE will automatically be (re)set to dump mode (see dump_mode below).</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>row_start, row_end</strong></p>
<div class="ulist">
<ul>
<li>
<p>These parameters configure the region of the CCD that will be readout, resulting in partial readout mode.</p>
</li>
<li>
<p>First, the rows &lt; row_start are transferred and dumped.</p>
</li>
<li>
<p>Then (row_end – row_start + 1) rows are readout and digitized.</p>
</li>
<li>
<p>If rows_final_dump = 0, nothing else happens</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>rows_final_dump</strong></p>
<div class="ulist">
<ul>
<li>
<p>If rows_final_dump &gt; 0, after the requested number of lines have been read, <code>rows_final_dump</code> rows to transfer and dumped.</p>
</li>
<li>
<p>This allows e.g. for a clearout of the CCD from all dark-current charges accumulated during the readout process before starting a new integration (important at ambient temperature)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>ccd_order</strong></p>
<div class="ulist">
<ul>
<li>
<p>During nominal operations, the four CCDs are sequentially addressed during every cycle. This parameter allows to specify and alter that sequence.</p>
</li>
<li>
<p>Examples: [1,2,3,4], [1,3,1,3], [2,2,2,2]</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>ccd_side</strong></p>
<div class="ulist">
<ul>
<li>
<p>This parameter indicates which side(s) of the CCD will be recorded.
With the readout register at the bottom, the E-side is the right half and
the F-side is the left half.</p>
</li>
<li>
<p>In full-image mode, the SpaceWire link to the DPU cannot cope with
transferring full frames. Consequently, a choice must be made, either E
or F.</p>
<div class="paragraph">
<p>The entire CCDs (E and F) is readout and transmitted to the FEE, but
only one side is transmitted to the DPU (or EGSE) every cycle.
Consequently, it takes a minimum of 2 cycles to obtain full-CCD images,
while the exposure time nevertheless still corresponds to one cycle</p>
</div>
</li>
<li>
<p>This parameter accepts the following values:</p>
<div class="ulist">
<ul>
<li>
<p>“E”, “F”, or “BOTH”</p>
</li>
<li>
<p><span class="line-through">A string of 4 characters, being either “E” or “F”, e.g. [“EFEF”]</span></p>
</li>
<li>
<p><span class="line-through">A string of 8 characters, being either “E” of “F”, e.g. [“EEEEFFFF”]</span></p>
</li>
</ul>
</div>
</li>
<li>
<p><span class="line-through">If a 4 values are given, the ccd_side will be changed at every sync
pulse, long or short. Four values will hence cover one cycle_time, but
it will take two full cycles to iterate over 8 values.</span></p>
</li>
<li>
<p>“BOTH” means both E and F sides are recorded every cycle. While
standard in windowing mode, this is not possible in full-image mode when
the camera is connected to an actual DPU, e.g. at integrated system
level (spacecraft). The N-FEEs were also neither designed nor
extensively tested for this (i.e. full image) by MSSL, but they can do
it, and this mode was shortly tested at EGSE level (with a real FEE). It
shall be used with caution but remains a possibility to speed up
full-CCD image acquisition if needed due to scheduling constraints.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_n_fee_mode_transitions">12.4.3. N-FEE mode transitions</h4>
<div class="paragraph">
<p>Two FEE-specific building blocks currently exist to put them into
specific operational “modes”:</p>
</div>
<div class="paragraph">
<p><strong>ON mode</strong> (<a href="#sec-n-fee-operating-modes">Section 12.2</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_fee_to_on_mode() -- building block
&gt;&gt;&gt; n_fee_is_on_mode() -- function</code></pre>
</div>
</div>
<div class="paragraph">
<p>NB: ON mode is the default mode after FEE switch on, but this building
block cannot be used to power on the FEE. That is handled by the AEU
(<a href="#aeu-operations">Chapter 11</a>).</p>
</div>
<div class="paragraph">
<p><strong>STANDBY mode</strong> (<a href="#sec-n-fee-operating-modes">Section 12.2</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_fee_to_standby_mode() -- building block
&gt;&gt;&gt; n_fee_is_standby_mode() -- function</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dump-mode">12.4.4. DUMP mode</h4>
<div class="paragraph">
<p>DUMP is not a genuine FEE operation mode. We defined it as a full-image mode in which the dump-gate is maintained high, i.e. the readout register is continuously reset. That is a convenient way to avoid saturation between tests, or building blocks of a given test. In addition, the N-FEE is configured with digitisation disabled which means the image data is not transmitted to the DPU.</p>
</div>
<div class="paragraph">
<p><strong>External sync</strong></p>
</div>
<div class="paragraph">
<p>The CCD operation proceeds over the 4 CCDs with a nominal cycle-time of 25 seconds, but the data are dumped. The default is to read out 0 lines, then do a full-frame clearout (rows_final_dump=4510).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_fee_to_dump_mode() – building block
&gt;&gt;&gt; n_fee_is_dump_mode() – function</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Internal sync</strong></p>
</div>
<div class="paragraph">
<p>The CCD operation proceeds over the 4 CCDs. In this mode, we read out 10
lines normally, then perform a full-frame clearout (rows_final_dump =
4510). The cycle time is a free parameter, but it must by all means not
be chosen shorter than the readout+clearout time. We therefore recommend
cycle_time &gt;= 1 second.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_fee_to_dump_mode_int_sync(cycle_time, ccd_order) – building block
&gt;&gt;&gt; n_fee_is_dump_mode() – function</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_n_cam_full_image_basic">12.4.5. N-CAM full-image, basic</h4>
<div class="paragraph">
<p>Standard full-image acquisition, with a nominal cycle time of 25
seconds, cycling over the 4 CCDs, and 30 rows of over-scan. Only the
duration and ccd_side must be specified. The simplest mode to acquire
full, or half-CCD images.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_cam_full_standard(num_cycles, ccd_side)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_n_cam_full_image">12.4.6. N-CAM full-image</h4>
<div class="paragraph">
<p>Identical to n_cam_full_standard, but allows to configure the ccd_order
and number of over-scan rows as well.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_cam_full_ccd(num_cycles, ccd_order, ccd_side, rows_overscan)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_n_cam_full_image_partial_readout_and_final_clearout">12.4.7. N-CAM full image, partial readout and final clearout</h4>
<div class="paragraph">
<p>Identical to n_cam_full_ccd, but allows for partial readout &amp; clearout
after readout. The over-scan rows are commanded via the partial-readout
parameters: over-scan is only acquired if row_end &gt; 4509.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_cam_partial_ccd(num_cycles, row_start, row_end, rows_final_dump, ccd_order, ccd_side)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec-n-cam-partial-cycle-config">12.4.8. N-CAM full image, with configurable cycle-time</h4>
<div class="paragraph">
<p>Identical to n_cam_partial_ccd, including the possibility to configure longer cycle times (from 25 to 50 sec, by steps of 6.25 seconds). The readout process is not affected by the cycle_time, so the additional time directly corresponds to an increase in exposure time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_cam_partial_cycle_config (num_cycles, row_start, row_end, rows_final_dump, ccd_order, ccd_side, cycle_time)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sec-n-cam-partial-ccd-int-sync">12.4.9. N-CAM full image, with internal sync-pulses</h4>
<div class="paragraph">
<p>Identical to n_cam_partial_ccd, with configurable exposure time. As explained in <a href="#sec-cycle-timing">Section 12.3</a>, the exposure time cannot be commanded directly at CCD level but results indirectly from the long-pulse period(cycle-time). In this mode, the input parameters are used to compute the duration of a CCD readout, and that in turn is used to compute the cycle time allowing for the desired exposure time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_cam_partial_int_sync(num_cycles, row_start, row_end, rows_final_dump, ccd_order, ccd_side, exposure_time)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this mode, all sync-pulse are long pulses, i.e. the FEEs can be reconfigured before any readout.</p>
</div>
</div>
<div class="sect3">
<h4 id="_n_fee_reverse_clocking">12.4.10. N-FEE reverse clocking</h4>
<div class="paragraph">
<p>Reverse clocking consists in clocking the CCD transfer voltages so that
the charges are moved away from the readout register and readout
amplifier rather than towards it. It is described in <a href="#reference-documents">RD-07</a>, and exists
in two flavors, depending on the operation of the readout register:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1: serial REV</p>
</li>
<li>
<p>2: serial FWD</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both modes provide a reliable measure of the readout noise, but only the
second one guarantees a reliable measure of the digital offset. In both
cases, the parallel clocks are REV.</p>
</div>
<div class="paragraph">
<p>It can be operated via the following building block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_cam_reverse_clocking(num_cycles, clock_dir_serial, ccd_order, ccd_side)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>clock_dir_serial</code> must be either "FWD" (standard readout,
representative digital offset), or "REV", for reverse clocking in the
serial direction as well.</p>
</div>
</div>
<div class="sect3">
<h4 id="_charge_injection">12.4.11. Charge injection</h4>
<div class="paragraph">
<p>Charge injection is described in <a href="#reference-documents">RD-08</a>. It is envisaged as a means to
reduce the negative effects of an increasing CTI towards EOL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_cam_charge_injection_full(num_cycles, row_start, row_end, rows_final_dump, ccd_order, ccd_side, ci_width, ci_gap)</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>ci_width expresses the number of rows covered by charge-injection in each block</p>
</li>
<li>
<p>ci_gap expresses the number of rows between two blocks of charge-injection.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_synchronization_with_ccd_readouts">12.5. Synchronization with CCD-readouts</h3>
<div id="sec-synchronisation-detector-mgse" class="paragraph">
<p>It may be beneficial to synchronize some commands with the CCD readouts.
For instance small movements of the source on the detector (dithering)
may be fast enough to occur entirely during the CCD readout.
Synchronizing the movements on the readout hence alleviates the need to
lose one image cycle or more to “let things happen”. This can be
achieved with the following approach (e.g. in standard mode)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>from camtest.commanding.dpu import on_long_pulse_do, wait_cycles, n_cam_full_standard

n_cam_full_standard(num_cycles=0, ccd_side=”E”)
for i in range(n_dithers):
    wait_cycles(num_images-1)
    on_long_pulse_do(point_source_to_fov, theta[i], phi[i], wait=False)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first command sets the FEE into an infinite image-acquisition loop,
and returns immediately. In the loop, the wait command “counts” the
right number of cycles (images) before returning. Finally, the command
<code>on_long_pulse_do</code> will wait until the next long synchronisation pulse
and then trigger the embedded command, making sure it starts
simultaneously with the CCD readout.</p>
</div>
<div class="paragraph">
<p>The <code>on_long_pulse_do</code> command will only execute the function passed as
the argument to <code>on_lon_pulse_do</code>. If you want to execute several
commands, or include a delay: use <code>wait_cycles(1)</code> to hold till the system
sees the long pulse. The subsequent commands in your script will be
executed after the long pulse.</p>
</div>
<div class="paragraph">
<p>Notes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>on_long_pulse_do(command)</code> triggers the command on the long pulse, i.e.
it synchronize it with the readout of one particular CCD (the first one
appearing in the parameter <code>ccd_order</code>), not all four.</p>
</li>
<li>
<p>A mechanical movement + its stabilisation may take a significant
amount of time, even for small movements. If this turns out to be longer
than the readout time, it will spill over the next integration time,
which is undesirable. In order to avoid losing a 25 sec cycle for just a
few hundred milliseconds, one can artificially increase the readout
duration thanks to the parameter <code>n_rows_final_dump</code>, available in all
partial readout observing modes (<a href="#standard-building-block-parameters">Section 12.4.2</a>).</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="f-fee-operations">13. Operating the F-FEE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes some basic principles on the F-FEE design and their practical impact on the F-FEE, CCD and camera operations.</p>
</div>
<div class="sect2">
<h3 id="_glossary_2">13.1. Glossary</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Parallel:</strong> direction parallel to the columns of the CCD (sometimes referred to as “vertical”).</p>
</li>
<li>
<p><strong>Serial:</strong> direction parallel to the rows of the CCD (sometimes referred to as “horizontal”).</p>
</li>
<li>
<p><strong>Readout register:</strong> single row of pixels below the active region of the CCD, used to transfer the charges in the serial direction towards the readout amplifier.</p>
</li>
<li>
<p><strong>Partial readout:</strong> describes a CCD readout process in which only a given range of CCD rows are digitized. The rows between the region and the readout register are dumped during the readout process, i.e., the recorded signal is not digitized, it is not transferred to the FEE and will not appear in the data.</p>
</li>
<li>
<p><strong>Windowing:</strong> refers to an FEE operating mode in which a pre-defined collection of windows on the CCDs is transferred to the DPU (during CAM-tests: the EGSE). The entire CCDs are readout and digitized, but only the pre-defined windows are transferred. The windowing mode is not used during alignment nor TVAC Camera testing and will not be discussed in this document.</p>
</li>
<li>
<p><strong>Dumping:</strong> a row during readout means to continuously reset the readout register. The charges transferred from the active region of the CCD are lost. The absence of serial transfer makes it much faster to dump a line (90 µs) than to read it out normally (parallel transfer 110μs + serial transfer ~800μs).</p>
</li>
<li>
<p><strong>Clearout</strong>: dumping all or part of a CCD.</p>
</li>
<li>
<p><strong>E and F</strong>: the Plato CCDs dispose of 2 readout amplifiers. The left and right halves of the CCD are transferred to the corresponding amplifier (they behave almost like independent CCDs). For some reason that thy shall not ask, E and F refer to the right and left halves of a CCD (mnemonic: same order as in “FEE”) respectively.</p>
</li>
<li>
<p><strong>Cycle</strong>: period between two long-synchronisation pulses (see below)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="sec-f-fee-operating-modes">13.2. F-FEE operating modes</h3>
<div class="paragraph">
<p>A complete list of the F-FEE operating modes can be found in <a href="#reference-documents">RD-16</a>. The main modes for camera testing are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ON</strong>: FEE powered on; CCDs powered off. This mode allows transitions to the test-pattern acquisition modes and to the STANDBY mode.</p>
</li>
<li>
<p><strong>STANDBY</strong>: FEE powered on; CCDs powered on. The CCDs are properly biased but not readout, i.e., they are “indefinitely integrating”.</p>
</li>
<li>
<p><strong>FULL_IMAGE</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>allowing for full-CCD acquisition</p>
</li>
<li>
<p>allows for reverse clocking (serial direction only)</p>
</li>
<li>
<p>This is the workhorse for the ground-based tests.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>WINDOWING</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>allowing for the acquisition of multiple windows on the CCDs</p>
</li>
<li>
<p>This mode is the baseline for the in-flight operations.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="fig-ffee-operation-modes" class="imageblock text-center">
<div class="content">
<img src="../images/f-fee-operating-modes.png" alt="f fee operating modes" width="60%">
</div>
<div class="title">Figure 26. FEE Operating modes (RD-16)</div>
</div>
</div>
<div class="sect2">
<h3 id="sec-f-fee-cycle-timing">13.3. Cycle, Timing and Synchronisation</h3>
<div class="paragraph">
<p><strong>CCD</strong> In this section we assume that <code>CCD</code> refers to the half-CCD that is exposed to light.
The 'bottom' half, i.e. the storage area is never discussed.
The term 'half-CCD' here refers to either the F or the E side of (half) a detector, hence physically one fourth CCD, i.e. 2255 x 2255 pixels (+ pre- and over-scans).</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Readout timing:</strong> The AEU sends synchronization pulses to the FEE every 2.5 seconds.
Every pulse triggers a CCD-readout. In windowing mode, the 4 CCDs in one camera are addressed simultaneously, but
on the ground we only use full-image mode. In that mode maximum 2 CCDs can be addressed simultaneously (see below).</p>
</li>
<li>
<p><strong>Cycle time and FEE configuration:</strong> Cycle time is defined as 2.5 seconds. Given that not all CCDs can be read within a cycle, it will require
more to command more than one cycle for each frame to acquire from a given CCD.</p>
</li>
<li>
<p><strong>Exposure time:</strong> the PLATO cameras have no shutter. Consequently, the CCDs integration never stops. In practice, the sync-pulses trigger the readout process, and the exposure time effectively corresponds to the cycle-time minus the frame-transfer time.
Unless otherwise stated, all CCDs are readout at every cycle, even if the data cannot be transferred to the DPU.
Consequently the effective exposure time is fixed to 2.5 seconds minus transfer-time for all CCDs, even if it takes 2 or 4 cycles to acquire the next image of a given CCD.</p>
</li>
<li>
<p><strong>Modifying the exposure time</strong>: is not possible by default. One work-around is to leave some CCDs in STANDBY mode while reading out one or two other detectors. This is the goal of the keyword 'others_standby' provided in the observing mode f_cam_full_ccd</p>
</li>
<li>
<p><strong>F-FEE internal sync-pulses</strong>: are unaccessible to user-commands</p>
</li>
<li>
<p><strong>E and F CCD sides</strong>  <a href="#reference-documents">RD-16</a> designate the E and F sides of the CCD as 'left' and 'right' respectively
when looking from the sky (readout register at the bottom), i.e. the opposite convention as used for the N-CAMs. In order to avoid confusion and simplify the commanding an analysis,
it was decided to take care of that in the EGSE software, so that <strong>the commanding and the data products follow the same convention as for the N-CAMs</strong>,
i.e. F on the left, and E on the right when looking from the sky, assuming the readout register is at the bottom.</p>
</li>
<li>
<p><strong>pre-scans and over-scans</strong> The F-CAMs will have 24 serial pre-scan and 16 serial overscan columns. It will have 15 parallel overscan rows. None of those parameters is commandable.</p>
</li>
<li>
<p><strong>partial readout</strong> is not possible with the F-FEEs</p>
</li>
<li>
<p><strong>CCD clearout</strong> is not possible with the F-FEEs. This is a consequence of the fixed parallel overscan.</p>
</li>
<li>
<p><strong>Charge injection</strong> is not possible with the F-FEEs.</p>
</li>
<li>
<p><strong>Reverse clocking</strong> is only possible in the serial direction.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_commanding_the_f_fees">13.4. Commanding the F-FEEs</h3>
<div class="paragraph">
<p>The following sections describe a collection of building blocks designed
to configure and operate the FEEs and the CCDs.</p>
</div>
<div class="paragraph">
<p>In this section, for the sake of simplicity, the names of the building
blocks directly appear at the python prompt (<code>&gt;&gt;&gt;</code>), but remember that a
commanding building block will exclusively be accepted either within
another building block or function, or (hence generating an observation)
by the execute command (see <a href="#test-execution">Section 4.1</a>).</p>
</div>
<div class="sect3">
<h4 id="sec-f-cam-ccd-and-pixel-references">13.4.1. CCD and pixel references</h4>
<div class="paragraph">
<p><a href="#fig-ccd-numbering-cgse-red">Figure 27</a> and <a href="#fig-ccd-numbering-cgse-blue">Figure 28</a> show the CCD numbering adopted for the commanding.
We will further refer to these coordinate systems as CCDn_PIX n = 1, 2, 3, 4. Note that</p>
</div>
<div class="ulist">
<ul>
<li>
<p>each cover an entire CCD, without interruption at the “border” between E &amp; F (columns 2254 to 2255), and</p>
</li>
<li>
<p>these differ from the CCD coordinate systems adopted in RD-10 (pix [1,1] close to the optical axis),</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>as well as of those adopted at FEE-level (2 coord. systems/CCD, with the x-axes in opposite directions on E &amp; F).</p>
</div>
<div id="_tabs_3" class="openblock tabs is-loading">
<div class="content">
<div class="ulist tablist">
<ul>
<li id="_tabs_3_red" class="tab">
<p>RED</p>
</li>
<li id="_tabs_3_blue" class="tab">
<p>BLUE</p>
</li>
</ul>
</div>
<div id="_tabs_3_red--panel" class="tabpanel" aria-labelledby="_tabs_3_red">
<div id="fig-ccd-numbering-cgse-red" class="imageblock text-center">
<div class="content">
<img src="../images/ccd-numbering-cgse-red.png" alt="ccd numbering cgse red" width="80%">
</div>
<div class="title">Figure 27. CCD numbering and pixel coordinates for the FM red fast camera on every CCD (CCD_PIXn reference frames). The thicker black border lines represent the readout registers, the gray shaded areas are the parts of the CCD that is shielded off against incoming light.</div>
</div>
</div>
<div id="_tabs_3_blue--panel" class="tabpanel" aria-labelledby="_tabs_3_blue">
<div id="fig-ccd-numbering-cgse-blue" class="imageblock text-center">
<div class="content">
<img src="../images/ccd-numbering-cgse-blue.png" alt="ccd numbering cgse blue" width="80%">
</div>
<div class="title">Figure 28. CCD numbering and pixel coordinates for the FM blue fast camera on every CCD (CCD_PIXn reference frames). The thicker black border lines represent the readout registers, the gray shaded areas are the parts of the CCD that is shielded off against incoming light.</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="f-fee-standard-building-block-parameters">13.4.2. Standard building block parameters</h4>
<div class="paragraph">
<p>Some of the input parameters are common to several building blocks. We
list some below, to avoid repeating them for every building block.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>num_cycles</strong></p>
<div class="ulist">
<ul>
<li>
<p>num_cycles = 0 sets the FEEs in the required configuration until commanded otherwise</p>
</li>
<li>
<p>num_cycles &gt; 0 indicates a finite number of cycles after which the N-FEE will automatically be (re)set to dump mode (see dump_mode below).
Since not all CCDs are recorded every cycle, contrary to the N-CAMs, num_cycles does not always correspond to the number of frames acquired on each requested detector. See the descritpion of the observing modes for more details.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>ccd_order</strong></p>
<div class="ulist">
<ul>
<li>
<p>During nominal operations, the four CCDs are addressed simultaneously, every cycle. This is not possible in FULL-IMAGE-MODE though.
This parameter allows to specify the detectors to readout (when applicable).</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>ccd_side</strong></p>
<div class="ulist">
<ul>
<li>
<p>This parameter indicates which side(s) of the CCD will be recorded.
With the readout register at the bottom, the E-side is the right half and
the F-side is the left half.</p>
</li>
<li>
<p>This parameter accepts the following values:</p>
<div class="ulist">
<ul>
<li>
<p>“E”, “F”, or “BOTH”</p>
</li>
<li>
<p>“BOTH” means both E and F sides are recorded every cycle. While
standard in windowing mode, this is not possible in full-image mode when
the camera is connected to an actual DPU, e.g. at integrated system
level (spacecraft). Since it doubles the required bandpass and since some EGSE have shown problems
to cope with high datarates during the N-CAM testing, it shall be used with caution but remains a possibility
to speed up full-CCD image acquisition if needed due to scheduling constraints.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_f_fee_mode_transitions">13.4.3. F-FEE mode transitions</h4>
<div class="paragraph">
<p>Two F-FEE-specific building blocks currently exist to put them into
specific operational “modes”:</p>
</div>
<div class="paragraph">
<p><strong>ON mode</strong> (<a href="#sec-f-fee-operating-modes">Section 13.2</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; f_fee_to_on_mode() -- building block
&gt;&gt;&gt; f_fee_is_on_mode() -- function</code></pre>
</div>
</div>
<div class="paragraph">
<p>NB: ON mode is the default mode after FEE switch on, but this building
block cannot be used to power on the FEE. That is handled by the AEU
(<a href="#aeu-operations">Chapter 11</a>).</p>
</div>
<div class="paragraph">
<p><strong>STANDBY mode</strong> (<a href="#sec-f-fee-operating-modes">Section 13.2</a>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; f_fee_to_standby_mode() -- building block
&gt;&gt;&gt; f_fee_is_standby_mode() -- function</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="f-fee-dump-mode">13.4.4. DUMP mode</h4>
<div class="paragraph">
<p>DUMP is not a genuine FEE operation mode. Given that the dump-gate cannot be commanded on the F-CAMs, we defined
DUMP mode as it as a full-image mode where the data are just not recorded. That means that the readout cycle or the thermal
behaviour of the camera are not affected, we just stop recording the data.
That is a convenient way to avoid saturation between tests that would occur in STANDBY mode.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; f_fee_to_dump_mode() – building block
&gt;&gt;&gt; f_fee_is_dump_mode() – function</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_cam_full_image_standard">13.4.5. F-CAM full-image, standard</h4>
<div class="paragraph">
<p>This is the baseline mode for F-CAM FULL-IMAGE-MODE acquisition.</p>
</div>
<div class="paragraph">
<p>The parameters are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>num_cycles</strong>: duration of the image acquisition. Each cycle is 2.5 seconds long.</p>
</li>
<li>
<p><strong>ccd_side</strong>: 'E', 'F' or 'BOTH'. This parameter has no impact on the test duration</p>
</li>
<li>
<p><strong>fast</strong>: controls if one or two CCDs are acquired every cycle</p>
<div class="ulist">
<ul>
<li>
<p>Fast = True:</p>
<div class="ulist">
<ul>
<li>
<p>CCDs 1 and 3 are acquired simultaneously, alternating with CCDs 2 and 4</p>
</li>
<li>
<p>num_cycles must be a multiple of 2</p>
</li>
<li>
<p>the test results in num_cycles / 2 images for every detector (or half-detector, depending on ccd_side)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Fast = False:</p>
<div class="ulist">
<ul>
<li>
<p>the CCDs are acquired in sequence, 1, 2, 3, 4.</p>
</li>
<li>
<p>num_cycles must be a multiple of 4</p>
</li>
<li>
<p>the test results in num_cycles / 4 images for every detector (or half-detector, depending on ccd_side)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; f_cam_full_standard(num_cycles, ccd_side, fast)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_cam_full_ccd">13.4.6. F-CAM full CCD</h4>
<div class="paragraph">
<p>Identical to f_cam_full_standard, but allows for more flexibility on the configuration of individual detectors.</p>
</div>
<div class="paragraph">
<p>The parameters are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>num_cycles</strong>: duration of the image acquisition. Each cycle is 2.5 seconds long.</p>
</li>
<li>
<p><strong>ccd</strong>: detector selection. Integer number in [1, 2, 3, 4], equivalent to ccd_order=[ccd, ccd, ccd, ccd] in the N-CAMs</p>
</li>
<li>
<p><strong>ccd_side</strong>: 'E', 'F' or 'BOTH'. This parameter has no impact on the test duration</p>
</li>
<li>
<p><strong>others_standby</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>others_standby = False: the other CCDs are readout normally, but not recorded, i.e. they are in the F-FEE equivalent
of DUMP mode.</p>
</li>
<li>
<p>others_standby = True: the other CCDs are in STANDBY mode, i.e. not readout and accumulating charges as long as this command lasts.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; f_cam_full_ccd(num_cycles, ccd, ccd_side, others_standby)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_f_fee_reverse_clocking">13.4.7. F-FEE reverse clocking</h4>
<div class="paragraph">
<p>Reverse clocking consists in clocking the CCD transfer voltages so that
the charges are moved away from the readout register and readout
amplifier rather than towards it.</p>
</div>
<div class="paragraph">
<p>With the F-FEEs, it is not possible to configure the F-FEE to operate reverse clocking in the parallel direction. It is
only possible in the serial direction.</p>
</div>
<div class="paragraph">
<p>This mode should provide access to estimates of the offset and readout noise.</p>
</div>
<div class="paragraph">
<p>It can be operated via the following building block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; n_cam_reverse_clocking(num_cycles, ccd, ccd_side)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_synchronization_with_ccd_readouts_2">13.5. Synchronization with CCD-readouts</h3>
<div class="paragraph">
<p>To synchronize some commands with the CCD readouts, please refer to <a href="#sec-synchronisation-detector-mgse">[sec-synchronisation-detector-mgse]</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_operating_the_tcs_egse">14. Operating the TCS EGSE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TCS EGSE is providing monitoring and control of the TRP1 and TRP22
temperatures on the camera (TOU and FEE).</p>
</div>
<div class="paragraph">
<p>TRP (Thermal Reference Points) that are monitored:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TRP1 (3 sensors, 1nominal/1redundant heater): the TRP controlling the
overall TOU temperature, used for thermal focusing</p>
</li>
<li>
<p>TRP 22 (1 sensor, 1 nominal / 1 redundant heater): the survival heater
on the FEE. This is not used when the FEE is on, it is only used to
bring the FEE to its operational temperature if it is too cold to be
switched on.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The TCS EGSE has different operating modes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Normal</strong> operating mode of the camera: all the temperatures are
acquired and nominally only the TRP1 heater is controlled but TRP22
heater could be added (change of configuration in configuration mode
required)</p>
</li>
<li>
<p><strong>Safe</strong> operating mode: all the temperatures are acquired and TRP1
heater is controlled as well as FEE heater</p>
</li>
<li>
<p><strong>Decontamination</strong> mode or de-icing mode: all the temperatures are
acquired and nominally only TRP1 heater is controlled but TRP22 heater
could be added (change of configuration in configuration mode required)</p>
</li>
<li>
<p>Camera <strong>calibration</strong> mode: only thermistor reading is performed and
heaters are not activated</p>
</li>
<li>
<p><strong>EMC</strong> mode: replay of a heater control sequence, sensor used only for
monitoring and switch off in case of temperature limit is exceeded</p>
</li>
<li>
<p><strong>Extended</strong> mode: all parameters are fully configurable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The TCS EGSE is changing the TRP1 heater power with PWM (Pulse Width
Modulation): the current is varied by changing the width of square
full-power pulses. The width of the pulses can only be changed at the
time of an AEU clk_heater sync pulse, between CCD readouts.</p>
</div>
<div class="paragraph">
<p>The PWM pulses come at frequencies between 30 and 50 Hz - this frequency
is configurable.</p>
</div>
<div class="paragraph">
<p>Clk_heater sync pulse, to avoid switching the power during a CCD
readout. The TCS EGSE is updating the heater power within 200ms after
the leading edge (up-stroke) of the Clk_heater pulse.</p>
</div>
<div class="paragraph">
<p>The TCS EGSE can be operated in a <em>local</em> mode using the
man-machine-interface (MMI). During camera tests, for monitoring and
commanding the TCS EGSE shall be in <em>Remote Control</em> mode.</p>
</div>
<div class="sect2">
<h3 id="_switching_between_operating_modes">14.1. Switching between operating modes</h3>
<div class="paragraph">
<p>Switching between modes is done with just one command,
set_operating_mode. The command takes one parameter that defines the
mode.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>normal</p>
</li>
<li>
<p>safe</p>
</li>
<li>
<p>decontamination|de-icing</p>
</li>
<li>
<p>calibration</p>
</li>
<li>
<p>EMC</p>
</li>
<li>
<p>self-test</p>
</li>
<li>
<p>extended</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can use either the number or the name of the mode as the argument,
but it is preferred to use the constants defined in the egse.tcs module.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; from egse.tcs import OperatingMode

&gt;&gt;&gt; tcs.set_operating_mode(OperatingMode.NORMAL)
&gt;&gt;&gt; tcs.set_operating_mode(OperatingMode.SAFE)
&gt;&gt;&gt; tcs.set_operating_mode(OperatingMode.DECONTAMINATION)
&gt;&gt;&gt; tcs.set_operating_mode(OperatingMode.CALIBRATION)
&gt;&gt;&gt; tcs.set_operating_mode(OperatingMode.EMC)
&gt;&gt;&gt; tcs.set_operating_mode(OperatingMode.SELF_TEST)
&gt;&gt;&gt; tcs.set_operating_mode(OperatingMode.EXTENDED)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The mode that will be used most during camera testing is the <em>extended</em>
mode, which allows all parameters to be configurable.</p>
</div>
<div class="sect3">
<h4 id="_decontamination">14.1.1. Decontamination</h4>
<div class="paragraph">
<p>The Decontamination heating is performed by turning ON the TRP1 heaters
at full power.</p>
</div>
</div>
<div class="sect3">
<h4 id="_replay">14.1.2. Replay</h4>

</div>
</div>
<div class="sect2">
<h3 id="_remote_commanding">14.2. Remote Commanding</h3>
<div class="paragraph">
<p>The TCS EGSE has a set of commands at your disposal for remote
commanding the device. These commands can only be used in <em>Remote
Control</em> mode, i.e., when the button shows orange in the MMI. We can
categorise these commands as follows:</p>
</div>
<div class="paragraph">
<p><strong>Change the operating mode</strong>: as seen above, the command for changing the
operating mode is <code>tcs.set_operating_mode(&#8230;&#8203;)</code> which takes one parameters
that defines the mode.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; tcs.set_operation_mode(OperatingMode.EXTENDED)</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Set configuration parameter</strong>: to change configuration parameters, use
the command <code>tcs.set_parameter(&#8230;&#8203;)</code> which takes two arguments, the
parameter name and its value. The following command changes the
temperature set point for the PI controller on channel 1 to -40ºC.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; tcs.set_parameter("ch1_tset", -40)</code></pre>
</div>
</div>
<div class="paragraph">
<p>A full list of parameters that can be configured is available in table
6.8 on page 61-68 of <a href="#reference-documents">RD-09</a>.</p>
</div>
<div class="paragraph">
<p>Please note that several parameters can form a group, e.g., to configure
the PI controller for a certain channel. In this case the best approach
is to set all the parameters needed for that configuration and switch to
the proper mode, i.e., closed loop or open loop.</p>
</div>
<div class="paragraph">
<p>After your configuration is finished, the parameter set needs to be
committed on the device. This is done by sending a tcs.commit() command.</p>
</div>
<div class="paragraph">
<p><strong>Run the task</strong>: When you have properly configured the TCS EGSE, you need
to run the task. This is needed to drive the controllers for the heaters
and to execute the PID controller to reach and maintain the intended
temperatures.</p>
</div>
<div class="paragraph">
<p>A task is run with the <code>tcs.run_task()</code> command and stopped with
<code>tcs.stop_task()</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Only when a task is running, the housekeeping
parameters will be updated continuously.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Retrieve Information</strong>: several commands are available to retrieve
information from the TCS EGSE.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>get_data()</code>: this command works in both local mode and remote-control
mode. It retrieves telemetry from the TCS EGSE. When a task is running,
the full housekeeping is available through this command, if no task is
running, only load time and system resources are available.</p>
</li>
<li>
<p><code>get_housekeeping_value(&lt;parameter name&gt;)</code>: a list of all housekeeping
parameters is available in table 6.6 on page 50-58 of <a href="#reference-documents">RD-09</a>.</p>
</li>
<li>
<p><code>get_all_housekeeping()</code>: this command only work in remote-control mode
and retrieves all the housekeeping values from the TCS EGSE. Note
however, that, when no task is running, the housekeeping will be
outdated. To follow up-to-date telemetry with this command, make sure
the task is running.</p>
</li>
<li>
<p><code>get_error()</code>: this command returns any error that occurred and showed
up in the MMI display. Note that there is no way to clear the errors, so
the output of this command can be outdated also.</p>
</li>
<li>
<p><code>get_configuration()</code>: this command retrieves the full set of
configuration parameters with their current value.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/tcs-gui.png" alt="tcs gui">
</div>
<div class="title">Figure 29. The TCS EGSE Viewer gives an overview of the TCS Housekeeping parameters with their latest engineering values. There are two TABs (1) the Configuration tab which shows the current configuration parameters and their values, and (2) the Housekeeping tab which updates every 10s with the latest housekeeping parameters.</div>
</div>
<div class="paragraph">
<p><strong>Convenience Functions</strong>: two convenience functions are available to show
information in a nice colour table. If you need a quick overview of the
configuration or the housekeeping in the REPL or in a Jupyter Notebook,
use the following functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&gt;&gt;&gt; from egse.tcs.tcs import print_all_housekeeping
&gt;&gt;&gt; from egse.tcs.tcs import print_configuration

&gt;&gt;&gt; print_all_housekeeping()
&gt;&gt;&gt; print_configuration()</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_tcs_data_acquisition_system_das">14.3. The TCS Data Acquisition System —DAS</h3>
<div class="paragraph">
<p>Monitoring TCS EGSE telemetry can best be done with the TCS data
acquisition das. The das command is used from the terminal as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ das tcs --interval 10</pre>
</div>
</div>
<div class="paragraph">
<p>The above command will retrieve TCS housekeeping telemetry every 10
seconds. The data is sent to the Storage Manager that saves the
telemetry in a CSV file on the egse-server. The <code>das</code> also makes the
temperatures of the TOU, FEE, and the ambient and internal temperatures
available for Prometheus to be monitored by Grafana.</p>
</div>
<div class="paragraph">
<p>Please note that this command should preferably run on the egse-server
and be started by the site-operator (see <a href="#user-profiles">Section 1.3</a>). The test-operator can inspect the metrics from the TCS EGSE data acquisition in the Grafana display.</p>
</div>
</div>
<div class="sect2">
<h3 id="_setting_the_temperature_setpoints">14.4. Setting the temperature setpoints</h3>
<div class="paragraph">
<p>TBW</p>
</div>
</div>
<div class="sect2">
<h3 id="_enabling_disabling_temperature_control">14.5. Enabling / disabling temperature control</h3>
<div class="paragraph">
<p>TBW</p>
</div>
</div>
<div class="sect2">
<h3 id="_temperature_sensor_configuration">14.6. Temperature sensor configuration</h3>
<div class="paragraph">
<p>TBW</p>
</div>
<div class="sect3">
<h4 id="_disabling_trp1_sensors_to_verify_redundancy_function">14.6.1. Disabling TRP1 sensors to verify redundancy function</h4>

</div>
<div class="sect3">
<h4 id="_switching_from_trp1_mean_to_median">14.6.2. Switching from TRP1 mean to median</h4>

</div>
</div>
<div class="sect2">
<h3 id="_changing_temperature_sensor_calibration_curves">14.7. Changing temperature sensor calibration curves</h3>
<div class="paragraph">
<p>TBW</p>
</div>
</div>
<div class="sect2">
<h3 id="_changing_pi_control_parameters">14.8. Changing PI control parameters</h3>
<div class="paragraph">
<p>TBW</p>
</div>
</div>
<div class="sect2">
<h3 id="_changing_the_pwm_frequency">14.9. Changing the PWM frequency</h3>
<div class="paragraph">
<p>TBW</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_operating_the_teb_shroud_and_mari_thermal_control">15. Operating the TEB, shroud and MARI thermal control</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_context">15.1. Context</h3>
<div class="paragraph">
<p>The test houses implement the temperature control of 6 Temperature
Reference points (TRP) of temperature interfaces to the camera: three
temperatures of the Thermal Environment Box (TEB): the TEB_SKY, a shroud
offering a cold radiative cooling sink to the TOU baffle, an upper
segment TEB_TOU, offering the radiative environment seen by the TOU tube
(covered in MLI) above the optical bench on the spacecraft, a lower
segment TEB_FEE offering the radiative environment in the optical bench
cavity seen by the FEE onboard the spacecraft, and the mounting points
of the 3 TOU bipods on the manipulation ring (TRP2,3,4) which are
representing the conductive interface of the optical bench as seen by
the TOU bipods on the spacecraft.</p>
</div>
<div class="paragraph">
<p>All six TRPs are controlled independently, and we can check and change
the temperature setpoints, and switch the control on / off for each TRP.</p>
</div>
<div id="fig-test-setup-ias" class="imageblock">
<div class="content">
<img src="../images/test-setup-ias.png" alt="test setup ias">
</div>
<div class="title">Figure 30. Test setup at IAS, with TEB_SKY, TEB_FEE, TEB_TOU and MaRi indicated</div>
</div>
</div>
<div class="sect2">
<h3 id="_checking_and_setting_the_temperature_setpoints">15.2. Checking and setting the temperature setpoints</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Heater patches at the bottom of the MaRi for control of TRP 2, 3,4 (left) and corresponding temperature sensors on the top, right next to the interface holes for the TOU bipods (right)</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Heater patches</th>
<th class="tableblock halign-left valign-top">Temperature Sensors</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="../images/heater-patches-mari-1.png" alt="heater patches mari 1"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="../images/heater-patches-mari-2.png" alt="heater patches mari 2"></span></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Changing the setpoints:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; execute(tgse.set_temp_setpoint(trp=tgse.TRP.TEB_SKY, temperature=&lt;temperatureCelsius&gt;))
&gt;&gt;&gt; execute(tgse.set_temp_setpoint(trp=tgse.TRP.TEB_TOU, temperature=&lt;temperatureCelsius&gt;))
&gt;&gt;&gt; execute(tgse.set_temp_setpoint(trp=tgse.TRP.TEB_FEE, temperature=&lt;temperatureCelsius&gt;))
&gt;&gt;&gt; execute(tgse.set_temp_setpoint(trp=tgse.TRP.TRP2, temperature=&lt;temperatureCelsius&gt;))
&gt;&gt;&gt; execute(tgse.set_temp_setpoint(trp=tgse.TRP.TRP3, temperature=&lt;temperatureCelsius&gt;))
&gt;&gt;&gt; execute(tgse.set_temp_setpoint(trp=tgse.TRP.TRP4, temperature=&lt;temperatureCelsius&gt;))
&gt;&gt;&gt; execute(tgse.set_temp_setpoint(trp=tgse.TRP.TRP234, temperature=&lt;temperatureCelsius&gt;))</pre>
</div>
</div>
<div class="paragraph">
<p>The effect of the last command (changing TRP234) is the same as setting TRP2, 3, 4 to the same setpoint.</p>
</div>
<div class="paragraph">
<p>Checking the setpoints:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; setpoint = tgse.get_temp_setpoint(trp=tgse.TRP.TEB_SKY)
&gt;&gt;&gt; setpoint = tgse.get_temp_setpoint(trp=tgse.TRP.TEB_TOU)
&gt;&gt;&gt; setpoint = tgse.get_temp_setpoint(trp=tgse.TRP.TEB_FEE)
&gt;&gt;&gt; setpoint = tgse.get_temp_setpoint(trp=tgse.TRP.TRP2)
&gt;&gt;&gt; setpoint = tgse.get_temp_setpoint(trp=tgse.TRP.TRP3)
&gt;&gt;&gt; setpoint = tgse.get_temp_setpoint(trp=tgse.TRP.TRP4)</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_starting_stopping_the_temperature_control_loop">15.3. Starting / stopping the temperature control loop</h3>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; execute(tgse.start_control(trp=tgse.TRP.TEB_SKY))
&gt;&gt;&gt; execute(tgse.start_control(trp=tgse.TRP.TEB_TOU)
...
&gt;&gt;&gt; execute(tgse.stop_control(trp=tgse.TRP.TEB_SKY))
&gt;&gt;&gt; execute(tgse.stop_control(trp=tgse.TRP.TEB_TOU)
...</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_operating_the_ogse">16. Operating the OGSE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The OGSE (optical Ground Support Equipment) consists of a collimator
with a pattern mask in the focus. This pattern mask is illuminated by a
fiber. The fiber is fed with a laser-driven light source that produces a
flat spectrum. Between the light source and the collimator, there is a
control box that has:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Two filter wheels with neutral density filters, allowing to attenuate
the light injected into the collimator to the different flux levels
required</p>
</li>
<li>
<p>A slow asynchronous shutter (not implemented at all test-houses)</p>
</li>
<li>
<p>A fast shutter that is synchronised to the AEU synchronisation signal
(not implemented at all test-houses)</p>
</li>
<li>
<p>A power meter monitoring the light intensity from the light source
(power meter channel 1)</p>
</li>
<li>
<p>A power meter monitoring the light injected into the collimator (power
meter channel 2)</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_switching_entire_ogse_on">16.1. Switching entire OGSE on</h3>
<div class="paragraph">
<p><strong>Utility building block</strong></p>
</div>
<div class="paragraph">
<p>The OGSE can be switched on with one simple command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; execute(ogse.ogse_swon)</pre>
</div>
</div>
<div class="paragraph">
<p>or the command <code>ogse.ogse_swon()</code> can be used in a test script.</p>
</div>
<div class="paragraph">
<p><strong>Effect</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Switches on the OGSE controllers</p>
</li>
<li>
<p>Closes the shutter (if present)</p>
</li>
<li>
<p>Puts the filter wheels in a position with 100% attenuation (blank position)</p>
</li>
<li>
<p>Switches on the power meter</p>
</li>
<li>
<p>Switches on the light source.</p>
</li>
<li>
<p>OGSE telemetry is recording.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the light source needs warming up and stabilisation; the OGSE start up script does not wait for that.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_switching_entire_ogse_off">16.2. Switching entire OGSE off</h3>
<div class="paragraph">
<p><strong>Utility building block</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; execute(ogse.ogse_swoff)</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Effect</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Switches off the power meter</p>
</li>
<li>
<p>Switches off the light source.</p>
</li>
<li>
<p>Switches off the OGSE controllers</p>
</li>
<li>
<p>OGSE telemetry is recording.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_attenuation_with_neutral_density_filters">16.3. Attenuation with Neutral density filters</h3>
<div class="paragraph">
<p>The attenuation is set by a double filter wheel where specific combinations of the wheel positions define a predefined attenuation. The following commands can be used to set the attenuation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; ogse.att_level_up()</pre>
</div>
</div>
<div class="paragraph">
<p>Effect: changes filter wheel combination one attenuation step higher.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; ogse.att_level_down()</pre>
</div>
</div>
<div class="paragraph">
<p>Effect: changes filter wheel combination one attenuation step lower.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; ogse.set_fwc_fraction(&lt;attenuation factor&gt;)</pre>
</div>
</div>
<div class="paragraph">
<p>Effect: will choose combination of ND filters that matches commanded
factor of the full-well capacity as close as possible.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Attenuation examples</div>
<div class="ulist">
<ul>
<li>
<p>Attenuation factor 1.00 : both filter wheels are in the position with no Neutral density filter, no attenuation.</p>
</li>
<li>
<p>Attenuation factor 0.01: filter wheels are in a combination of Neutral density filters delivering approximately 99% attenuation - the signal will be 100 times smaller than with no attenuation.</p>
</li>
<li>
<p>Attenuation factor 0 will put a filter wheel in the opaque plate position.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; ogse.set_fw_position((&lt;wheel_a_pos&gt;, &lt;wheel_b_pos&gt;))</pre>
</div>
</div>
<div class="paragraph">
<p>Effect: choose manual ND filters in the two wheels, note the argument is a tuple.</p>
</div>
<div class="paragraph">
<p>You can also read this back through the housekeeping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; get_housekeeping("GOGSE_ATT_LVL")</pre>
</div>
</div>
<div class="paragraph">
<p>Returns the actual attenuation factor realised with the ND filter combination</p>
</div>
<div class="paragraph">
<p>The CSL ambient alignment collimator provides the following attenuation factors:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../images/attenuation-factors.png" alt="attenuation factors" width="60%">
</div>
<div class="title">Figure 31. CSL ambient alignment collimator attenuation factors (from )</div>
</div>
</div>
<div class="sect2">
<h3 id="_attenuation_specifying_the_full_well_fraction">16.4. Attenuation specifying the full well fraction</h3>
<div class="paragraph">
<p>For every facility, a calibration will be done to relate the attenuation
factor (0&#8230;&#8203;1) to the fraction of the full well that will be filled in a
nominal (25sec) integration near the center of the field.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; ogse.set_fwc_fraction(0.5)</pre>
</div>
</div>
<div class="paragraph">
<p>Will set the OGSE attenuation factor that results in the brightest pixel
in the PSF near the center of the field to be about 50% of the full well
(which is roughly <code>1E6</code> for PLATO CCDs)</p>
</div>
</div>
<div class="sect2">
<h3 id="_switching_onoff_light_intensity_stabilisation_loop">16.5. Switching on/off light intensity stabilisation loop</h3>
<div class="paragraph">
<p>Only implemented at IAS (TBD)</p>
</div>
<div class="paragraph">
<p>The N-camera reads out a different CCD every 6.25 seconds. You want to
synchronise the shutter open to the start of the new integration on the
CCD you are interested in (where the collimator image is seen). Setting
the exposure time allows to avoid exposing the CCD during readout
(avoiding e.g. smearing) and/or attenuate the light source in finer
steps than allowed by the neutral density filter wheels.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; ogse.shutter_startloop(&lt;ccd number to synchronise to&gt;, &lt;exposure time&gt;)
&gt;&gt;&gt; ogse.shutter_stoploop()</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_power_meter">16.6. Power meter</h3>
<div class="paragraph">
<p>The readings of the power meters are store in OGSE housekeeping
telemetry.</p>
</div>
<div class="paragraph">
<p>If you need access to the power, read the housekeeping parameters
GOGSE_PM_CH1_PWR (light source monitor) or GOGSE_PM_CH2_PWR (light
injected into the collimator)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
CSL collimator power meter 2 will only provide readings between
attenuation levels 2E-3 and 1.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_ogse_housekeeping_parameters">16.7. OGSE housekeeping parameters</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 31%;">
<col style="width: 15%;">
<col style="width: 12%;">
<col style="width: 12%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Grafana screen</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">unit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_LDLS_INTERLOCK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Laser Driven Light Source Power Interlock on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_LDLS_POWER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Laser Driven Light Source power on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_LDLS_LAMP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Laser Driven Light Source lamp on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_LDLS_LASER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Laser Driven Light Source laser on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_LDLS_LAMP_FAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Laser Driven Light Source lamp fault</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_LDLS_CTRL_FAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Laser Driven Light Source controller fault</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_LDLS_PSU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Power Supply Unit on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_LDLS_OPERATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Laser Driven Light Source operate status on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_PM_CH1_PWR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Power meter channel 1 power</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uint16</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_PM_CH1_TEMP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Power meter channel 1 temperature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uint16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DegCelsius</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_PM_CH1_STATUS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Power meter channel 1 on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_PM_CH2_PWR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Power meter channel 2 power</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uint16</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_PM_CH2_TEMP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Power meter channel 2 temperature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uint16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DegCelsius</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_PM_CH2_STATUS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Power meter channel 2 on</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bool</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_ATT_LVL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attenuation factor (0..1)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uint16</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_ATT_FWELL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attenuation factor (approximate fraction of Full well)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GOGSE_MON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uint16</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_operating_the_tests_system_states">17. Operating the tests, system states</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We distinguish between two different entities, corresponding to
different timescales for the tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Test phase : consists in one or several days or uninterrupted tests,
i.e. without switch off (intentional or not).</p>
</li>
<li>
<p>Test : the execution of a single test-script.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We also define the following “system states”:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>INITITALIZED: all subsystems in the test environment and test article
(hereafter the ‘system’) are switched on, set to predefined conditions
and ready to accept commands.</p>
<div class="ulist">
<ul>
<li>
<p>FEEs in “STANDBY” (CCDs powered).</p>
</li>
<li>
<p>OGSE shutter closed</p>
</li>
<li>
<p>No requirement on the OGSE filters (attenuation level unknown).</p>
</li>
<li>
<p>AEU : switched on and syncing</p>
</li>
<li>
<p>TCS: powered on, no task running, configured in remote operational
mode, i.e. accepting commands.</p>
</li>
<li>
<p>MGSE mechanisms: controllers on, mechanisms homed if relevant, ready
to accept commands</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is the initial state at the start of a test-phase.</p>
</div>
</li>
<li>
<p>IDLE: All subsystems are in nominal conditions, as for INITIALIZED,
but the FEEs are in “DUMP_MODE” (full_image mode, nominal clocking, dump
gate high), preventing the accumulation of charges between tests.</p>
<div class="paragraph">
<p>This state is indeed aimed to serve an “inter-test-known-condition”.</p>
</div>
</li>
<li>
<p>SAFE: as INITIALIZED, with the FEEs in “ON_MODE” (CCDs not powered)</p>
</li>
<li>
<p>RUNNING: test running.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A standard test procedure will describe all steps to be followed at the
start of a test phase, to bring the system from “switched off” to
INITIALIZED. It mainly consists in three blocks</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Power on all subsystems (manual hardware switch on)</p>
</li>
<li>
<p>Switch on the EGSE components, launch the GUIs and commanding prompt
(software switch on)</p>
</li>
<li>
<p>Bring the system to the INITIALIZED state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A dedicated commanding script is provided to operate this latter
step:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; system_to_initialized()</pre>
</div>
</div>
<div class="paragraph">
<p>You can test if the system is in this state with</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; system_test_if_initialized()</pre>
</div>
</div>
<div class="paragraph">
<p>This function will abort if the system is not in INITIALIZED state, and
do nothing otherwise.</p>
</div>
<div class="paragraph">
<p>As said above, by convention, every test script should be able to assume
that the system is in IDLE state before it starts, and it should return
into that state before ending. A dedicated commanding script is
provided to this aim as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; system_to_idle()</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, it shall be possible at any moment to test if the system is in
IDLE mode. The command therefore is</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; system_test_if_idle()</pre>
</div>
</div>
<div class="paragraph">
<p>This function will abort if the system is not in IDLE state, and do
nothing otherwise.</p>
</div>
<div class="paragraph">
<p>The test procedure should explicitly bring back the system to IDLE after
every test, but whenever possible, it is nevertheless recommended to
start every test with a check via <code>system_test_if_idle</code>, and call
<code>system_to_idle</code> as a last command, to return the system to that known
state.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendices">18. Appendices</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="app-a-ex-ccd-acquisition">Appendix A: Examples of CCD acquisition timing sequence</h3>
<div class="paragraph">
<p><strong>Commanding:</strong> To keep notations light, the building blocks in the examples below are presented directly at the python prompt, but in operations they will be refused outside of either another function or building-block, or (if they by themselves constitute the entire test) an execute() command (see <a href="#test-execution">Section 4.1</a>).</p>
</div>
<div class="paragraph">
<p><strong>Timing:</strong> In all cases, our time reference starts at the pulse triggering</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>the commanded configuration</p>
</li>
<li>
<p>the readout of CCD 1 (integrating previously, but readout under the new configuration)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In most cases, as long as the cycle-time and the ccd_order remain unchanged by the configuration occurring at t = 0, the images read out during the first cycle can probably be used directly since, e.g. the just commanded partial readout would be applied. This must be assessed on a case-by-case basis. It will make a difference of one cycle wrt the first moment where a representative set of images corresponding to the new configuration has been recorded. This explains why an apparently redundant cycle is represented in all examples below.</p>
</div>
<div class="sect3">
<h4 id="ex-4-ccd-both">18.A.1. 4 CCDs nominal cycle time, acquiring E &amp; F sides simultaneously (full-image or windowing mode)</h4>
<div class="paragraph">
<p>Examples of building block parametrisation to achieve this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; n_cam_full_standard(num_cycles=0, ccd_side=”BOTH”)
&gt;&gt;&gt; n_cam_full_ccd (num_cycles=0, ccd_order=[1,2,3,4], ccd_side=”BOTH”, rows_overscan=0)</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">start readout CCD1: 0.00 long pulse, FEE config, start cycle 1, readout E &amp; F-sides of previously ongoing exposures
start integr. CCD1: 4.00
start readout CCD2: 6.25 short pulse
start integr. CCD2: 10.25
start readout CCD3: 12.50 short pulse
start integr. CCD3: 16.50
start readout CCD4: 18.75 short pulse
start integr. CCD4: 22.75
start readout CCD1: 25.00 long pulse, start cycle 2, readout *E &amp; F-sides*
start integr. CCD1: 29.00
start readout CCD2: 31.25
start integr. CCD2: 35.25
start readout CCD3: 37.50
start integr. CCD3: 41.50
start readout CCD4: 43.75
start integr. CCD4: 47.75
start readout CCD1: 50.00 long pulse, start cycle 3
start integr. CCD1: 54.00</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_partial_readout_external_sync_single_side_full_image_mode">18.A.2. Partial readout, external sync, single side (full-image mode)</h4>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&gt;&gt;&gt; n_cam_partial_ccd (num_cycles=0, row_start=500, row_end=1000, rows_final_dump=4510, ccd_order=[1,1,1,1], ccd_side=”E”)</pre>
</div>
</div>
<div class="paragraph">
<p>For the same of simplicity, the timing below assumes the readout &amp; clearout take exactly one second in total.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>start readout CCD1_E: 0.00 long pulse, FEE config, start cycle 1
start integr. CCD1: 1.00
start readout CCD1_E: 6.25 short pulse
start integr. CCD1: 7.25
start readout CCD1_E: 12.50 short pulse
start integr. CCD1: 13.50
start readout CCD1_E: 18.75 short pulse
start integr. CCD1: 19.75
start readout CCD1_E: 25.00 long pulse, FEE config, start cycle 2
start integr. CCD1: 26.00</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_partial_readout_internal_sync_single_side_full_image_mode">18.A.3. Partial readout, internal sync, single side (full-image mode)</h4>
<div class="listingblock">
<div class="content">
<pre class="nowrap">&gt;&gt;&gt; n_cam_partial_ccd_int_sync (num_cycles=0, row_start=500, row_end=1000, rows_final_dump=4510, ccd_order=[1,1,1,1], ccd_side=”E”, exposure_time=3)</pre>
</div>
</div>
<div class="paragraph">
<p>For the same of simplicity, the timing below assumes the readout &amp; clearout take exactly one second in total. In fact they are estimated from row_start, row_end and rows_final_dump, and the cycle time is then commanded to (readout_time + exposure_time)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">start readout CCD1_E: 0.00 long pulse, FEE config, start cycle 1
start integr. CCD1_E: 1.00
start readout CCD1_E: 4.00 long pulse, start cycle 2
start integr. CCD1_E: 5.00
start readout CCD1_E: 8.00 long pulse, start cycle 3
start integr. CCD1_E: 9.00</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="app-b-fov">Appendix B: Field of view representation with visited positions in CSL</h3>
<div class="paragraph">
<p>Starting a GUI on the operator screen showing the FOV:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ visited_positions_ui</pre>
</div>
</div>
<div class="paragraph">
<p>Then you can add the visited locations as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in focal-plane coordinates (x_fp, y_fp) [mm]:</p>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; from egse.visitedpositions import visit_focal_plane_position +
&gt;&gt;&gt; visit_focal_plane_position(x_fp, y_fp)</pre>
</div>
</div>
</li>
<li>
<p>in CCD coordinates (row, column) [pixel] on a given CCD:</p>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; from egse.visitedpositions import visit_ccd_position +
&gt;&gt;&gt; visit_ccd_position(row, column, ccd_code)</pre>
</div>
</div>
</li>
<li>
<p>in field angles (theta, phi) [degrees]:</p>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; from egse.visitedpositions import visit_field_angles +
&gt;&gt;&gt; visit_field_angles(theta, phi)</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>At each of these locations, a red dot will appear on the plot. You can switch between coordinate system (used in the plot) with the combobox below the plot window (focal-plane coordinates, pixel coordinates, and field angles).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/visited-positions-gui.png" alt="visited positions gui">
</div>
<div class="title">Figure 32. Visited positions gui. From the commanding script you can launch the gui visible to the operator and add positions (red dots) to visualise the progress of a measurement.</div>
</div>
<div class="paragraph">
<p>Alternatively, you can fire up this GUI with</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ visited_positions_ui</pre>
</div>
</div>
<div class="paragraph">
<p>and add the visited locations with the following commands:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in focal-plane coordinates (x_fp, y_fp) [mm]:</p>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; visit_focal_plane_position(x_fp, y_fp)</pre>
</div>
</div>
</li>
<li>
<p>in CCD coordinates (row, column) [pixel] on a given CCD:</p>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; visit_ccd_position(row, column, ccd_code)</pre>
</div>
</div>
</li>
<li>
<p>in field angles (theta, phi) [degrees]:</p>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; visit_field_angles(theta, phi)</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>These commands can be used in test scripts, to visualise visited positions, without having to pass on the GUI object (or checking for its existence). In case the GUI has been fired up, the positions will be marked in the GUI. If not, nothing will happen (no error will occur).</p>
</div>
<div class="paragraph">
<p>In <code>camtest.commanding.csl_gse</code>, there are a couple of building blocks to move the mechanisms (i.e. hexapod and stages) such that the point sources falls on a specified position:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt;&gt;&gt; point_source_to_fov(theta, phi)
&gt;&gt;&gt; point_source_to_fp(x, y)</pre>
</div>
</div>
<div class="paragraph">
<p>When executing these building blocks, a red dot will be added to the GUI, marking that position (in case the GUI was fired up).</p>
</div>
</div>
<div class="sect2">
<h3 id="_what_should_be_started_where">Appendix C: What should be started where?</h3>
<div class="paragraph">
<p>On the EGSE server:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The core services (Process Manager, Configuration Manager, Storage
Manager, and Logging) should be running at all times. Ideally the EGSE
server is configured in a way that these services will be re-started
automatically in case they would go down.</p>
</li>
<li>
<p>If you want to start the Control Servers for the devices on the
command line: do it here (but probably you&#8217;ll want to launch them from
the PM UI (see below)).</p>
</li>
<li>
<p>The FITS generator.</p>
</li>
<li>
<p>The housekeeping generator for the N-FEE.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On the EGSE client:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All GUIs should be started here (Process Manager UI, Configuration
Manager UI, Setup UI, DPU UI, FOV UI, etc.).</p>
</li>
<li>
<p>You can start the Control Server for the devices from the PM UI. By
doing so, these processes will be started on the EGSE server.</p>
</li>
<li>
<p>Executing scripts, commands,&#8230;&#8203;</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_generating_fits_files_off_line">Appendix D: Generating FITS files off-line</h3>
<div class="paragraph">
<p>It sometimes happens that the FITS files need to be re-processed
off-line for some observations. This can be done, based on the relevant
HDF5 files that are stored in the daily folders for the OD(s) during
which the observation took place. Preferably, this is done on the EGSE
server of the TH, with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ fitsgen for-obsid &lt;obsid&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This will use the default data location from the
<code>PLATO_DATA_STORAGE_LOCATION</code> environment variable. It is possible to use
a different data location, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ fitsgen for-obsid &lt;obsid&gt; --location &lt;full path to the data folder (in which obs and daily can be found)&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Note that it can be dangerous to run the off-line FITS generation on the
client or server during testing, as it could overload the Storage
Manager. In case you would do this on a dedicated machine (with the same
commands), preferably over VNC (as some observation take a long time to
be processed), you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a full installation of plato-common-egse (make sure to use a release);</p>
</li>
<li>
<p>a checkout of plato-cgse-conf;</p>
</li>
<li>
<p>a running Storage Manager;</p>
</li>
<li>
<p>access to the data folder (with sub-folders /daily (in which the HDF5
files reside) and /obs (in which the FITS files will be stored)) from
the machine on which you will launch the FITS generation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before you can go ahead, make sure that there are no FITS files in the
folder for this observation (remove them if there would be any)!</p>
</div>
</div>
<div class="sect2">
<h3 id="app-issue-ncr-pvs">Appendix E: GitHub issues, NCR, and PVS</h3>
<div class="paragraph">
<p>In this section we explain what the difference is between a GitHub issue, a non-conformance report (NCR) and a procedure variation sheet (PVS). All three have their value and life cycle, but its important to understand when and where they have to be used, and how they are tracked.</p>
</div>
<div class="sect3">
<h4 id="_github_issues">18.E.1. GitHub issues</h4>
<div class="paragraph">
<p>A GitHub issue is a software issue that is raised in the GitHub repository of that part of the software. Issues on the common software, device drivers, storage etc. should be raised on the <a href="https://github.com/IvS-KULeuven/plato-common-egse"><code>plato-common-egse</code></a> repository, while issues with test scripts or, e.g., the Operator Task GUI shall be raised on the <a href="https://github.com/IvS-KULeuven/plato-test-scripts"><code>plato-test-scripts</code></a> repo. We have also the <a href="https://github.com/IvS-KULeuven/plato-cgse-conf"><code>plato-cgse-conf</code></a> repo which is used for the configuration and calibration of the camera and test equipment, and where the Setups are stored/tracked. Finally, there is the <a href="https://github.com/IvS-KULeuven/plato-cgse-doc"><code>plato-cgse-doc</code></a> repo which contains the documentation suite (of which you are reading one part right now).</p>
</div>
<div class="paragraph">
<p>An issue doesn&#8217;t necessarily mean there is a problem or an error. GitHub issues can be raised for various reasons: feature requests, software improvements, documentation update, bug, clarification request, system crash, dependency problem, etc. Whenever you want to raise an issue, use the button at the top of the GitHub repo page and fill in a clear title and a proper description. Some issues have a template that help you provide all information that a developer would need to analyse and reproduce the problem or to proceed with an implementation.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="../images/github-issues-button.png" alt="github issues button">
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">at the top-left of the repo Project page, click the <em>Issues</em> button to navigate to the overview page of open issues&#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">then at the top-right of the Issues page, click the <em>New issue</em> button to create a new issue&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="imageblock">
<div class="content">
<img src="../images/github-new-issue-button.png" alt="github new issue button">
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When you raise an issue, make sure you associate as many labels to it as applicable. Labels identify the issue and provide a powerful way to filter and search issues. If an issue is urgent and needs to go into a release, attach it to the milestone for that release.</p>
</div>
<div class="paragraph">
<p>Anyone who has access to the repository can inspect and create issues. If you encounter a problem, contact the maintainer of the GitHub repos.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Examples:</p>
<div class="ulist">
<ul>
<li>
<p>a process doesn&#8217;t start: processes are all part of the CGSE and you will notify when their LED is red in the process manager GUI. Try to investigate, but if you can not solve it, raise an issue in plato-common-egse.</p>
</li>
<li>
<p>an ERROR or Exception is raised in the console area of the operator Task GUI. Raise an issue in the test scripts and copy the error message from the console area into the issue description. If needed, the GitHub maintainer will migrate the issue to the CGSE repo.</p>
</li>
<li>
<p>the test script is aborted: This can be due to incorrect input values, or a system component that is not connected etc. Most of the time such an issue can be solved, but if the problem remains, raise an issue on the test scripts.</p>
</li>
<li>
<p>data is missing: This can be HK, metrics, FITS or CSV files, etc. This is usually a problem on the CGSE since all data files are handled by the Storage component. Only reduction and analysis scripts that are started from the Operator Task GUI generate intermediate results or PNGs.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>GitHub issues is an issue tracking system, not a software configuration control system.</p>
</div>
<div class="paragraph">
<p>How is the software configuration tracked? Where is that described?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>milestones &#8594; CCB &#8594; releases</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_ncr">18.E.2. NCR</h4>
<div class="paragraph">
<p>A NCR is a <em>Non-Conformance Report</em> and this type of report is used when there is a problem with either the Camera or one of the GSE that are under the responsibility of an ESA contract. As a consequence, NCRs are tracked and handled by ESA. An NCR can however be a result of an analysis on an issue that was previously raised in GitHub. When that is the case, add a link to or the ID of the GitHub issue to the NCR description. You should also add the link to the NCR (or the ID) to the GitHub issue.</p>
</div>
<div class="paragraph">
<p>The NCRs are tracked from the <a href="https://sre-polaris.esa.int/eclipse/">Eclipse system</a> used at ESA. Select the <code>PLATO – PA</code> scope and then <code>eNCTS</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/eclipse-toolbar-eNCTS.png" alt="eclipse toolbar eNCTS">
</div>
</div>
<div class="paragraph">
<p>This page is the starting point for creating and viewing all NCRs.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Examples</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>the N-FEE reports errors on the SRAM Buffer Full continuously, we could not identify a cause in the CGSE or site hardware/network setup.</p>
</li>
<li>
<p>CCD 2 of FM2 is not working properly anymore after Camera vibration. (PLATO-CSL-PL-NCR-0032)</p>
</li>
<li>
<p>after a camera switch ON, we measure a background of 650 ADU instead of 1300 ADU (PLATO-IAS-PL-NCR-0029)</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_pvs">18.E.3. PVS</h4>
<div class="paragraph">
<p>A PVS is a <em>Procedure Variation Sheet</em> and is used to describe any changes or deviations from a test procedure like TP-11 or TP-12. We make a distinction between changes in the procedure due to (1) an error in the procedure, lacking or incomplete information and (2) a small deviation or command that is used which is basically not part of the procedure. The former changes should actually go into a PVS since they introduce a change in the procedure itself and need to be tracked in a proper way. The latter change is usually done by red-lining the as-run copy of the procedure. This way, when the steps that were executed are checked, it is clear some extra commands have been executed or some commands have been skipped. That is not necessarily a permanent change in the procedure.</p>
</div>
<div class="paragraph">
<p>The PVS is a sheet, so where does this reside? Is the PVS attached to the procedure itself, to the as-run, or is it a separate document?</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. A REPL (Read-Eval-Print Loop) is an interactive programming environment that allows users to enter Python code, which is then executed, and the results are immediately displayed, aka the Python command prompt.
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.13<br>
Last updated 2024-03-29 11:36:57 +0100
</div>
</div>
<script>
;(function () { /*! Asciidoctor Tabs | Copyright (c) 2018-present Dan Allen | MIT License */
  'use strict'

  var config = (document.currentScript || {}).dataset || {}
  var forEach = Array.prototype.forEach

  init(document.querySelectorAll('.tabs'))

  function init (tabsBlocks) {
    if (!tabsBlocks.length) return
    forEach.call(tabsBlocks, function (tabs) {
      var syncIds = tabs.classList.contains('is-sync') ? {} : undefined
      var tablist = tabs.querySelector('.tablist ul')
      tablist.setAttribute('role', 'tablist')
      var start
      forEach.call(tablist.querySelectorAll('li'), function (tab, idx) {
        tab.tabIndex = -1
        tab.setAttribute('role', tab.classList.add('tab') || 'tab')
        var id, anchor, syncId
        if (!(id = tab.id) && (anchor = tab.querySelector('a[id]'))) {
          id = tab.id = anchor.parentNode.removeChild(anchor).id
        }
        var panel = id && tabs.querySelector('.tabpanel[aria-labelledby~="' + id + '"]')
        if (!panel) return idx ? undefined : toggleSelected(tab, true) // invalid state
        syncIds && (((syncId = tab.textContent.trim()) in syncIds) ? (syncId = undefined) : true) &&
          (syncIds[(tab.dataset.syncId = syncId)] = tab)
        idx || (syncIds && (start = { tab: tab, panel: panel })) ? toggleHidden(panel, true) : toggleSelected(tab, true)
        tab.setAttribute('aria-controls', panel.id)
        panel.setAttribute('role', 'tabpanel')
        var onClick = syncId === undefined ? activateTab : activateTabSync
        tab.addEventListener('click', onClick.bind({ tabs: tabs, tab: tab, panel: panel }))
      })
      if (!tabs.closest('.tabpanel')) {
        forEach.call(tabs.querySelectorAll('.tabpanel table.tableblock'), function (table) {
          var container = Object.assign(document.createElement('div'), { className: 'tablecontainer' })
          table.parentNode.insertBefore(container, table).appendChild(table)
        })
      }
      if (start) {
        var syncGroupId
        for (var i = 0, lst = tabs.classList, len = lst.length, className; i !== len; i++) {
          if (!(className = lst.item(i)).startsWith('data-sync-group-id=')) continue
          tabs.dataset.syncGroupId = syncGroupId = lst.remove(className) || className.slice(19).replace(/\u00a0/g, ' ')
          break
        }
        if (syncGroupId === undefined) tabs.dataset.syncGroupId = syncGroupId = Object.keys(syncIds).sort().join('|')
        var preferredSyncId = 'syncStorageKey' in config &&
          window[(config.syncStorageScope || 'local') + 'Storage'].getItem(config.syncStorageKey + '-' + syncGroupId)
        var tab = preferredSyncId && syncIds[preferredSyncId]
        tab && Object.assign(start, { tab: tab, panel: document.getElementById(tab.getAttribute('aria-controls')) })
        toggleSelected(start.tab, true) || toggleHidden(start.panel, false)
      }
    })
    onHashChange()
    toggleClassOnEach(tabsBlocks, 'is-loading', 'remove')
    window.setTimeout(toggleClassOnEach.bind(null, tabsBlocks, 'is-loaded', 'add'), 0)
    window.addEventListener('hashchange', onHashChange)
  }

  function activateTab (e) {
    var tab = this.tab
    var tabs = this.tabs || (this.tabs = tab.closest('.tabs'))
    var panel = this.panel || (this.panel = document.getElementById(tab.getAttribute('aria-controls')))
    querySelectorWithSiblings(tabs, '.tablist .tab', 'tab').forEach(function (el) {
      toggleSelected(el, el === tab)
    })
    querySelectorWithSiblings(tabs, '.tabpanel', 'tabpanel').forEach(function (el) {
      toggleHidden(el, el !== panel)
    })
    if (!this.isSync && 'syncStorageKey' in config && 'syncGroupId' in tabs.dataset) {
      var storageKey = config.syncStorageKey + '-' + tabs.dataset.syncGroupId
      window[(config.syncStorageScope || 'local') + 'Storage'].setItem(storageKey, tab.dataset.syncId)
    }
    if (!e) return
    var loc = window.location
    var hashIdx = loc.hash ? loc.href.indexOf('#') : -1
    if (~hashIdx) window.history.replaceState(null, '', loc.href.slice(0, hashIdx))
    e.preventDefault()
  }

  function activateTabSync (e) {
    activateTab.call(this, e)
    var thisTabs = this.tabs
    var thisTab = this.tab
    var initialY = thisTabs.getBoundingClientRect().y
    forEach.call(document.querySelectorAll('.tabs'), function (tabs) {
      if (tabs === thisTabs || tabs.dataset.syncGroupId !== thisTabs.dataset.syncGroupId) return
      querySelectorWithSiblings(tabs, '.tablist .tab', 'tab').forEach(function (tab) {
        if (tab.dataset.syncId === thisTab.dataset.syncId) activateTab.call({ tabs: tabs, tab: tab, isSync: true })
      })
    })
    var shiftedBy = thisTabs.getBoundingClientRect().y - initialY
    if (shiftedBy && (shiftedBy = Math.round(shiftedBy))) window.scrollBy({ top: shiftedBy, behavior: 'instant' })
  }

  function querySelectorWithSiblings (scope, selector, siblingClass) {
    var el = scope.querySelector(selector)
    if (!el) return []
    var result = [el]
    while ((el = el.nextElementSibling) && el.classList.contains(siblingClass)) result.push(el)
    return result
  }

  function toggleClassOnEach (elements, className, method) {
    forEach.call(elements, function (el) {
      el.classList[method](className)
    })
  }

  function toggleHidden (el, state) {
    el.classList[(el.hidden = state) ? 'add' : 'remove']('is-hidden')
  }

  function toggleSelected (el, state) {
    el.setAttribute('aria-selected', '' + state)
    el.classList[state ? 'add' : 'remove']('is-selected')
    el.tabIndex = state ? 0 : -1
  }

  function onHashChange () {
    var id = window.location.hash.slice(1)
    if (!id) return
    var tab = document.getElementById(~id.indexOf('%') ? decodeURIComponent(id) : id)
    if (!(tab && tab.classList.contains('tab'))) return
    'syncId' in tab.dataset ? activateTabSync.call({ tab: tab }) : activateTab.call({ tab: tab })
  }
})()
</script>
</body>
</html>