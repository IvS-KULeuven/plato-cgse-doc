<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="Sara Regibo, Rik Huygen">
<title>Common-EGSE : Installation Manual</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Asciidoctor Tabs | Copyright (c) 2018-present Dan Allen | MIT License */
.tabs > ul {
  display: flex;
  flex-wrap: wrap;
  list-style: none;
  margin: 0 -0.25em 0 0;
  padding: 0;
}

.tabs > ul li {
  align-items: center;
  border: 1px solid black;
  border-bottom: 0;
  cursor: pointer;
  display: flex;
  font-weight: bold;
  height: 2em;
  line-height: 1;
  margin-right: 0.25em;
  padding: 0 1em;
  position: relative;
}

.tabs > ul li, .tabs > ul p {
  margin-bottom: 0;
}

.tabs > ul li + li[id] {
  margin-top: 0;
}

.tabset {
  margin-bottom: 1.25em;
}

.tabset.is-loading .tabs li:not(:first-child),
.tabset:not(.is-loading) .tabs li:not(.is-active) {
  background-color: black;
  color: white;
}

.tabset.is-loading .tabs li:first-child::after,
.tabs li.is-active::after {
  background-color: white;
  content: "";
  display: block;
  height: 3px; /* Chrome doesn't always paint the line accurately, so add a little extra */
  position: absolute;
  bottom: -1.5px;
  left: 0;
  right: 0;
}

.tabset > .content {
  border: 1px solid gray;
  padding: 1.25em;
}

.tabset.is-loading .tab-pane:not(:first-child),
.tabset:not(.is-loading) .tab-pane:not(.is-active) {
  display: none;
}

.tab-pane > :first-child {
  margin-top: 0;
}

.tab-pane > :last-child > :last-child {
  margin-bottom: 0;
}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Common-EGSE : Installation Manual</h1>
<div class="details">
<span id="author" class="author">Sara Regibo, Rik Huygen</span><br>
<span id="revnumber">version 1.2,</span>
<span id="revdate">20/01/2023</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_changelog">Changelog</a></li>
<li><a href="#_colophon">Colophon</a></li>
<li><a href="#_conventions_used_in_this_book">Conventions used in this Book</a></li>
<li><a href="#_introduction">1. Introduction</a></li>
<li><a href="#_installing_the_operating_system">2. Installing the Operating System</a>
<ul class="sectlevel2">
<li><a href="#egse-server-install">2.1. Server Installation</a>
<ul class="sectlevel3">
<li><a href="#_server_hardware">2.1.1. Server Hardware</a></li>
<li><a href="#_disk_and_storage">2.1.2. Disk and Storage</a></li>
<li><a href="#_installation_of_python_3_8">2.1.3. Installation of Python 3.8</a></li>
<li><a href="#_open_ports_on_the_firewall">2.1.4. Open Ports on the Firewall</a></li>
<li><a href="#core-services">2.1.5. Setup Services for Core Control Servers with Systemd</a></li>
<li><a href="#_disable_selinux">2.1.6. Disable SELinux</a></li>
<li><a href="#_check_your_services">2.1.7. Check your services</a></li>
<li><a href="#export-mount-point">2.1.8. Export the /data folder</a></li>
</ul>
</li>
<li><a href="#egse-client-install">2.2. Client Installation</a>
<ul class="sectlevel3">
<li><a href="#mount">2.2.1. NFS mount the /data folder from the egse-server</a></li>
</ul>
</li>
<li><a href="#_user_administration">2.3. User Administration</a></li>
</ul>
</li>
<li><a href="#prometheus-install">3. Install the Prometheus server</a></li>
<li><a href="#grafana-install">4. Install the Grafana server</a></li>
<li><a href="#python-install">5. Install Python</a>
<ul class="sectlevel2">
<li><a href="#_python_download_pages">5.1. Python Download Pages</a></li>
<li><a href="#_anaconda">5.2. Anaconda</a></li>
</ul>
</li>
<li><a href="#_installation_of_pycharm">6. Installation of PyCharm</a></li>
<li><a href="#cgse-install">7. Installation of the Common-EGSE</a></li>
<li><a href="#test-scripts-install">8. Installing the Test Scripts</a></li>
<li><a href="#cgse-conf-install">9. Installation of Setups</a></li>
<li><a href="#desktop-entry-install">10. Installation of Desktop Entries</a></li>
<li><a href="#install-vnc">11. Installation of a VNC Server</a>
<ul class="sectlevel2">
<li><a href="#_install_packages">11.1. Install packages</a></li>
<li><a href="#_configure_the_gnome_display_manager">11.2. Configure the GNOME Display Manager</a></li>
<li><a href="#_install_and_activate_the_vnc_service">11.3. Install and Activate the VNC service</a></li>
</ul>
</li>
<li><a href="#setup-environment">12. Setting up the environment</a>
<ul class="sectlevel2">
<li><a href="#_environment_variables">12.1. Environment Variables</a></li>
<li><a href="#_the_environment_for_systemd_services">12.2. The environment for Systemd services</a></li>
</ul>
</li>
<li><a href="#github-deploy">13. Setting up ssh access and GitHub deploy keys</a>
<ul class="sectlevel2">
<li><a href="#deploy-key-egse-server">13.1. Create a deploy key for the plato-common-egse</a></li>
<li><a href="#_create_a_deploy_key_for_the_plato_test_scripts">13.2. Create a deploy key for the plato-test-scripts</a></li>
<li><a href="#deploy-key-cgse-conf">13.3. Create a deploy key for the plato-cgse-conf</a></li>
</ul>
</li>
<li><a href="#cgse-update">14. Update the Common-EGSE to the latest release</a></li>
<li><a href="#test-scripts-update">15. Update the Test Scripts to the latest release</a></li>
<li><a href="#python-package-update">16. Update Python packages</a></li>
<li><a href="#_data_propagation">17. Data Propagation</a></li>
<li><a href="#_shared_libraries">18. Shared Libraries</a></li>
<li><a href="#_installating_external_tools">19. Installating External Tools</a>
<ul class="sectlevel2">
<li><a href="#_cutelog_gui">19.1. Cutelog GUI</a></li>
<li><a href="#_textualog_tui">19.2. Textualog TUI</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_changelog">Changelog</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">20/01/2023 – v1.2</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>We will now try to maintain a changelog.</p>
</li>
<li>
<p>Documented the installation and activation of a VNC Server on Ubuntu, see <a href="#install-vnc">Chapter 11</a></p>
</li>
<li>
<p>Improved section on 'Setting up the environment', see <a href="#setup-environment">Chapter 12</a></p>
</li>
<li>
<p>Updated the version numbering used for releases in update commands, see <a href="#cgse-update">Chapter 14</a> and <a href="#test-scripts-update">Chapter 15</a></p>
</li>
<li>
<p>Added info on how to set the terminal title, see <a href="#set-terminal-title">[set-terminal-title]</a></p>
</li>
<li>
<p>Added explanation of <code>--ignore-installed</code> optional argument for <code>pip</code>, see <a href="#python-package-update">Chapter 16</a></p>
</li>
<li>
<p>Added a brief explanation on exporting a mount point on the egse-server <a href="#export-mount-point">Section 2.1.8</a> and mounting the mount point <a href="#mount">Section 2.2.1</a> on the egse-client.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_colophon">Colophon</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Copyright &#169; 2022 by the KU Leuven PLATO CGSE Team</p>
</div>
<div class="paragraph">
<p>1<sup>st</sup> Edition — November 2022</p>
</div>
<div class="paragraph">
<p>This manual is written in PyCharm using the AsciiDoc plugin. The PDF Book version is processed with asciidoctor-pdf.</p>
</div>
<div class="paragraph">
<p>The manual is available as HTML from <a href="http://ivs-kuleuven.github.io/plato-cgse-doc">ivs-kuleuven/github.io</a>. The HTML pages are generated with Hugo which is an OSS static web-pages generator. From this site, you can also download the PDF books.</p>
</div>
<div class="paragraph">
<p>The source code is available in a GitHub repository at <a href="https://github.com/ivs-kuleuven/plato-cgse-doc">ivs-kuleuven/plato-cgse-doc</a>.</p>
</div>
<div class="paragraph">
<p>When you find an error or inconsistency or you have some improvements to the text, feel free to raise an issue or create a pull request. Any contribution is greatly appreciated and will be mentioned in the acknowledgement section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conventions_used_in_this_book">Conventions used in this Book</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We try to be consistent with the following typographical conventions:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Italic</dt>
<dd>
<p>Indicates a new term or &#8230;&#8203;</p>
</dd>
<dt class="hdlist1">Constant width</dt>
<dd>
<p>Used for code listings, as well as within paragraphs to refer to program elements like variable and function names, data type, environment variables (<code>ALL_CAPS</code>), statements and keywords.</p>
</dd>
<dt class="hdlist1">Constant width between angle brackets <code>&lt;text&gt;</code></dt>
<dd>
<p>Indicates <code>text</code> that should be replaced with user-supplied values or by values determined by context. The brackets should thereby be omitted.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>When you see a <code>$ &#8230;&#8203;</code> in code listings, this is a command you need to execute in a terminal (omitting the dollar sign itself). When you see <code>&gt;&gt;&gt; &#8230;&#8203;</code> in code listings, that is a Python expression that you need to execute in a Python REPL (here omitting the three brackets).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This guide explains the installation and configuration of the following components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The operating system (CentOS-8, Ubuntu) on the <code>egse-server</code> and <code>egse-client</code> machines</p>
</li>
<li>
<p>The installation of basic tools like git, Python</p>
</li>
<li>
<p>The installation of the Common-EGSE (CGSE) &#8592; <code>plato-common-egse</code></p>
</li>
<li>
<p>The installation of the Test Scripts (TS) &#8592; <code>plato-test-scripts</code></p>
</li>
<li>
<p>The installation of the Configuration files (Setups) &#8592; <code>plato-cgse-conf</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please note there is a difference between an installation on an operational machine with respect to your development environment. The operational machine has in principle a <em>read-only</em> installation. That means no files in the repositories shall be changed and it will not be possible to push any changes to the GitHub repositories from any operational machine. The development installation on your local laptop or desktop is an installation where you can have full control over your development. In this environment you make changes, test your code, document the code, update, merge, and push to your <em>origin</em> repository, to end with a pull request from <em>origin</em> to <em>upstream</em> which is the official GitHub repo.</p>
</div>
<div class="paragraph">
<p>We will also spend some time in this manual on how to update your system for security updates and how to update the Common-EGSE and test-scripts with new releases.</p>
</div>
<div class="paragraph">
<p>This manual was originally written for installation of and on CentOS-8, but in the mean time we moved to Ubuntu 20.04 LTS. When feasible, we will use TABs to allow you to switch between information and code for either OS.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing_the_operating_system">2. Installing the Operating System</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="egse-server-install">2.1. Server Installation</h3>
<div class="sect3">
<h4 id="_server_hardware">2.1.1. Server Hardware</h4>
<div class="paragraph">
<p>Proposed hardware for the egse-server:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>1x Supermicro SYS-6019P-MT</p>
</li>
<li>
<p>2x Intel Xeon Gold 5120 s3647 Skylake-SP 14 Cores 28 Threads 2.2GHz 2.6GHz Turbo</p>
</li>
<li>
<p>4x Samsung 32GB DDR4-2666 2Rx4 (128GB main memory)</p>
</li>
<li>
<p>1x Intel SSD 240GB &#8594; system disk</p>
</li>
<li>
<p>1x Intel SSD 2TB &#8594; life data disk</p>
</li>
<li>
<p>1x Seagate SATA 12TB &#8594; archive disk</p>
</li>
<li>
<p>2x Ethernet RJ45 1Gb/s</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>egse-server</code> will do quite some work in communicating with all the test equipment, receive commands from the GUIs and Python REPL running on the <code>egse-client</code>, commanding the system under test (SUT), retrieve CCD data from the Camera, and store all data from all communication to disk. Especially, the storage of all the data is demanding and needs to be as performant as possible in order to keep up with the data rate from the N-FEE or F-FEE during testing. That is the reason we have chosen three separate disks in the <code>egse-server</code> machine. The small SSD is used to install the operating system and the home directories. The larger SSD is the <code>/data</code> disk where the life data is stored. This disk needs to be an SSD in order to keep up with the datarate. We have seen in tests that this is a crucial part in the chain to prevent the N-FEE from reporting internal buffer overflows because data is not read fast enough. It is important to keep the <code>/data</code> disk from running full, you need about 20% free for an SSD to be performant. The big SATA disk is the <code>/archive</code> disk which will contain all test data and is synchronised periodically from the <code>/data</code> life data.</p>
</div>
<div class="paragraph">
<p>The two Ethernet cards are foreseen to split network traffic from the SpaceWire connection if needed. Especially for the F-FEE it might be needed to allocate the full bandwith of one Ethernet cable in order to cope with the multiplexed four SpaceWire connections.</p>
</div>
<div class="paragraph">
<p>In the next sections, we will briefly explain how to install the <code>egse-server</code> and <code>egse-client</code> machines. The frame below explains where to download and perform a basic installation of CentOS 8 or Ubuntu 20.04.</p>
</div>
<div id="_tabset_1" class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li id="_tabset_1_centos_8">
<p>CentOS 8</p>
</li>
<li id="_tabset_1_ubuntu_20_04">
<p>Ubuntu 20.04</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="_tabset_1_centos_8">
<div class="paragraph">
<p>Perform a normal/default installation of CentOS-8. Follow the default settings.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Version: CentOS Linux release 8.1</p>
</li>
<li>
<p>Download CentOS 8 from XXXX</p>
</li>
<li>
<p>Boot mode: UEFI</p>
</li>
</ul>
</div>
</div>
<div class="tab-pane" aria-labelledby="_tabset_1_ubuntu_20_04">
<div class="ulist">
<ul>
<li>
<p>Download the Ubuntu Server distribution from: <a href="https://ubuntu.com/download/server" class="bare">https://ubuntu.com/download/server</a>.</p>
</li>
<li>
<p>Refer to the <a href="https://ubuntu.com/tutorials/install-ubuntu-server">step-by-step server installation instructions</a> if you need more insight.</p>
</li>
<li>
<p>Perform a normal/default installation of Ubuntu 20.X.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_disk_and_storage">2.1.2. Disk and Storage</h4>
<div class="paragraph">
<p>The following directories will be created on the server side:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/home</code>: used for the software installations and daily work.</p>
</li>
<li>
<p><code>/data</code>: used to store life data, i.e. image data from the FEEs,
housekeeping data, logging information, metrics, etc. This is the mounted SSD disk of 2TB.</p>
</li>
<li>
<p><code>/archive</code>: used to archive all data. This data is transferred to the data archive in Leuven on a daily basis. This is the mounted SATA disk of 12TB.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_installation_of_python_3_8">2.1.3. Installation of Python 3.8</h4>
<div class="paragraph">
<p>We will install Python from the official Python website, as described in <a href="#python-install">Chapter 5</a>. The procedure is as follows: We first install the development tools for CentOS and a number of <code>devel</code> packages that are needed for header files during compilation. We then get the Python source distribution from <code>www.python.org</code>, unpack, configure and compile. Use <code>altinstall</code> instead of <code>install</code> if you don&#8217;t want previous installations of Python to be overwritten. This will install <code>python3.8</code> in <code>/usr/local/bin</code>. All the commands need to be executes as root.</p>
</div>
<div id="_tabset_2" class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li id="_tabset_2_centos_8">
<p>CentOS 8</p>
</li>
<li id="_tabset_2_ubuntu_20_04">
<p>Ubuntu 20.04</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="_tabset_2_centos_8">
<div class="listingblock">
<div class="content">
<pre>yum -y groupinstall "Development Tools"
yum -y install openssl-devel bzip2-devel libffi-devel
yum -y install wget
curl https://www.python.org/ftp/python/3.8.13/Python-3.8.13.tgz --output Python-3.8.13.tgz
tar xvf Python-3.8.13.tgz
cd Python-3.8.13/
./configure --enable-optimizations
make altinstall</pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="_tabset_2_ubuntu_20_04">
<div class="paragraph">
<p>Python 3.8 comes installed with Ubuntu 20.04, no need to re-install it.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_open_ports_on_the_firewall">2.1.4. Open Ports on the Firewall</h4>
<div class="paragraph">
<p>By default CentOS-8 has the Firewall enabled. When your system is installed in a save environment without external connectivity, you could consider to disable the Firewall altogether.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>systemctl status firewalld
systemctl stop firewalld
systemctl disable firewalld
systemctl mask firewalld</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you do need the Firewall to be enabled, open up all the ports that are used by the Common-EGSE core services. This might be a lot of work, but fortunately, you can define ranges when making ports available.</p>
</div>
<div class="paragraph">
<p>The following type of ports are used by control servers and other processes:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Normal secure shell communication port</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">COMMANDING_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by the control servers for commanding the devices</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MONITORING_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by the control servers to periodically send out monitoring info</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SERVICE_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by the control servers for services not related to commanding</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">METRICS_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by the control servers, data acquisition, and GUIs to serve the metrics to Prometheus through an internal HTTP service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOGGING_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by the CGSE Logger</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATA_DISTRIBUTION_PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by the DPU Processor to distribute the N-FEE data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEVICE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Device specific port that are used by the controllers or device interfaces to connect to.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OTHER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Grafana [3000], Cutelog [19996]</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All the port numbers for the different processes are defined in the <code>settings.yaml</code> file in the CGSE distribution and can be overwritten in the local settings file at <code>$PLATO_LOCAL_SETTINGS</code>.</p>
</div>
<div class="paragraph">
<p>Opening ports and port ranges can be done by introducing a new service on the server. The example below opens up the ports for the Hexapod PUNA Control Server. The commands to set up the service on the <code>firewalld</code> are:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo firewall-cmd --permanent --new-service=puna-conrol
sudo firewall-cmd --permanent --service=puna-control --set-description="Hexapod PUNA Control Services"
sudo firewall-cmd --permanent --service=puna-control --add-port=6700-6703/tcp
sudo firewall-cmd --permanent --zone=public --add-service=puna-control
sudo firewall-cmd --reload</pre>
</div>
</div>
<div class="paragraph">
<p>Repeat the same sequence for the other control services and processes.</p>
</div>
</div>
<div class="sect3">
<h4 id="core-services">2.1.5. Setup Services for Core Control Servers with Systemd</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You might want to do these steps only after you have installed Prometheus [<a href="#prometheus-install">Chapter 3</a>], Grafana [<a href="#grafana-install">Chapter 4</a>] and the Common-EGSE [<a href="#cgse-install">Chapter 7</a>]</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The control servers for this project that run on the <code>egse-server</code> are all
managed by the <code>systemd</code> service manager. For information on <strong>systemd</strong> check
out the documentation on the Redhat System Administration Site at <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/chap-managing_services_with_systemd">RHEL7</a>.</p>
</div>
<div class="paragraph">
<p>The service files for each of the core control servers are located in the <code>server</code> directory at the root of the <code>plato-common-egse</code> project. You will have to adapt the services —especially the absolute paths— to your needs and setup. Then copy the service files into the <code>/etc/systemd/system</code> directory:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo cp sm_cs.service /etc/systemd/system
sudo cp cm_cs.service /etc/systemd/system
sudo cp pm_cs.service /etc/systemd/system
sudo cp log_cs.service /etc/systemd/system
sudo cp syn_cs.service /etc/systemd/system</pre>
</div>
</div>
<div class="paragraph">
<p>The following code lists the entire service for the Storage Manager Control Server. The text <code>EnvironmentFile</code> and <code>WorkingDirectory</code> need special attention for your specific setup.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[Unit]
Description=Storage Manager Control Server
After=network-online.target

[Service]
Type=simple
Restart=always
RestartSec=3
User=plato-data
Group=plato-data
EnvironmentFile=/cgse/env.txt
WorkingDirectory=/home/plato-data/workdir
ExecStart=/cgse/bin/sm_cs

[Install]
Alias=sm_cs.service
WantedBy=multi-user.target</pre>
</div>
</div>
<div class="paragraph">
<p>The service starts the specific control server from a script that was created during the <code>setuptools</code> installation, in our example in the <code>/cgse/bin</code> folder. Check the services files for the Configuration Manager and Process Manager also, they contain a specific delay time of 3s to ensure the Storage manager had enough time to start up and process registrations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[Service]
ExecStartPre=/bin/sleep 3</pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You will also need to create the <code>/home/plato-data/workdir</code> folder for the user <code>plato-data</code>. Without this folder, the service will not start and you will get a <code>(code=exited, status=200/CHDIR)</code> when you run a <code>systemctl status</code> command for the service.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the services file is correct, start the service as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo systemctl start sm_cs</pre>
</div>
</div>
<div class="paragraph">
<p>and to automatically start the service on boot:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo systemctl enable sm_cs</pre>
</div>
</div>
<div class="paragraph">
<p>The counter parts of the above commands are <strong>stop</strong> and <strong>disable</strong> where the former just stops the service and the latter prevents the service to start at boot time.</p>
</div>
<div class="paragraph">
<p>Whenever you have made a change to the services file and copied it back into the <code>/etc/systemd/system</code> directory, reload the daemons as follows:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo systemctl daemon-reload</pre>
</div>
</div>
<div class="paragraph">
<p>If you need to know the status of one of the control services, use the following command, e.g. for the Process manager:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo systemctl status pm_cs.service</pre>
</div>
</div>
<div class="paragraph">
<p>This prints out the status info on the service plus the last few messages that were send to stdout or stderr.</p>
</div>
<div class="paragraph">
<p>When you want to check and follow the output in <code>/var/log/messages</code> for the specific service, you can use the <code>journalctl</code> command. An example for the process manager <code>pm_cs</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo journalctl -f -u pm_cs</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_disable_selinux">2.1.6. Disable SELinux</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This section is only relevant if your have installed a CentOS-8 system, Ubuntu does not install SELinux by default and it is therefore probably not activated..
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you run into a authentication error while starting the control servers, you will need to disable SELinux (Security-Enhanced Linux). The error will look something like this (excerpt from <code>/var/log/messages</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>Sep 11 17:59:46 localhost systemd[1]: sm_cs.service: Service RestartSec=3s expired, scheduling restart.
Sep 11 17:59:46 localhost systemd[1]: sm_cs.service: Scheduled restart job, restart counter is at 369.
Sep 11 17:59:46 localhost systemd[1]: Stopped Storage Manager Control Server.
Sep 11 17:59:46 localhost systemd[1]: Started Storage Manager Control Server.
Sep 11 17:59:46 localhost systemd[22013]: sm_cs.service: Failed to execute command: Permission denied
Sep 11 17:59:46 localhost systemd[22013]: sm_cs.service: Failed at step EXEC spawning /cgse/bin/sm_cs: Permission denied
Sep 11 17:59:46 localhost systemd[1]: sm_cs.service: Main process exited, code=exited, status=203/EXEC
Sep 11 17:59:46 localhost systemd[1]: sm_cs.service: Failed with result 'exit-code'.
Sep 11 17:59:47 localhost setroubleshoot[19162]: failed to retrieve rpm info for /cgse/bin/sm_cs
Sep 11 17:59:47 localhost setroubleshoot[19162]: SELinux is preventing /usr/lib/systemd/systemd from 'read, open' accesses on the file /cgse/bin/sm_cs. For complete SELinux messages run: sealert -l a77af8c2-c91a-43cd-9b64-e7c0a5b24311
Sep 11 17:59:47 localhost platform-python[19162]: SELinux is preventing /usr/lib/systemd/systemd from 'read, open' accesses on the file /cgse/bin/sm_cs.#012#012*****  Plugin catchall (100. confidence) suggests   **************************#012#012If you believe that systemd should be allowed read open access on the sm_cs file by default.#012Then you should report this as a bug.#012You can generate a local policy module to allow this access.#012Do#012allow this access for now by executing:#012# ausearch -c '(sm_cs)' --raw | audit2allow -M my-smcs#012# semodule -X 300 -i my-smcs.pp#012</code></pre>
</div>
</div>
<div class="paragraph">
<p>To disable SELinux, edit the <code>/etc/selinux/config</code> file and set <code>SELINUX=disabled</code>. Then reboot your system (this is a kernel setting, therefore we need to reboot).</p>
</div>
</div>
<div class="sect3">
<h4 id="_check_your_services">2.1.7. Check your services</h4>
<div class="paragraph">
<p>A simple and quick way to check if the core services are still running together with Prometheus<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> and Grafana<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup> is to check the running processes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code>[plato-data@egse-server]$ ps -ef|egrep "prometheus|grafana|_cs"
plato-d+   64839       1  5 Jun24 ?        08:17:43 /home/plato-data/software/prometheus/prometheus --config.file /home/plato-data/software/prometheus/prometheus-egse-server.yml --storage.tsdb.path /data/metrics/data/
plato-d+  808513       1  0 Apr19 ?        06:33:25 /home/plato-data/software/grafana/bin/grafana-server
plato-d+ 2519545       1  4 Jun21 ?        09:12:10 /usr/bin/python3 /cgse/bin/sm_cs start
plato-d+ 2519684       1  3 Jun21 ?        06:57:04 /usr/bin/python3 /cgse/bin/syn_cs start
plato-d+ 2519771       1  2 Jun21 ?        04:36:55 /usr/bin/python3 /cgse/bin/cm_cs start
plato-d+ 2543093       1  0 Jun21 ?        00:28:03 /usr/bin/python3 /cgse/bin/log_cs start
plato-d+ 2633916       1  2 Jun21 ?        04:28:20 /usr/bin/python3 /cgse/bin/pm_cs start
[plato-data@egse-server]$</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="export-mount-point">2.1.8. Export the /data folder</h4>
<div class="paragraph">
<p>We will need access to the <code>/data</code> folder on the egse-client machine and will add the following to the <code>/etc/exports</code> file. Adding this info will need root permissions (you can use the sudo command too). Make sure you use the correct IP address of the egse-server from which this mount is accessed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data    192.168.0.74/26(rw,sync)</pre>
</div>
</div>
<div class="paragraph">
<p>Some of our servers have two ethernet interfaces and you might want to add an additional IP address to the exports, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data/IAS	egse-server.ivs.kuleuven.be(rw,sync) 192.168.80.14(rw,sync)</pre>
</div>
</div>
<div class="paragraph">
<p>The only thing to do now is to restart the NFS server on the egse-server machine:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>service nfs-server status
sudo service nfs-server restart</pre>
</div>
</div>
<div class="paragraph">
<p>How you need to NFS mount this <code>/data</code> folder on the egse-client machine is explained in the section on Client Installation, see<a href="#egse-client-install">Section 2.2</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="egse-client-install">2.2. Client Installation</h3>
<div class="ulist">
<ul>
<li>
<p>Perform a normal/default desktop installation of CentOS-8 or Ubuntu 20.</p>
</li>
<li>
<p>Create a user plato-user</p>
</li>
<li>
<p>Log in as user plato-user</p>
</li>
<li>
<p>install the plato-common-egse in ~/git (see <a href="#cgse-install">Chapter 7</a>)
*</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="mount">2.2.1. NFS mount the /data folder from the egse-server</h4>
<div class="paragraph">
<p>The first thing to do is to check which mounts are exported by the egse-server. That can easily be done with the <code>showmounts</code> command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ showmount -e 139.xxx.yyy.74
Export list for 139.xxx.yyy.74:
/data 139.xxx.yyy.74/26</pre>
</div>
</div>
<div class="paragraph">
<p>With this knowledge you can already mount the directory on the egse-client:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo mount 139.xxx.yyy.74:/data /data</pre>
</div>
</div>
<div class="paragraph">
<p>We will need to make this mount permanently available, also after rebooting the system. This can be done as a static mount or by using the autmounter daemon.</p>
</div>
<div id="_tabset_3" class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li id="_tabset_3_static_mount">
<p>Static mount</p>
</li>
<li id="_tabset_3_automounter">
<p>Automounter</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="_tabset_3_static_mount">
<div class="paragraph">
<p>With <code>fstab</code> we will create a static mount for the <code>/data</code> location. We add the mount point to <code>/etc/fstab</code> which will automatically mount the folder at startup and it will remain mounted until system shutdown or explicitly unmounted.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo vi /etc/fstab
...
139.xxx.yyy.74:/data /data        nfs     rw,sync 0 0</pre>
</div>
</div>
<div class="paragraph">
<p>This now also provides us a simpler way to mount the directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo mount /data</pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="_tabset_3_automounter">
<div class="paragraph">
<p>The automounter daemon is controlled by the <code>autofs</code> service. In the master configuration file for <code>autofs</code>, add a new line to specify a direct map for the file <code>/etc/auto.cgse</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo vi /etc/auto.master
...
/- /etc/auto.cgse</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>/etc/auto.cgse</code> file shall then contain the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/data	-fstype=nfs	139.xxx.yyy.74:/data</pre>
</div>
</div>
<div class="paragraph">
<p>Finally you should reload the <code>autofs</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo service autofs reload</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_user_administration">2.3. User Administration</h3>
<div class="paragraph">
<p>There are 4 specific PLATO users defined:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>plato-admin</code>: has basically the same rights as root and is used for system installation and administration tasks. All root commands must be executed with <code>sudo</code>, no password will be asked. Do not usually login to this account.</p>
</li>
<li>
<p><code>plato-ops</code>: is used to administer and control the Common-EGSE core services. This user can start and stop the Common-EGSE control servers as a service with the systemd command <code>systemctl</code>. Log in to this account to monitor the systemd services with <code>systemctl</code> and <code>journalctl</code>. This user can also control and monitor the Prometheus and Grafana servers using <code>systemctl</code> and <code>journalctl</code>.</p>
</li>
<li>
<p><code>plato-data</code>: all services should run under <code>plato-data</code>, data locations will be writable by <code>plato-data</code> and readable by <code>plato-user</code>. You do not normally log into this account, but the services are started under this account. All the software (Common-EGSE and Test Scripts), and all the data created by the different processes and control servers can best be run and created by the <code>plato-data</code> user for consistency. If device control servers need to be started manually, use this account.</p>
</li>
<li>
<p><code>plato-user</code>: the generic user account for running the test scripts, start GUIs and analysing the data. This user has no <code>sudo</code> rights, but has read access to the <code>/data</code> directory. This is the account used to execute the test scripts. Don&#8217;t use this account on the <code>egse-server</code> unless you know what you are doing.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prometheus-install">3. Install the Prometheus server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please note that in the developer documentation under the section <a href="../develop/monitoring.html#monitoring">Monitoring</a> there is a description on <em>Installing Prometheus</em>. I will here only describe the setup for the <code>egse-server</code>. The best is to create a dedicated directory for the software installations, e.g. <code>~/software</code>. Then install Prometheus into that folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ mkdir ~/software
$ cd ~/software
$ curl -L -o prometheus-2.36.2.linux-amd64.tar.gz https://github.com/prometheus/prometheus/releases/download/v2.36.2/prometheus-2.36.2.linux-amd64.tar.gz  <i class="conum" data-value="1"></i><b>(1)</b>
$ tar xzvf prometheus-2.36.2.linux-amd64.tar.gz
$ ln -s prometheus-2.36.2.linux-amd64 prometheus</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>the <code>-L</code> option is needed because the link will redirect and with this option <code>curl</code> follows the redirect.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We want to automatically start the Prometheus server from the systemd services as we did with the core-egse services. The service file, i.e. <code>prometheus.service</code>, can be copied from the <code>server</code> directory in the distribution to the <code>/etc/systemd/system</code> folder, same as for the core-egse services. Make sure you update the locations if necessary. The configuration files for Prometheus, i.e. <code>prometheus.yml</code> and <code>prometheus.rules.yml</code>, can best be soft linked from the <code>metrics</code> folder into the installation folder of Prometheus. That will automatically keep these files update-to-date with a new release of the software.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cp ~/git/plato-common-egse/server/prometheus.service /etc/systemd/system
$ ln -s ~/git/plato-common-egse/metrics/prometheus.yml ~/software/prometheus
$ ln -s ~/git/plato-common-egse/metrics/prometheus.rules.yml ~/software/prometheus</pre>
</div>
</div>
<div class="paragraph">
<p>Finally, create the <code>metrics/data</code> directory in the proper location, e.g. in <code>/data</code>. That is the location given with the <code>--storage.tsdb.path</code> option in the Prometheus service file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mkdir -p /data/metrics/data</pre>
</div>
</div>
<div class="paragraph">
<p>Then enable the service as user <code>plato-admin</code> and reload the systemd services daemon:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo systemctl enable prometheus
$ sudo systemctl daemon-reload
$ sudo systemctl start prometheus</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="grafana-install">4. Install the Grafana server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please note that in the developer documentation under the section <a href="../develop/monitoring.html#monitoring">Monitoring</a> there is a description on <em>Installing Grafana</em>. I will here only describe the setup for the <code>egse-server</code>. The best is to create a dedicated directory for the software installations, e.g. <code>~/software</code>. Then install Grafana into that folder.<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl -L -o grafana-enterprise-8.5.6.linux-amd64.tar.gz https://dl.grafana.com/enterprise/release/grafana-enterprise-8.5.6.linux-amd64.tar.gz
$ tar xzvf grafana-enterprise-8.5.6.linux-amd64.tar.gz
$ ln -s grafana-8.5.6 grafana</pre>
</div>
</div>
<div class="paragraph">
<p>Grafana doesn&#8217;t need any further configuration. That is done in the dashboards that are loaded as explained in XXXXX <a href="../develop/monitoring.html">Monitoring/Dashboard Configuration</a>.</p>
</div>
<div class="paragraph">
<p>We also want the Grafana server to automatically start from the systemd services as we did for Prometheus. We currently use Grafana with the default configuration and have the database located in the installation directory. The service file is located in the <code>server</code> folder of the Common-EGSE project and should be copied to <code>/etc/systemd/system</code>. After that, enable Grafana with <code>systemctl</code> and reload the services daemon.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="python-install">5. Install Python</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Use Python 3.8+</div>
This code is written for <strong>Python 3</strong> and uses features of Python 3.8 (e.g. walrus operator), so make sure you have at least Python 3.8 installed and configured on your system before trying any of the guides. You can find installation instructions below.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_python_download_pages">5.1. Python Download Pages</h3>
<div class="paragraph">
<p>Download the required version of Python from the <a href="https://www.python.org/downloads/">official Python download website</a>.  When you press the "Download" button, you should automatically be re-directed to the download page for your operating system.</p>
</div>
<div class="paragraph">
<p>After the download has completed, execute the package file and follow the instructions during the installation process.</p>
</div>
<div class="paragraph">
<p>For macOS 10.9 or higher, this will install Python in the dedicated system folder
<code>/Library/Frameworks/Python.framework/Versions/&lt;version number&gt;</code>. For Linux a tarball with the latest release is available.  For Windows you can download an executable installer or a ZIP file, dependening on your preferences.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.python.org/downloads/"><img src="../images/python-logo.png" alt="Python"></a>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_anaconda">5.2. Anaconda</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">Python on operational system</div>
Make sure you install the official release of Python on any operational machine and <strong>not</strong> the Anaconda distribution. There are too many dependency problem to solve for the Anaconda installation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On you development machine, you can, alternatively, install Python with the <a href="https://www.anaconda.com/distribution/">Anaconda distribution</a>.  This comes with the benefit of installing many additional packages for development, data analysis, and visualisation. Anaconda however nests itself into your system and makes it&#8217;s difficult to set up environments without the interference of Anaconda. It also uses it&#8217;s own package management and update script instead of the standard Python distribution with <code>pip</code>. Make sure you know what your doing before using this option.</p>
</div>
<div class="paragraph">
<p>Links to the download pages (follow the instruction listed there):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.anaconda.com/anaconda/install/mac-os/">for macOS</a></p>
</li>
<li>
<p><a href="https://docs.anaconda.com/anaconda/install/linux/">for Linux</a></p>
</li>
<li>
<p><a href="https://docs.anaconda.com/anaconda/install/windows/">for Windows</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Upon installation, the following questions will pop up:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>accept license: yes</p>
</li>
<li>
<p>where to install it</p>
</li>
<li>
<p>initialise Anaconda in your <code>.bashrc</code>: no</p>
</li>
<li>
<p>whether VS Code should be installed (source code editor): optional</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This completes the Anaconda installation.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.anaconda.com/"><img src="../images/anaconda-logo.png" alt="Anaconda"></a>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation_of_pycharm">6. Installation of PyCharm</h2>
<div class="sectionbody">
<div class="paragraph">
<p>PyCharm is the IDE that we will use to execute test scripts. For this purpose the PyCharm Community edition is sufficient.</p>
</div>
<div class="paragraph">
<p>TBW</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cgse-install">7. Installation of the Common-EGSE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The installation will be done as the <code>plato-data</code> user. We will <em>clone</em> the IvS-KULeuven <code>plato-common-egse</code> repository. There is no need to <em>fork</em> because we will not develop from this account and will therefore not do any
pushes or  pull requests.</p>
</div>
<div class="paragraph">
<p>Create a <code>~/git</code> folder in the home directory of the <code>plato-data</code> user, move into that directory and clone the GitHub repository. Then move into the <code>plato-common-egse</code> folder that was created by the <em>clone</em> command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mkdir -p ~/git
$ cd git
$ git clone https://github.com/IvS-KULeuven/plato-common-egse.git
$ cd plato-common-egse/</pre>
</div>
</div>
<div class="paragraph">
<p>The installation of the Common-EGSE will be done in a location that is accessible for <code>plato-data</code> and <code>plato-user</code>. Run the following commands as root. That will create the location where the Python installation will be done and give the proper permissions to the folders.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mkdir -p /cgse/lib/python
$ chown -R plato-data:plato-data /cgse
$ ls -ld /cgse
drwxr-xr-x. 4 plato-data plato-data 4096 Sep 11 16:55 /cgse</pre>
</div>
</div>
<div class="paragraph">
<p>If not done already, you will need to install the <code>wheel</code> package, which is needed to install binary Python distributions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ python3.8 -m pip install wheel</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before actually installing the Common-EGSE, we have to set the <code>PATH</code> and <code>PYTHONPATH</code> environment variables, and checkout the branch of the releae that we want to install<sup class="footnote">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ PATH=/cgse/bin:$PATH
$ export PYTHONPATH=/cgse/lib/python/
$ git fetch updates
$ git checkout tags/&lt;release tag&gt; -b &lt;release tag&gt;-branch  <i class="conum" data-value="1"></i><b>(1)</b>
$ python3.8 setup.py install --home=/cgse/
$ git checkout develop  <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The release tag takes the form <code>YYYY.MAJOR.MINOR-TH-CGSE</code>, e.g. <code>2022.2.17-IAS-CGSE</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>make sure to go back to the develop branch after the installation</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The above commands install the full Common-EGSE and all its dependencies in the <code>/cgse/lib/python</code> folder. Note that we have not used any Python virtual environment for this installation.</p>
</div>
<div class="paragraph">
<p>After a successful installation, you can check which packages are known to Python and where they are located:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[plato-data@localhost ~]$ python3.8 -m site
sys.path = [
    '/cgse/lib/python',
    '/cgse/lib/python/ThorlabsPM100-1.2.2-py3.8.egg',
    '/cgse/lib/python/PyVISA-1.12.0-py3.8.egg',
    '/cgse/lib/python/PyVISA_py-0.5.3-py3.8.egg',
    '/cgse/lib/python/pyserial-3.5-py3.8.egg',
    '/cgse/lib/python/pylibftdi-0.20.0-py3.8.egg',
    '/cgse/lib/python/pyusb-1.2.1-py3.8.egg',
    '/cgse/lib/python/xlrd-2.0.1-py3.8.egg',
    '/cgse/lib/python/visidata-2.8-py3.8.egg',
    '/cgse/lib/python/typing_extensions-4.2.0-py3.8.egg',
    '/cgse/lib/python/transitions-0.8.11-py3.8.egg',
    '/cgse/lib/python/transforms3d-0.3.1-py3.8.egg',
    '/cgse/lib/python/textual-0.1.18-py3.8.egg',
    '/cgse/lib/python/sshtunnel-0.4.0-py3.8.egg',
    '/cgse/lib/python/rich-12.4.4-py3.8.egg',

    ...

    '/cgse/lib/python/pycparser-2.21-py3.8.egg',
    '/cgse/lib/python/pytz_deprecation_shim-0.1.0.post0-py3.8.egg',
    '/cgse/lib/python/tzdata-2022.1-py3.8.egg',
    '/cgse/lib/python/Common_EGSE-2022.2.16_IAS_CGSE-py3.8.egg',
    '/usr/local/lib/python38.zip',
    '/usr/local/lib/python3.8',
    '/usr/local/lib/python3.8/lib-dynload',
    '/usr/local/lib/python3.8/site-packages',
]
USER_BASE: '/home/plato-data/.local' (doesn't exist)
USER_SITE: '/home/plato-data/.local/lib/python3.8/site-packages' (doesn't exist)
ENABLE_USER_SITE: True
[plato-data@localhost ~]$</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="test-scripts-install">8. Installing the Test Scripts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The installation will be done as the <code>plato-data</code> user. We will <em>clone</em> the IvS-KULeuven <code>plato-test-scripts</code> repository. There is no need to <em>fork</em> because we will not develop from this account and will therefore not do any pushes or  pull requests.</p>
</div>
<div class="paragraph">
<p>Create a <code>~/git</code> folder in the home directory of the <code>plato-data</code> user, move into that directory and clone the GitHub repository. Then move into the <code>plato-test-scripts</code> folder that was created by the <em>clone</em> command. If this is a first-time installation, you must first create a deploy key for the <code>plato-test-scripts</code>, see <a href="#github-deploy">Chapter 13</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ mkdir -p ~/git
$ cd git
$ git clone git@repo-test-scripts:IvS-KULeuven/plato-test-scripts.git
$ cd plato-test-scripts/</pre>
</div>
</div>
<div class="paragraph">
<p>Now, make a virtual environment for your <code>plato-test-scripts</code> installation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ python3 -m venv venv --prompt 'TS-venv'
$ source venv/bin/activate</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cgse-conf-install">9. Installation of Setups</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Setups are the configuration files for your test house and define all the configuration settings for your equipment and for the camera (SUT). All the Setups for all the test houses live in the <code>plato-cgse-conf</code> repository. This section explains how to install this repo on the server and on the client.</p>
</div>
<h3 id="_installation_on_the_server" class="discrete">Installation on the server</h3>
<div class="paragraph">
<p>The <code>plato-cgse-conf</code> repository shall be cloned on the server in the folder <code>~/git</code> where also the <code>plato-common-egse</code> resides. To clone the repo, you need access to this repository first, follow the steps described in <a href="#deploy-key-cgse-conf">Section 13.3</a>. When you have executed that procedure, you should have the repository up-to-date on your system.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Check that the <em>upload</em> remote is indeed a tracking branch, see <a href="#deploy-key-cgse-conf-tracking">upload-tracking</a>. If not, your new submitted Setups will not be pushed to the GitHub repository.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Make a link in the PLATO_DATA_STORAGE_LOCATION to the <code>conf</code> directory containing the Setups for your test house.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>   $ ln -s ~/git/plato-cgse-conf/data/&lt;TH&gt;/conf /data/&lt;TH&gt;/conf  <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>replace <code>&lt;TH&gt;</code> in the above command with <code>CSL1</code>, <code>CSL2</code>, <code>IAS</code>, <code>INTA</code>, or <code>SRON</code>.</td>
</tr>
</table>
</div>
<h3 id="_installation_on_the_client" class="discrete">Installation on the client</h3>
<div class="paragraph">
<p>For the client follow the same procedure to create a deploy key and clone the repository (see <a href="#deploy-key-cgse-conf">Section 13.3</a>), but <strong>do not</strong> allow write access on GitHub and only create the remote <em>updates</em> (the <em>upload</em> remote is not used on the client).</p>
</div>
<div class="paragraph">
<p>Alternatively, the folder <code>~/git/plato-cgse-conf</code> can be mounted read-only from the server. make sure the location is also <code>~/git/plato-cgse-conf</code>.</p>
</div>
<div class="paragraph">
<p>The <code>/data</code> folder is usually already mounted from the server, so the link from <code>/data</code> already exists and should be functional.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="desktop-entry-install">10. Installation of Desktop Entries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section explains how to install a Desktop icon for one of the GUI applications. In the screenshot below, you see the icon for the <em>Mechanical Positions Hexapod GUI</em> in the toolbar on the left side of the screen. Click that icon to start the Task GUI.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../images/desktop-entry-mech-pos-ui.png" alt="desktop entry mech pos ui" width="70%">
</div>
</div>
<div class="paragraph">
<p>A desktop entry is defined in a file with the <code>.desktop</code> extension. The content of the desktop file for the Mechanical Position Hexapod is shown below. The desktop files for several Task GUIs are located in the repo folder <code>~/git/plato-common-egse/client/</code>.</p>
</div>
<div class="paragraph">
<p>The content of <code>mech_pos_ui.desktop</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[Desktop Entry]
Name=Mechanical Position Hexapod GUI
Comment=Control the Hexapod on the Mechanical Position
GenericName=Task GUI
Exec=/home/plato-data/bin/start_mech_pos_ui.sh <i class="conum" data-value="1"></i><b>(1)</b>
Icon=/home/plato-data/git/plato-common-egse/src/egse/icons/logo-puna.svg <i class="conum" data-value="2"></i><b>(2)</b>
Type=Application
StartupNotify=true
Categories=Development;IDE;
Terminal=false
MimeType=text/plain;</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Commands are executed from a Bourne Shell and we therefore need to set the proper environment before we can start the GUI. The easiest way to do that is in a separate script that we will install in the <code>~/bin</code> directory.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>A nice looking icon is available for most of the GUIs at this location.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Install the <code>start_mech_pos_ui.sh</code> scripts in the <code>~/bin</code> directory and make this file executable. The content of this file is given below. Note that when you are starting a GUI that resides in the <code>plato-test-scripts</code>, you will also need to load the proper Python environment. An example is the <code>start_pm_ui.sh</code> script, also shown below.</p>
</div>
<div class="listingblock">
<div class="title">Content of the start_mech_pos_ui.sh script</div>
<div class="content">
<pre>#! /usr/bin/bash

source ~/.bash_profile

mech_pos_ui</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Content of the start_pm_ui.sh script</div>
<div class="content">
<pre>#! /usr/bin/bash

source ~/.bash_profile
source ~/git/plato-test-scripts/venv/bin/activate

pm_ui</pre>
</div>
</div>
<div class="paragraph">
<p>Now finally, use the following commands to verify and install the desktop entry:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ desktop-file-validate mech_pos_ui.desktop
$ desktop-file-install --dir ~/.local/share/applications mech_pos_ui.desktop
$ update-desktop-database ~/.local/share/applications/</pre>
</div>
</div>
<div class="paragraph">
<p>The desktop entry should now appear in the 'Show Applications' view on your desktop. If you right click the icon, you can  <em>Add to Favourites</em> and the icon will appear in the toolbar.</p>
</div>
<div class="paragraph">
<p>After this you can delete the <code>mech_pos_ui.desktop</code> file that you created.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install-vnc">11. Installation of a VNC Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes how to install a VNC Server on your client machine. The VNC server will run on <code>display=:0</code> and will allow remote users to connect to the main desktop that is used by the operator. This remote connection will then be able to provide support and in case of emergency take over the desktop from the operator.</p>
</div>
<div class="paragraph">
<p>We will install the packages <code>x11vnc</code> and <code>net-tools</code>, then we will configure the GNOME Display Manager (<code>gdm3</code>) and finally install and activate the X11 VNC service.</p>
</div>
<div class="sect2">
<h3 id="_install_packages">11.1. Install packages</h3>
<div class="paragraph">
<p>Use the following command to install the necessary packages. You can do this as user 'plato-data' and when asked for a password, provide the password of that user<sup class="footnote">[<a id="_footnoteref_5" class="footnote" href="#_footnotedef_5" title="View footnote.">5</a>]</sup>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo apt-get install x11vnc net-tools</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configure_the_gnome_display_manager">11.2. Configure the GNOME Display Manager</h3>
<div class="paragraph">
<p>Edit the file <code>/etc/gdm3/custom.conf</code> to disable Wayland and enable automatic login by the 'plato-data' user. The changes are all in the daemon section of the configuration file. If some entries do not exist on your system, create them. You should edit this file as 'root' or with <code>sudo</code> under the 'plato-data' user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[daemon]
# Uncomment the line below to force the login screen to use Xorg
WaylandEnable=false

# Enabling automatic login
AutomaticLoginEnable = true
AutomaticLogin = plato-data</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_install_and_activate_the_vnc_service">11.3. Install and Activate the VNC service</h3>
<div class="paragraph">
<p>To install the X11 VNC service under Systemd, create a file <code>/etc/systemd/system/x11vnc.service</code> with the following content.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the text below, change the <code>####</code> into the <code>id</code> of the user that was set in the configuration file above. The <code>id</code> must be an integer number, e.g. 1003.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>[Unit]
Description=x11vnc service
After=display-manager.service network.target syslog.target

[Service]
Type=simple
ExecStart=/usr/bin/x11vnc -forever -shared -display :0 -auth /run/user/####/gdm/Xauthority
ExecStop=/usr/bin/killall x11vnc
Restart=on-failure

[Install]
WantedBy=multi-user.target</pre>
</div>
</div>
<div class="paragraph">
<p>Then, reload the daemon configuration and start the service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo systemctl daemon-reload
$ sudo systemctl enable x11vnc.service
$ sudo systemctl start x11vnc.service</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setup-environment">12. Setting up the environment</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_environment_variables">12.1. Environment Variables</h3>
<div class="paragraph">
<p>The environment variables that are used by the CGSE or test scripts are listed in the table below. It is best practice to define those variable in <code>~/.bash_profile</code> to have them loaded on login. With the below definitions, a standard <code>~/.bash_profile</code> would look like this (example taken from the CSL1 egse-client <em>daiquiri</em>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># <strong><em>plato-data@daiquiri:~$ cat ~/.bash_profile</em></strong>
source ~/.bashrc

export PATH=/cgse/bin:~/git/plato-test-scripts/venv/bin:~/.local/bin:$PATH

export PYTHONPATH=/cgse/lib/python:/cgse/lib/python3.8/site-packages:~/git/plato-test-scripts/src:~/git/plato-test-scripts/venv/lib/python3.8/site-packages
export PYTHONSTARTUP=~/git/plato-test-scripts/startup.py

export PLATO_LOCAL_SETTINGS=/cgse/local_settings.yaml
export PLATO_DATA_STORAGE_LOCATION=/data/CSL1/
export PLATO_CONF_DATA_LOCATION=/data/CSL1/conf/
export PLATO_LOG_FILE_LOCATION=/data/CSL1/log/
export PLATO_INSTALL_LOCATION=/cgse
export PLATO_COMMON_EGSE_PATH=/home/plato-data/git/plato-common-egse

export LD_LIBRARY_PATH=~/git/plato-common-egse/src/egse/lib/ximc/libximc.framework/

alias cd2cgse="cd ~/git/plato-common-egse"
alias cd2ts="cd ~/git/plato-test-scripts"</pre>
</div>
</div>
<div id="set-terminal-title" class="exampleblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">A Terminal Title</dt>
<dd>
<p>Something else that you can add to your <code>~/.bash_profile</code> on the client machine is the following function (not really an environment setting, but still useful):</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">function term_title(){
  if [ -z "$PS1_BACK" ];  # set backup if it is empty
  then
    PS1_BACK="$PS1"
  fi

  TITLE="\[\e]0;$*\a\]"
  PS1="${PS1_BACK}${TITLE}"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This function will allow you to set the title of a Terminal window or a TAB in a Terminal window. This was possible on CentOS-8 with a context menu entry when right-clicking on the terminal TAB, but unfortunately that menu entry doesn&#8217;t exist on Ubuntu. Run the function from within the terminal session that needs a new title, e.g. <code>TS-venv</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ term_title TS-venv</pre>
</div>
</div>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Overview of all the environment variables</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PYTHONPATH – egse-server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/cgse/lib/python/:/cgse/lib/python3.8/site-packages</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PYTHONPATH – egse-client<sup class="footnote">[<a id="_footnoteref_6" class="footnote" href="#_footnotedef_6" title="View footnote.">6</a>]</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/cgse/lib/python:/cgse/lib/python3.8/site-packages:/home/plato-data/git/plato-test-scripts/src:/home/plato-data/git/plato-test-scripts/venv/lib/python3.8/site-packages/</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO_COMMON_EGSE_PATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/home/plato-data/git/plato-common-egse</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO_CONF_DATA_LOCATION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/data/&lt;SITE_ID&gt;/conf</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO_CONF_REPO_LOCATION<sup class="footnote">[<a id="_footnoteref_7" class="footnote" href="#_footnotedef_7" title="View footnote.">7</a>]</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/home/plato-data/git/plato-cgse-conf</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO_DATA_STORAGE_LOCATION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/data/&lt;SITE_ID&gt;</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO_INSTALL_LOCATION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/cgse</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO_LOCAL_SETTINGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/cgse/local_settings.yaml</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLATO_LOG_FILE_LOCATION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/data/&lt;SITE_ID&gt;/log</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LD_LIBRARY_PATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/home/plato-data/git/plato-common-egse/src/egse/lib/ximc/libximc.framework</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_the_environment_for_systemd_services">12.2. The environment for Systemd services</h3>
<div class="paragraph">
<p>For the CGSE core services, that are started by the Systemd on the egse-server, the environment variable are defined in the file <code>/cgse/env.txt</code>. The example below shows the content of this file from the CSL1 egse-server <em>strawberry</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># <strong><em>plato-data@strawberry:~$ cat /cgse/env.txt</em></strong>
PYTHONPATH=/cgse/lib/python/:/cgse/lib/python3.8/site-packages
PLATO_LOCAL_SETTINGS=/cgse/local_settings.yaml
PLATO_CONF_DATA_LOCATION=/data/CSL1/conf
PLATO_CONF_REPO_LOCATION=/home/plato-data/git/plato-cgse-conf
PLATO_DATA_STORAGE_LOCATION=/data/CSL1
PLATO_LOG_FILE_LOCATION=/data/CSL1/log</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="github-deploy">13. Setting up ssh access and GitHub deploy keys</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have a semi-automatic update procedure in place for the Common-EGSE and the Test Scripts. This procedure will be described in <a href="#cgse-update">Chapter 14</a> and <a href="#test-scripts-update">Chapter 15</a>, but before we can use that we need to have the proper permissions to fetch changes from the different GitHub repositories without the need to provide our credentials every time. The best way to do that is to set up deploy keys on the GitHub repos.</p>
</div>
<div class="sect2">
<h3 id="deploy-key-egse-server">13.1. Create a deploy key for the plato-common-egse</h3>
<div class="paragraph">
<p>You can create an ssh key-pair for the CGSE with the following command. Execute this code on the <code>egse-server</code> as user <code>plato-data</code> in the folder <code>~/.ssh</code> (create the folder if it doesn&#8217;t exist).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd ~/.ssh
$ ssh-keygen -t ed25519 -C plato-data@egse-server-inta  <i class="conum" data-value="1"></i><b>(1)</b>
Generating public/private ed25519 key pair.
Enter file in which to save the key (/home/plato-data/.ssh/id_ed25519): id_cgse_egse_server_inta  <i class="conum" data-value="2"></i><b>(2)</b>
Enter passphrase (empty for no passphrase):  <i class="conum" data-value="3"></i><b>(3)</b>
Enter same passphrase again:
Your identification has been saved in id_cgse_egse_server_inta
Your public key has been saved in id_cgse_egse_server_inta.pub
The key fingerprint is:
SHA256:kOUBdc***************************7NSgd1WX+Ds plato-data@egse-server-inta
The key's randomart image is:
+--[ED25519 256]--+
|  ..ooo+*oo=..+.+|
|   . ..+ =++o..oo|
|    . o o oo+o= .|
|     . =  .oo= =.|
|    . + S  .o B +|
|     o       = E |
|    o         . .|
|   o             |
|  .              |
+----[SHA256]-----+</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The email address can be <code>plato-data@egse-server-&lt;th&gt;</code> where <code>&lt;th&gt;</code> is your test house site id.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>name of the file: <code>id_cgse_egse_server_&lt;th&gt;</code>, again <code>&lt;th&gt;</code> is the test house site id.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>do not provide a passphrase, just hit return</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Send the <code>id_cgse_egse_server_&lt;th&gt;.pub</code> file to the maintainer of the GitHub repository. She will copy the content of this file into a new deploy key for the <code>plato-common-egse</code> @ GitHub.</p>
</div>
<div class="paragraph">
<p>Now we need to create a generic hostname for the repository such that this can be picked up by the ssh protocol when accessing the repository at GitHub. Add the following lines to the file <code>~/.ssh/config</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Host repo-common-egse
    Hostname github.com
    IdentityFile ~/.ssh/id_cgse_egse_server_&lt;th&gt;  <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>don&#8217;t forget to use your test house site id</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since we have created some new files in the <code>~/.ssh</code> folder we have to make sure the permissions of these files are correct and also the <code>~/.ssh</code> folder itself is fully protected.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ls -ld .ssh
drwx------. 2 plato-data plato-data 4096 May 25 12:24 .ssh

$ ls -l .ssh
-rw-r--r--  1 plato-data plato-data   412 May 23 14:19 config
-rw-------  1 plato-data plato-data   419 May 23 14:16 id_cgse_egse_server_inta
-rw-r--r--  1 plato-data plato-data   109 May 23 14:16 id_cgse_egse_server_inta.pub</pre>
</div>
</div>
<div class="paragraph">
<p>The file permissions can be changed with the <code>chmod</code> command as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ chmod 700 ~/.ssh
$ chmod 644 ~/.ssh/config</pre>
</div>
</div>
<div class="paragraph">
<p>We will now add a new remote to our git repository. This is needed to (1) use the generic hostname created above, and (2) use a standard name for the remote that is used by the update script. Add a remote for doing the updates as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-source" data-lang="source">$ cd ~/git/plato-common-egse
$ git remote add updates git@repo-common-egse:IvS-KULeuven/plato-common-egse.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>That was the last step, we can now try to fetch new updates from the GitHub repo to confirm that this works as expected:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git fetch updates</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_create_a_deploy_key_for_the_plato_test_scripts">13.2. Create a deploy key for the plato-test-scripts</h3>
<div class="paragraph">
<p>You can create an ssh key-pair for the test scripts with the following command. Execute this code on the <code>egse-client</code> as user <code>plato-data</code> in the folder <code>~/.ssh</code> (create the folder if it doesn&#8217;t exist).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd ~/.ssh
$ ssh-keygen -t ed25519 -C plato-data@egse-client-&lt;th&gt;  <i class="conum" data-value="1"></i><b>(1)</b>
Generating public/private ed25519 key pair.
Enter file in which to save the key (/home/plato-data/.ssh/id_ed25519): id_test_scripts_&lt;th&gt;  <i class="conum" data-value="2"></i><b>(2)</b>
Enter passphrase (empty for no passphrase):  <i class="conum" data-value="3"></i><b>(3)</b>
Enter same passphrase again:
Your identification has been saved in id_test_scripts_&lt;th&gt;
Your public key has been saved in id_test_scripts_&lt;th&gt;.pub
The key fingerprint is:
SHA256:kOUBdc***************************7NSgd1WX+Ds plato-data@egse-client-&lt;th&gt;
The key's randomart image is:
+--[ED25519 256]--+
|  ..ooo+*oo=..+.+|
|   . ..+ =++o..oo|
|    . o o oo+o= .|
|     . =  .oo= =.|
|    . + S  .o B +|
|     o       = E |
|    o         . .|
|   o             |
|  .              |
+----[SHA256]-----+</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The email address can be <code>plato-data@egse-client-&lt;th&gt;</code> where <code>&lt;th&gt;</code> is your test house site id.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>name of the file: <code>id_cgse_egse_server_&lt;th&gt;</code>, again <code>&lt;th&gt;</code> is the test house site id.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>do not provide a passphrase, just hit return</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Send the <code>id_test_scripts_&lt;th&gt;.pub</code> file to the maintainer of the GitHub repository. She will copy the content of this file into a new deploy key for the <code>plato-test-scripts</code> @ GitHub.</p>
</div>
<div class="paragraph">
<p>Now we need to create a generic hostname for the repository such that this can be picked up by the ssh protocol when accessing the repository at GitHub. Add the following lines to the file <code>~/.ssh/config</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Host repo-test-scripts
  Hostname github.com
  IdentityFile ~/.ssh/id_test_scripts_&lt;th&gt;  <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>don&#8217;t forget to use your test house site id</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you have not yet cloned the plato-test-scripts repository, you can do that now with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-source" data-lang="source">$ cd ~/git/
$ git clone git@repo-test-scripts:IvS-KULeuven/plato-test-scripts.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>We will now add a new remote to our git repository. This is needed to (1) use the generic hostname created above, and (2) use a standard name for the remote that is used by the update script. Add a remote for doing the updates as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-source" data-lang="source">$ cd ~/git/plato-test-scripts
$ git remote add updates git@repo-test-scripts:IvS-KULeuven/plato-test-scripts.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>That was the last step, we can now try to fetch new updates from the GitHub repo to confirm that this works as expected:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git fetch updates</pre>
</div>
</div>
<div class="paragraph">
<p>On a first-time-installation, perform an update as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git fetch updates
$ git rebase updates/develop
$ python3 -m pip install -e .</pre>
</div>
</div>
<div class="paragraph">
<p>otherwise, use the <code>update_ts</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ update_ts</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="deploy-key-cgse-conf">13.3. Create a deploy key for the plato-cgse-conf</h3>
<div class="paragraph">
<p>You can create an ssh key-pair for the plato-cgse-conf with the following command. Execute this code on the <code>egse-server</code> as user <code>plato-data</code> in the folder <code>~/.ssh</code> (create the folder if it doesn&#8217;t exist).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd ~/.ssh
$ ssh-keygen -t ed25519 -C plato-data@egse-server-&lt;TH&gt;  <i class="conum" data-value="1"></i><b>(1)</b>
Generating public/private ed25519 key pair.
Enter file in which to save the key (/home/plato-data/.ssh/id_ed25519): id_cgse_conf_&lt;TH&gt;  <i class="conum" data-value="2"></i><b>(2)</b>
Enter passphrase (empty for no passphrase):  <i class="conum" data-value="3"></i><b>(3)</b>
Enter same passphrase again:
Your identification has been saved in id_cgse_egse_server_inta
Your public key has been saved in id_cgse_egse_server_inta.pub
The key fingerprint is:
SHA256:kOUBdc***************************7NSgd1WX+Ds plato-data@egse-server-inta
The key's randomart image is:
+--[ED25519 256]--+
|  ..ooo+*oo=..+.+|
|   . ..+ =++o..oo|
|    . o o oo+o= .|
|     . =  .oo= =.|
|    . + S  .o B +|
|     o       = E |
|    o         . .|
|   o             |
|  .              |
+----[SHA256]-----+</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The email address can be <code>plato-data@egse-server-&lt;th&gt;</code> where <code>&lt;th&gt;</code> is your test house site id.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>name of the file: <code>id_cgse_egse_server_&lt;th&gt;</code>, again <code>&lt;th&gt;</code> is the test house site id.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>do not provide a passphrase, just hit return</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Send the <code>id_cgse_conf_&lt;th&gt;.pub</code> file to the maintainer of the GitHub repository. She will copy the content of this file into a new deploy key for the <code>plato-cgse-conf</code> @ GitHub. It is basically the same procedure as for the previous two repos, except for plato-cgse-conf using the configuration manager: when you add the deploy key to GitHub, you must check the <em>Allow write access</em> checkbox. That will allow the configuration manager to upload new Setups to the repo.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="../images/add-deploy-key.png" alt="add deploy key">
</div>
</div>
<div class="paragraph">
<p>Now we need to create a generic hostname for the repository such that this can be picked up by the ssh protocol when accessing the repository at GitHub. Add the following lines to the file <code>~/.ssh/config</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Host repo-cgse-conf
    Hostname github.com
    IdentityFile ~/.ssh/id_cgse_conf_&lt;th&gt;  <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>don&#8217;t forget to use your test house site id</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Check the permissions of the <code>~/.ssh</code> directory and the files in it (see <a href="#deploy-key-egse-server">Section 13.1</a>).</p>
</div>
<div class="paragraph">
<p>If you have not yet cloned the plato-cgse-conf repository, you can do that now with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-source" data-lang="source">$ cd ~/git/
$ git clone git@repo-cgse-conf:IvS-KULeuven/plato-cgse-conf.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can add a new remote to your git repository. This is needed to (1) use the generic hostname created above, and (2) use a standard name for the remote that is used by the update/upload script. Add a remote for doing the updates as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-source" data-lang="source">$ cd ~/git/plato-cgse-conf
$ git remote add updates git@repo-cgse-conf:IvS-KULeuven/plato-cgse-conf.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the configuration manager, we will also add a remote <code>upload</code> which is needed by the configuration manager when submitting a new Setup.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ git remote add upload git@repo-cgse-conf:IvS-KULeuven/plato-cgse-conf.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make sure that the following environment variable is defined in <code>/cgse/env.txt</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">export PLATO_CONF_REPO_LOCATION=/home/plato-data/git/plato-cgse-conf</code></pre>
</div>
</div>
<div id="deploy-key-cgse-conf-tracking" class="paragraph">
<p>Make sure that the branch has the upload/main as its tracking branch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-bash" data-lang="bash">$ git branch -u upload/main
$ git branch -vv
* main 17fb23c [upload/main] change filter wheels parameters  <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>between square brackets is the remote/branch that is tracked.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cgse-update">14. Update the Common-EGSE to the latest release</h2>
<div class="sectionbody">
<div class="paragraph">
<p>At some point you will be asked to update to a specific release. Make sure you are in the develop branch, then execute the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd ~/plato-common-egse
$ update_cgse ops --tag=2022.3.4+CGSE  <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>as a reminder, the release tag for the Common-EGSE takes the following form: <code>YYYY.MAJOR.MINOR+CGSE</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can check if the correct version is installed as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ python3 -m egse.version
CGSE version in Settings: 2022.3.4+CGSE
CGSE installed version = 2022.3.4+cgse</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="test-scripts-update">15. Update the Test Scripts to the latest release</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you need to update the test scripts on your <code>egse-client</code> machine, use the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd ~/git/plato-test-scripts
$ update_ts</pre>
</div>
</div>
<div class="paragraph">
<p>We do not have an up-to-date release strategy yet for the test scripts. The command above will install the latest version from the develop branch. Therefore, only update the test scripts when a new release is created on the GitHub repository. That will assure the updates have at least been verified and reviewed.</p>
</div>
<div class="paragraph">
<p>To know the version of the test scripts that is installed on your machine, use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ python3 -m camtest.version
CAMTEST version in Settings: 2022.3.6+TS
CAMTEST git version = 2022.3.6+TS-0-g602f139  <i class="conum" data-value="1"></i><b>(1)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The version that is presented here is explained in the developer manual in <a href="../develop/version-numbers.html#version-numbers">Version Numbers</a>.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="python-package-update">16. Update Python packages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ideally, the installed third party packages should be the versions that are given the requirements file of the project. If the requirements file is updated, you can use the following command to update your installation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd $PLATO_COMMON_EGSE_PATH
$ python3 -m pip install --upgrade --prefix=/cgse -r requirements.txt  <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="2"></i><b>(2)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>note the <code>--prefix</code> to make sure the upgrade of the packages is done in the correct location and not in the system folders. Instead of <code>/cgse</code> you can also use <code>$PLATO_INSTALL_LOCATION</code> for the <code>--prefix</code> value.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>on Ubuntu, the system Python installation has packages installed in <code>/usr/lib/python3/dist-packages</code> and that location is not writable for the 'plato-data' user. When you get an error during installation, add the option <code>--ignore-installed</code> to the <code>pip</code> command.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To update the Python packages for the test scripts, make sure you are inside the virtual environment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd ~/git/plato-test-scripts
$ source venv/bin/activate  <i class="conum" data-value="1"></i><b>(1)</b>
$ python3 -m pip install --upgrade -r requirements.txt</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>it&#8217;s important that you are in the virtual environment before performing the upgrade, then the packages will be installed—as intended—in your virtual environment.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_propagation">17. Data Propagation</h2>
<div class="sectionbody">
<div class="ulist checklist">
<ul class="checklist">
<li>
<p><i class="fa fa-square-o"></i> Shortly describe the storage strategy (refer to developer manual section for more detail)</p>
</li>
<li>
<p><i class="fa fa-square-o"></i> Refer to section about disk organisation</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> describe rsync from /data to /archive</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> describe rsync to Leuven</p>
</li>
<li>
<p><i class="fa fa-check-square-o"></i> crontab examples</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following line is a crontab entry for syncing the <code>/data</code> life data storage to the <code>/archive</code> permanent storage every 15 minutes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre># Synchronise /data to /archive
*/15 * * * * rsync -av /data/ /archive/</pre>
</div>
</div>
<div class="paragraph">
<p>The next line is a crontab entry for syncing the <code>/data</code> folder from IAS to the KU Leuven archive. It will update destination files in place and exclude FITS image files because they are intermediate files before generating the FITS cubes and do not need to be archived. The <code>-rloptD</code> options represent the archiving mode and the <code>-x</code> option is to prevent rsync to cross filesystem boundaries.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># Synchronise /data to KU Leuven
*/15 * * * * rsync -rloptDv --chmod=Dg+s,Dug=rwx,Do=rx,Do-w,Fug=rw,Fo=rx,Fo-w --inplace --exclude '_images.fits' -x /data/ ias@copernicus.ster.kuleuven.be:/STER/platodata/IAS/data/</pre>
</div>
</div>
<div class="paragraph">
<p>The similar rsync command for syncing the <code>/archive</code> folder to KU Leuven is given below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># Synchronise /archive to KU Leuven
*/15 * * * * rsync -rloptDv --chmod=Dg+s,Dug=rwx,Do=rx,Do-w,Fug=rw,Fo=rx,Fo-w --inplace --exclude '_images.fits' -x /archive/ ias@copernicus.ster.kuleuven.be:/STER/platodata/IAS/archive/</pre>
</div>
</div>
<div class="paragraph">
<p>The above examples are stripped from logging commands to focus on the relevant parts of the <code>rsync</code> command. A full crontab entry for the synchronisation of <code>/data</code> to KU Leuven is given below for completeness.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">*/15 * * * * echo "--------------------------------------------------" &gt;&gt; /home/plato-data/logs-rsync-data-to-KU-Leuven ; date &gt;&gt; /home/plato-data/logs-rsync-data-to-KU-Leuven ; rsync -rloptDv --chmod=Dg+s,Dug=rwx,Do=rx,Do-w,Fug=rw,Fo=rx,Fo-w --inplace --exclude ’_images.fits’ -x /data/ ias@copernicus.ster.kuleuven.be:/STER/platodata/IAS/data/ 2&gt;&amp;1 &gt;&gt; /home/plato-data/logs-rsync-data-to-KU-Leuven</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_shared_libraries">18. Shared Libraries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some components use a shared library that is loaded by the Python interpreter. In order to load the library, the absolute path to the shared object file must be known. Different modules handle this in their own way.</p>
</div>
<div class="paragraph">
<p>The <code>egse.dsi</code> module searches for the RMAP and ESL libraries in the operating system specific folder in the  <code>egse.lib</code> module. The libraries are then loaded using the <code>ctypes</code> module. If the CGSE is properly installed, this should work out-of-the-box.</p>
</div>
<div class="paragraph">
<p>The <code>egse.filterwheel.eksma</code> module needs a library <code>libximc</code> which is also provided in the <code>egse.lib</code> module, but the Python code needs the proper location in the environment variable <code>LD_LIBRARY_PATH</code>.  The required files are included in the CGSE repo at <code>~/git/plato-common-egse/src/egse/lib/ximc/libximc.framework</code>.  The library that is needed can also be downloaded from: <a href="https://files.xisupport.com/libximc/libximc-2.13.3-all.tar.gz" class="bare">https://files.xisupport.com/libximc/libximc-2.13.3-all.tar.gz</a>.</p>
</div>
<div class="paragraph">
<p>The preferred solution is to add the location of the library files to the environment variable <code>$LD_LIBRARY_PATH</code>.  In your terminal or better in your bash profile:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight nowrap"><code class="language-source" data-lang="source">$ export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:~/git/plato-common-egse/src/egse/lib/ximc/libximc.framework/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can install the '.deb' package from the link above on your system with dpkg. That will put the files under <code>/usr/lib</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installating_external_tools">19. Installating External Tools</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_cutelog_gui">19.1. Cutelog GUI</h3>
<div class="paragraph">
<p>Cutelog is a GUI that can be installed in your virtual environment using <code>pip</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ python -m pip install cutelog</pre>
</div>
</div>
<div class="paragraph">
<p>You can use this application to inspect the log messages on the <code>egse-client</code> machine. Start the GUI from the process manager GUI (<code>pm_ui</code>) or from a terminal.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/cutelog.png" alt="cutelog">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_textualog_tui">19.2. Textualog TUI</h3>
<div class="paragraph">
<p>Textualog is a terminal application (TUI) that allows you to inspect the log files in <code>$PLATO_LOG_FILE_LOCATION</code>. The package is open-source and can be installed in your virtual environment from PyPI using <code>pip</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ python -m pip install textualog</pre>
</div>
</div>
<div class="paragraph">
<p>Textualog is extremely useful to inspect and follow logging messages in a remote terminal. It is inpired on the <code>cutelog</code> app and developed specifically for the remote users. After installation, the current log file can be inspected with the following command<sup class="footnote">[<a id="_footnoteref_8" class="footnote" href="#_footnotedef_8" title="View footnote.">8</a>]</sup>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ textualog --log $PLATO_LOG_FILE_LOCATION/general.log</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/textualog.png" alt="textualog">
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. The installation of Prometheus is explained in <a href="#prometheus-install">Chapter 3</a>
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. The installation of Grafana is explained in <a href="#grafana-install">Chapter 4</a>
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. Don&#8217;t try  to install Grafana using <code>yum</code>, because that will bring you into trouble with configuration files etc.
</div>
<div class="footnote" id="_footnotedef_4">
<a href="#_footnoteref_4">4</a>. The latest release tag can be found on the GitHub pages of the repository
</div>
<div class="footnote" id="_footnotedef_5">
<a href="#_footnoteref_5">5</a>. The 'plato-data' user is supposed to have sudo rights.
</div>
<div class="footnote" id="_footnotedef_6">
<a href="#_footnoteref_6">6</a>. The PYTHONPATH on the client is different because it also has the plato-test-scripts installed, so in addition to the CGSE packages, it needs to have access to the test scripts Python code and packages that were installed as part of the plato-test-scripts virtual environment.
</div>
<div class="footnote" id="_footnotedef_7">
<a href="#_footnoteref_7">7</a>. This variable only needs to be defined in the <code>/cgse/env.txt</code> file on the egse-server.
</div>
<div class="footnote" id="_footnotedef_8">
<a href="#_footnoteref_8">8</a>. the textualog package might already installed on the egse-server at the test houses.
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.2<br>
Last updated 2023-01-20 23:01:20 +0100
</div>
</div>
<script>
/*! Asciidoctor Tabs | Copyright (c) 2018-present Dan Allen | MIT License */
;(function () {
  'use strict'

  var hash = window.location.hash
  find('.tabset').forEach(function (tabset) {
    var active
    var tabs = tabset.querySelector('.tabs')
    if (tabs) {
      var first
      find('li', tabs).forEach(function (tab, idx) {
        var id = (tab.querySelector('a[id]') || tab).id
        if (!id) return
        var pane = tabset.querySelector('.tab-pane[aria-labelledby~="' + id + '"]')
        if (!pane) return
        if (!idx) first = { tab: tab, pane: pane }
        if (!active && hash === '#' + id && (active = true)) {
          tab.classList.add('is-active')
          if (pane) pane.classList.add('is-active')
        } else if (!idx) {
          tab.classList.remove('is-active')
          if (pane) pane.classList.remove('is-active')
        }
        tab.addEventListener('click', activateTab.bind({ tabset: tabset, tab: tab, pane: pane }))
      })
      if (!active && first) {
        first.tab.classList.add('is-active')
        if (first.pane) first.pane.classList.add('is-active')
      }
    }
    tabset.classList.remove('is-loading')
  })

  function activateTab (e) {
    var tab = this.tab
    var pane = this.pane
    find('.tabs li, .tab-pane', this.tabset).forEach(function (it) {
      it === tab || it === pane ? it.classList.add('is-active') : it.classList.remove('is-active')
    })
    e.preventDefault()
  }

  function find (selector, from) {
    return Array.prototype.slice.call((from || document).querySelectorAll(selector))
  }
})()
</script>
</body>
</html>